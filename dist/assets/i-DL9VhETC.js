import{r as g,j as n}from"./vendors-DZ62sxLm.js";import{aL as us,a1 as I,aM as Zr,aN as ei,au as Pn,aO as ti,aP as ot,aQ as be,aA as _e,aR as Kr,a4 as U,aS as Be,D as yo,aT as ue,aU as Q,ah as oi,aV as Ur,aW as Tc,aX as Ac,aY as ni,i as X,T as L,aZ as nt,a_ as Gt,a$ as Zt,b0 as Mn,e as Se,b1 as Ma,b2 as zc,b3 as ai,b4 as ge,b5 as pt,ak as $c,aE as Fc,aF as Vc,b6 as se,aG as Wc,b7 as Qr,B as ke,b8 as Oc,af as Nn,b9 as ne,ba as Hc,ax as ve,a2 as ee,bb as Xc,bc as Jr,bd as sn,be as De,bf as rn,M as Te,x as el,y as tl,A as ol,bg as Yc,bh as We,ao as ce,bi as qc,bj as nl,bk as kt,bl as Na,bm as Gc,bn as Ia,r as Je,bo as Ct,bp as ii,bq as al,br as Xt,am as In,H as il,an as En,G as re,bs as Rn,bt as si,bu as sl,bv as ri,bw as Dn,$ as Xe,aw as ln,S as Ne,bx as Zc,by as lo,aH as $e,aJ as Bn,bz as Kc,bA as Uc,bB as rl,bC as ps,bD as gs,bE as Qc,bF as Jc,bG as eu,bH as tu,bI as ll,av as St,aq as ae,bJ as ou,bK as nu,bL as au,bM as iu,bN as su,bO as ru,bP as ze,ad as lu,P as li,a9 as dl,aa as cl,ab as Ea,ac as Ft,bQ as du,bR as cu,bS as uu,bT as T,bU as Ye,bV as Qe,bW as Qo,bX as Jo,bY as di,ar as wt,bZ as et,b_ as z,b$ as en,c0 as ul,c1 as sa,c2 as Ln,c3 as pl,u as pu,c4 as gu,c5 as gl,c6 as gt,c7 as Tn,c8 as dn,Y as hl,h as hu,c9 as mu,ca as ml,E as ci,cb as fu,cc as yu,cd as co,ce as ui,cf as pi,cg as gi,ch as xu,ci as hs,cj as at,ck as bu,cl as ms,cm as ct,cn as wu,co as fl,cp as hi,cq as vu,cr as ku,cs as _t,ct as yl,cu as mi,cv as Pe,ap as ju,as as Cu,at as Su,cw as Ra,aI as An,aK as xl,cx as cn,cy as fi,cz as fs,cA as Lo,j as io,R as Vt,cB as _u,cC as Pu,cD as Mu,cE as Nu,cF as Iu,cG as un,cH as ys,cI as Eu,cJ as xs,cK as Ru,cL as Du,cM as Bu,cN as bs,cO as bl,cP as Lu,cQ as Tu,cR as Au,cS as zu,cT as $u,cU as wl,cV as ws,cW as yi,cX as Fu,cY as vs,cZ as Vu,c_ as xi,c$ as Da,d0 as Wu,d1 as Ou,Z as Hu,d2 as Xu,d3 as Yu,d4 as qu,W as Gu,ay as Zu,d5 as Ku,d6 as Uu,d7 as Qu,d8 as Ju,d9 as vl,da as Ba,t as ks,db as js,dc as ep,dd as tp,de as bi,df as op,dg as kl,dh as pn}from"./e-CfcqPV8P.js";import{g as jl,h as np,j as wi,k as Cl,i as q,V as La,t as Ta,l as ap,m as Sl,n as it,o as ip,d as W,s as Aa,f as sp,p as vi,q as rp,c as Cs,r as lp,b as uo,u as gn,e as _l,B as ht,v as ra,L as dp,w as Pl,x as Ml,R as Ge,y as ki,D as hn,z as ji,G as tn,A as cp,C as up,E as pp,F as gp,H as Ss}from"./likec4-C1QItc1V.js";function mn(e){return typeof e=="object"&&e!=null&&!Array.isArray(e)}var hp=e=>typeof e=="object"&&e!==null;function Nt(e){return Object.fromEntries(Object.entries(e??{}).filter(([t,o])=>o!==void 0))}var mp=e=>e==="base";function fp(e){return e.slice().filter(t=>!mp(t))}function _s(e){return String.fromCharCode(e+(e>25?39:97))}function yp(e){let t="",o;for(o=Math.abs(e);o>52;o=o/52|0)t=_s(o%52)+t;return _s(o%52)+t}function xp(e,t){let o=t.length;for(;o;)e=e*33^t.charCodeAt(--o);return e}function bp(e){return yp(xp(5381,e)>>>0)}var Nl=/\s*!(important)?/i;function wp(e){return typeof e=="string"?Nl.test(e):!1}function vp(e){return typeof e=="string"?e.replace(Nl,"").trim():e}function Ci(e){return typeof e=="string"?e.replaceAll(" ","_"):e}var ye=e=>{const t=new Map;return(...o)=>{const a=JSON.stringify(o);if(t.has(a))return t.get(a);const i=e(...o);return t.set(a,i),i}},kp=new Set(["__proto__","constructor","prototype"]);function Si(...e){return e.reduce((t,o)=>(o&&Object.keys(o).forEach(a=>{if(kp.has(a))return;const i=t[a],s=o[a];mn(i)&&mn(s)?t[a]=Si(i,s):t[a]=s}),t),{})}var jp=e=>e!=null;function _i(e,t,o={}){const{stop:a,getKey:i}=o;function s(l,r=[]){if(hp(l)){const d={};for(const[u,c]of Object.entries(l)){const p=i?.(u,c)??u,h=[...r,p];if(a?.(l,h))return t(l,r);const f=s(c,h);jp(f)&&(d[p]=f)}return d}return t(l,r)}return s(e)}function Cp(e,t){return Array.isArray(e)?e.map(o=>t(o)):mn(e)?_i(e,o=>t(o)):t(e)}function Sp(e,t){return e.reduce((o,a,i)=>{const s=t[i];return a!=null&&(o[s]=a),o},{})}function Il(e,t,o=!0){const{utility:a,conditions:i}=t,{hasShorthand:s,resolveShorthand:l}=a;return _i(e,r=>Array.isArray(r)?Sp(r,i.breakpoints.keys):r,{stop:r=>Array.isArray(r),getKey:o?r=>s?l(r):r:void 0})}var _p={shift:e=>e,finalize:e=>e,breakpoints:{keys:[]}},Pp=e=>typeof e=="string"?e.replaceAll(/[\n\s]+/g," "):e;function El(e){const{utility:t,hash:o,conditions:a=_p}=e,i=l=>[t.prefix,l].filter(Boolean).join("-"),s=(l,r)=>{let d;if(o){const u=[...a.finalize(l),r];d=i(t.toHash(u,bp))}else d=[...a.finalize(l),i(r)].join(":");return d};return ye(({base:l,...r}={})=>{const d=Object.assign(r,l),u=Il(d,e),c=new Set;return _i(u,(p,h)=>{if(p==null)return;const f=wp(p),[x,...w]=a.shift(h),C=fp(w),v=t.transform(x,vp(Pp(p)));let k=s(C,v.className);f&&(k=`${k}!`),c.add(k)}),Array.from(c).join(" ")})}function Mp(...e){return e.flat().filter(t=>mn(t)&&Object.keys(Nt(t)).length>0)}function Np(e){function t(i){const s=Mp(...i);return s.length===1?s:s.map(l=>Il(l,e))}function o(...i){return Si(...t(i))}function a(...i){return Object.assign({},...t(i))}return{mergeCss:ye(o),assignCss:a}}var Ip=/([A-Z])/g,Ep=/^ms-/,Rp=ye(e=>e.startsWith("--")?e:e.replace(Ip,"-$1").replace(Ep,"-ms-").toLowerCase()),Dp=["min","max","clamp","calc"],Bp=new RegExp(`^(${Dp.join("|")})\\(.*\\)`),Lp=e=>typeof e=="string"&&Bp.test(e),Tp="cm,mm,Q,in,pc,pt,px,em,ex,ch,rem,lh,rlh,vw,vh,vmin,vmax,vb,vi,svw,svh,lvw,lvh,dvw,dvh,cqw,cqh,cqi,cqb,cqmin,cqmax,%",Ap=`(?:${Tp.split(",").join("|")})`,zp=new RegExp(`^[+-]?[0-9]*.?[0-9]+(?:[eE][+-]?[0-9]+)?${Ap}$`),$p=e=>typeof e=="string"&&zp.test(e),Fp=e=>typeof e=="string"&&/^var\(--.+\)$/.test(e),xo={map:Cp,isCssFunction:Lp,isCssVar:Fp,isCssUnit:$p},bo=(e,t)=>{if(!e?.defaultValues)return t;const o=typeof e.defaultValues=="function"?e.defaultValues(t):e.defaultValues;return Object.assign({},o,Nt(t))},Vp=(e={})=>{const t=a=>({className:[e.className,a].filter(Boolean).join("__"),base:e.base?.[a]??{},variants:{},defaultVariants:e.defaultVariants??{},compoundVariants:e.compoundVariants?Pi(e.compoundVariants,a):[]}),o=(e.slots??[]).map(a=>[a,t(a)]);for(const[a,i]of Object.entries(e.variants??{}))for(const[s,l]of Object.entries(i))o.forEach(([r,d])=>{d.variants[a]??={},d.variants[a][s]=l[r]??{}});return Object.fromEntries(o)},Pi=(e,t)=>e.filter(o=>o.css[t]).map(o=>({...o,css:o.css[t]}));function he(e,...t){const o=Object.getOwnPropertyDescriptors(e),a=Object.keys(o),i=l=>{const r={};for(let d=0;d<l.length;d++){const u=l[d];o[u]&&(Object.defineProperty(r,u,o[u]),delete o[u])}return r},s=l=>i(Array.isArray(l)?l:a.filter(l));return t.map(s).concat(i(a))}var za=(...e)=>{const t=e.reduce((o,a)=>(a&&a.forEach(i=>o.add(i)),o),new Set([]));return Array.from(t)},Rl=["htmlSize","htmlTranslate","htmlWidth","htmlHeight"];function Wp(e){return Rl.includes(e)?e.replace("html","").toLowerCase():e}function $a(e){return Object.fromEntries(Object.entries(e).map(([t,o])=>[Wp(t),o]))}$a.keys=Rl;const Op="_hover,_focus,_focusWithin,_focusVisible,_disabled,_active,_visited,_target,_readOnly,_readWrite,_empty,_checked,_enabled,_expanded,_highlighted,_complete,_incomplete,_dragging,_before,_after,_firstLetter,_firstLine,_marker,_selection,_file,_backdrop,_first,_last,_only,_even,_odd,_firstOfType,_lastOfType,_onlyOfType,_peerFocus,_peerHover,_peerActive,_peerFocusWithin,_peerFocusVisible,_peerDisabled,_peerChecked,_peerInvalid,_peerExpanded,_peerPlaceholderShown,_groupFocus,_groupHover,_groupActive,_groupFocusWithin,_groupFocusVisible,_groupDisabled,_groupChecked,_groupExpanded,_groupInvalid,_indeterminate,_required,_valid,_invalid,_autofill,_inRange,_outOfRange,_placeholder,_placeholderShown,_pressed,_selected,_grabbed,_underValue,_overValue,_atValue,_default,_optional,_open,_closed,_fullscreen,_loading,_hidden,_current,_currentPage,_currentStep,_today,_unavailable,_rangeStart,_rangeEnd,_now,_topmost,_motionReduce,_motionSafe,_print,_landscape,_portrait,_dark,_light,_osDark,_osLight,_highContrast,_lessContrast,_moreContrast,_ltr,_rtl,_scrollbar,_scrollbarThumb,_scrollbarTrack,_horizontal,_vertical,_icon,_starting,_noscript,_invertedColors,_shapeSizeXs,_shapeSizeSm,_shapeSizeMd,_shapeSizeLg,_shapeSizeXl,_shapeRectangle,_shapePerson,_shapeBrowser,_shapeMobile,_shapeCylinder,_shapeStorage,_shapeQueue,_notDisabled,_reduceGraphics,_reduceGraphicsOnPan,_noReduceGraphics,_whenPanning,_smallZoom,_compoundTransparent,_edgeActive,_whenHovered,_whenSelectable,_whenSelected,_whenDimmed,_whenFocused,_p3,_srgb,_rec2020,xs,xsOnly,xsDown,sm,smOnly,smDown,md,mdOnly,mdDown,lg,lgOnly,lgDown,xl,xlOnly,xlDown,xsToSm,xsToMd,xsToLg,xsToXl,smToMd,smToLg,smToXl,mdToLg,mdToXl,lgToXl,@/xs,@/sm,@/md,@/lg,@likec4-root/xs,@likec4-root/sm,@likec4-root/md,@likec4-root/lg,@likec4-dialog/xs,@likec4-dialog/sm,@likec4-dialog/md,@likec4-dialog/lg,base",Dl=new Set(Op.split(",")),Hp=/^@|&|&$/;function Ps(e){return Dl.has(e)||Hp.test(e)}const Xp=/^_/,Yp=/&|@/;function Bl(e){return e.map(t=>Dl.has(t)?t.replace(Xp,""):Yp.test(t)?`[${Ci(t.trim())}]`:t)}function Ll(e){return e.sort((t,o)=>{const a=Ps(t),i=Ps(o);return a&&!i?1:!a&&i?-1:0})}const qp="aspectRatio:asp,boxDecorationBreak:bx-db,zIndex:z,boxSizing:bx-s,objectPosition:obj-p,objectFit:obj-f,overscrollBehavior:ovs-b,overscrollBehaviorX:ovs-bx,overscrollBehaviorY:ovs-by,position:pos/1,top:top,left:left,inset:inset,insetInline:inset-x/insetX,insetBlock:inset-y/insetY,insetBlockEnd:inset-be,insetBlockStart:inset-bs,insetInlineEnd:inset-e/insetEnd/end,insetInlineStart:inset-s/insetStart/start,right:right,bottom:bottom,float:float,visibility:vis,display:d,hideFrom:hide,hideBelow:show,flexBasis:flex-b,flex:flex,flexDirection:flex-d/flexDir,flexGrow:flex-g,flexShrink:flex-sh,gridTemplateColumns:grid-tc,gridTemplateRows:grid-tr,gridColumn:grid-c,gridRow:grid-r,gridColumnStart:grid-cs,gridColumnEnd:grid-ce,gridAutoFlow:grid-af,gridAutoColumns:grid-ac,gridAutoRows:grid-ar,gap:gap,gridGap:grid-g,gridRowGap:grid-rg,gridColumnGap:grid-cg,rowGap:rg,columnGap:cg,justifyContent:jc,alignContent:ac,alignItems:ai,alignSelf:as,padding:p/1,paddingLeft:pl/1,paddingRight:pr/1,paddingTop:pt/1,paddingBottom:pb/1,paddingBlock:py/1/paddingY,paddingBlockEnd:pbe,paddingBlockStart:pbs,paddingInline:px/paddingX/1,paddingInlineEnd:pe/1/paddingEnd,paddingInlineStart:ps/1/paddingStart,marginLeft:ml/1,marginRight:mr/1,marginTop:mt/1,marginBottom:mb/1,margin:m/1,marginBlock:my/1/marginY,marginBlockEnd:mbe,marginBlockStart:mbs,marginInline:mx/1/marginX,marginInlineEnd:me/1/marginEnd,marginInlineStart:ms/1/marginStart,spaceX:sx,spaceY:sy,outlineWidth:ring-w/ringWidth,outlineColor:ring-c/ringColor,outline:ring/1,outlineOffset:ring-o/ringOffset,focusRing:focus-ring,focusVisibleRing:focus-v-ring,focusRingColor:focus-ring-c,focusRingOffset:focus-ring-o,focusRingWidth:focus-ring-w,focusRingStyle:focus-ring-s,divideX:dvd-x,divideY:dvd-y,divideColor:dvd-c,divideStyle:dvd-s,width:w/1,inlineSize:w-is,minWidth:min-w/minW,minInlineSize:min-w-is,maxWidth:max-w/maxW,maxInlineSize:max-w-is,height:h/1,blockSize:h-bs,minHeight:min-h/minH,minBlockSize:min-h-bs,maxHeight:max-h/maxH,maxBlockSize:max-b,boxSize:size,color:c,fontFamily:ff,fontSize:fs,fontSizeAdjust:fs-a,fontPalette:fp,fontKerning:fk,fontFeatureSettings:ff-s,fontWeight:fw,fontSmoothing:fsmt,fontVariant:fv,fontVariantAlternates:fv-alt,fontVariantCaps:fv-caps,fontVariationSettings:fv-s,fontVariantNumeric:fv-num,letterSpacing:ls,lineHeight:lh,textAlign:ta,textDecoration:td,textDecorationColor:td-c,textEmphasisColor:te-c,textDecorationStyle:td-s,textDecorationThickness:td-t,textUnderlineOffset:tu-o,textTransform:tt,textIndent:ti,textShadow:tsh,textShadowColor:tsh-c/textShadowColor,textOverflow:tov,verticalAlign:va,wordBreak:wb,textWrap:tw,truncate:trunc,lineClamp:lc,listStyleType:li-t,listStylePosition:li-pos,listStyleImage:li-img,listStyle:li-s,backgroundPosition:bg-p/bgPosition,backgroundPositionX:bg-p-x/bgPositionX,backgroundPositionY:bg-p-y/bgPositionY,backgroundAttachment:bg-a/bgAttachment,backgroundClip:bg-cp/bgClip,background:bg/1,backgroundColor:bg-c/bgColor,backgroundOrigin:bg-o/bgOrigin,backgroundImage:bg-i/bgImage,backgroundRepeat:bg-r/bgRepeat,backgroundBlendMode:bg-bm/bgBlendMode,backgroundSize:bg-s/bgSize,backgroundGradient:bg-grad/bgGradient,backgroundLinear:bg-linear/bgLinear,backgroundRadial:bg-radial/bgRadial,backgroundConic:bg-conic/bgConic,textGradient:txt-grad,gradientFromPosition:grad-from-pos,gradientToPosition:grad-to-pos,gradientFrom:grad-from,gradientTo:grad-to,gradientVia:grad-via,gradientViaPosition:grad-via-pos,borderRadius:bdr/rounded,borderTopLeftRadius:bdr-tl/roundedTopLeft,borderTopRightRadius:bdr-tr/roundedTopRight,borderBottomRightRadius:bdr-br/roundedBottomRight,borderBottomLeftRadius:bdr-bl/roundedBottomLeft,borderTopRadius:bdr-t/roundedTop,borderRightRadius:bdr-r/roundedRight,borderBottomRadius:bdr-b/roundedBottom,borderLeftRadius:bdr-l/roundedLeft,borderStartStartRadius:bdr-ss/roundedStartStart,borderStartEndRadius:bdr-se/roundedStartEnd,borderStartRadius:bdr-s/roundedStart,borderEndStartRadius:bdr-es/roundedEndStart,borderEndEndRadius:bdr-ee/roundedEndEnd,borderEndRadius:bdr-e/roundedEnd,border:bd,borderWidth:bd-w,borderTopWidth:bd-t-w,borderLeftWidth:bd-l-w,borderRightWidth:bd-r-w,borderBottomWidth:bd-b-w,borderBlockStartWidth:bd-bs-w,borderBlockEndWidth:bd-be-w,borderColor:bd-c,borderInline:bd-x/borderX,borderInlineWidth:bd-x-w/borderXWidth,borderInlineColor:bd-x-c/borderXColor,borderBlock:bd-y/borderY,borderBlockWidth:bd-y-w/borderYWidth,borderBlockColor:bd-y-c/borderYColor,borderLeft:bd-l,borderLeftColor:bd-l-c,borderInlineStart:bd-s/borderStart,borderInlineStartWidth:bd-s-w/borderStartWidth,borderInlineStartColor:bd-s-c/borderStartColor,borderRight:bd-r,borderRightColor:bd-r-c,borderInlineEnd:bd-e/borderEnd,borderInlineEndWidth:bd-e-w/borderEndWidth,borderInlineEndColor:bd-e-c/borderEndColor,borderTop:bd-t,borderTopColor:bd-t-c,borderBottom:bd-b,borderBottomColor:bd-b-c,borderBlockEnd:bd-be,borderBlockEndColor:bd-be-c,borderBlockStart:bd-bs,borderBlockStartColor:bd-bs-c,opacity:op,boxShadow:bx-sh/shadow,boxShadowColor:bx-sh-c/shadowColor,mixBlendMode:mix-bm,filter:filter,brightness:brightness,contrast:contrast,grayscale:grayscale,hueRotate:hue-rotate,invert:invert,saturate:saturate,sepia:sepia,dropShadow:drop-shadow,blur:blur,backdropFilter:bkdp,backdropBlur:bkdp-blur,backdropBrightness:bkdp-brightness,backdropContrast:bkdp-contrast,backdropGrayscale:bkdp-grayscale,backdropHueRotate:bkdp-hue-rotate,backdropInvert:bkdp-invert,backdropOpacity:bkdp-opacity,backdropSaturate:bkdp-saturate,backdropSepia:bkdp-sepia,borderCollapse:bd-cl,borderSpacing:bd-sp,borderSpacingX:bd-sx,borderSpacingY:bd-sy,tableLayout:tbl,transitionTimingFunction:trs-tmf,transitionDelay:trs-dly,transitionDuration:trs-dur,transitionProperty:trs-prop,transition:transition,animation:anim,animationName:anim-n,animationTimingFunction:anim-tmf,animationDuration:anim-dur,animationDelay:anim-dly,animationPlayState:anim-ps,animationComposition:anim-comp,animationFillMode:anim-fm,animationDirection:anim-dir,animationIterationCount:anim-ic,animationRange:anim-r,animationState:anim-s,animationRangeStart:anim-rs,animationRangeEnd:anim-re,animationTimeline:anim-tl,transformOrigin:trf-o,transformBox:trf-b,transformStyle:trf-s,transform:trf,rotate:rotate,rotateX:rotate-x,rotateY:rotate-y,rotateZ:rotate-z,scale:scale,scaleX:scale-x,scaleY:scale-y,translate:translate,translateX:translate-x/x,translateY:translate-y/y,translateZ:translate-z/z,accentColor:ac-c,caretColor:ca-c,scrollBehavior:scr-bhv,scrollbar:scr-bar,scrollbarColor:scr-bar-c,scrollbarGutter:scr-bar-g,scrollbarWidth:scr-bar-w,scrollMargin:scr-m,scrollMarginLeft:scr-ml,scrollMarginRight:scr-mr,scrollMarginTop:scr-mt,scrollMarginBottom:scr-mb,scrollMarginBlock:scr-my/scrollMarginY,scrollMarginBlockEnd:scr-mbe,scrollMarginBlockStart:scr-mbt,scrollMarginInline:scr-mx/scrollMarginX,scrollMarginInlineEnd:scr-me,scrollMarginInlineStart:scr-ms,scrollPadding:scr-p,scrollPaddingBlock:scr-py/scrollPaddingY,scrollPaddingBlockStart:scr-pbs,scrollPaddingBlockEnd:scr-pbe,scrollPaddingInline:scr-px/scrollPaddingX,scrollPaddingInlineEnd:scr-pe,scrollPaddingInlineStart:scr-ps,scrollPaddingLeft:scr-pl,scrollPaddingRight:scr-pr,scrollPaddingTop:scr-pt,scrollPaddingBottom:scr-pb,scrollSnapAlign:scr-sa,scrollSnapStop:scrs-s,scrollSnapType:scrs-t,scrollSnapStrictness:scrs-strt,scrollSnapMargin:scrs-m,scrollSnapMarginTop:scrs-mt,scrollSnapMarginBottom:scrs-mb,scrollSnapMarginLeft:scrs-ml,scrollSnapMarginRight:scrs-mr,scrollSnapCoordinate:scrs-c,scrollSnapDestination:scrs-d,scrollSnapPointsX:scrs-px,scrollSnapPointsY:scrs-py,scrollSnapTypeX:scrs-tx,scrollSnapTypeY:scrs-ty,scrollTimeline:scrtl,scrollTimelineAxis:scrtl-a,scrollTimelineName:scrtl-n,touchAction:tch-a,userSelect:us,overflow:ov,overflowWrap:ov-wrap,overflowX:ov-x,overflowY:ov-y,overflowAnchor:ov-a,overflowBlock:ov-b,overflowInline:ov-i,overflowClipBox:ovcp-bx,overflowClipMargin:ovcp-m,overscrollBehaviorBlock:ovs-bb,overscrollBehaviorInline:ovs-bi,fill:fill,stroke:stk,strokeWidth:stk-w,strokeDasharray:stk-dsh,strokeDashoffset:stk-do,strokeLinecap:stk-lc,strokeLinejoin:stk-lj,strokeMiterlimit:stk-ml,strokeOpacity:stk-op,srOnly:sr,debug:debug,appearance:ap,backfaceVisibility:bfv,clipPath:cp-path,hyphens:hy,mask:msk,maskImage:msk-i,maskSize:msk-s,textSizeAdjust:txt-adj,container:cq,containerName:cq-n,containerType:cq-t,cursor:cursor,textStyle:textStyle,layerStyle:layerStyle,animationStyle:animationStyle",Tl=new Map,Al=new Map;qp.split(",").forEach(e=>{const[t,o]=e.split(":"),[a,...i]=o.split("/");Tl.set(t,a),i.length&&i.forEach(s=>{Al.set(s==="1"?a:s,t)})});const Ms=e=>Al.get(e)||e,zl={conditions:{shift:Ll,finalize:Bl,breakpoints:{keys:["base","xs","sm","md","lg","xl"]}},utility:{transform:(e,t)=>{const o=Ms(e);return{className:`${Tl.get(o)||Rp(o)}_${Ci(t)}`}},hasShorthand:!0,toHash:(e,t)=>t(e.join(":")),resolveShorthand:Ms}},Gp=El(zl),y=(...e)=>Gp(vt(...e));y.raw=(...e)=>vt(...e);const{mergeCss:vt}=Np(zl);function P(){let e="",t=0,o;for(;t<arguments.length;)(o=arguments[t++])&&typeof o=="string"&&(e&&(e+=" "),e+=o);return e}const Ns=e=>({base:{},variants:{},defaultVariants:{},compoundVariants:[],...e});function wo(e){const{base:t,variants:o,defaultVariants:a,compoundVariants:i}=Ns(e),s=h=>({...a,...Nt(h)});function l(h={}){const f=s(h);let x={...t};for(const[C,v]of Object.entries(f))o[C]?.[v]&&(x=vt(x,o[C][v]));const w=Fa(i,f);return vt(x,w)}function r(h){const f=Ns(h.config),x=za(h.variantKeys,Object.keys(o));return wo({base:vt(t,f.base),variants:Object.fromEntries(x.map(w=>[w,vt(o[w],f.variants[w])])),defaultVariants:Si(a,f.defaultVariants),compoundVariants:[...i,...f.compoundVariants]})}function d(h){return y(l(h))}const u=Object.keys(o);function c(h){return he(h,u)}const p=Object.fromEntries(Object.entries(o).map(([h,f])=>[h,Object.keys(f)]));return Object.assign(ye(d),{__cva__:!0,variantMap:p,variantKeys:u,raw:l,config:e,merge:r,splitVariantProps:c,getVariantProps:s})}function Fa(e,t){let o={};return e.forEach(a=>{Object.entries(a).every(([i,s])=>i==="css"?!0:(Array.isArray(s)?s:[s]).some(l=>t[i]===l))&&(o=vt(o,a.css))}),o}function Zp(e,t,o,a){if(t.length>0&&typeof o?.[a]=="object")throw new Error(`[recipe:${e}:${a}] Conditions are not supported when using compound variants.`)}function Kp(e){const t=Object.entries(Vp(e)).map(([p,h])=>[p,wo(h)]),o=e.defaultVariants??{},a=t.reduce((p,[h,f])=>(e.className&&(p[h]=f.config.className),p),{});function i(p){const h=t.map(([f,x])=>[f,P(x(p),a[f])]);return Object.fromEntries(h)}function s(p){const h=t.map(([f,x])=>[f,x.raw(p)]);return Object.fromEntries(h)}const l=e.variants??{},r=Object.keys(l);function d(p){return he(p,r)}const u=p=>({...o,...Nt(p)}),c=Object.fromEntries(Object.entries(l).map(([p,h])=>[p,Object.keys(h)]));return Object.assign(ye(i),{__cva__:!1,raw:s,config:e,variantMap:c,variantKeys:r,classNameMap:a,splitVariantProps:d,getVariantProps:u})}var Up={outline:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},filled:{xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"}};const B=(e,t,o,a)=>{const i=g.forwardRef(({color:s="currentColor",size:l=24,stroke:r=2,title:d,className:u,children:c,...p},h)=>g.createElement("svg",{ref:h,...Up[e],width:l,height:l,className:["tabler-icon",`tabler-icon-${t}`,u].join(" "),...e==="filled"?{fill:s}:{strokeWidth:r,stroke:s},...p},[d&&g.createElement("title",{key:"svg-title"},d),...a.map(([f,x])=>g.createElement(f,x)),...Array.isArray(c)?c:[c]]));return i.displayName=`${o}`,i},Qp=[["path",{d:"M12 9v4",key:"svg-0"}],["path",{d:"M10.363 3.591l-8.106 13.534a1.914 1.914 0 0 0 1.636 2.871h16.214a1.914 1.914 0 0 0 1.636 -2.87l-8.106 -13.536a1.914 1.914 0 0 0 -3.274 0z",key:"svg-1"}],["path",{d:"M12 16h.01",key:"svg-2"}]],$l=B("outline","alert-triangle","AlertTriangle",Qp),Jp=[["path",{d:"M7 7l10 10",key:"svg-0"}],["path",{d:"M17 8l0 9l-9 0",key:"svg-1"}]],eg=B("outline","arrow-down-right","ArrowDownRight",Jp),tg=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M5 12l6 6",key:"svg-1"}],["path",{d:"M5 12l6 -6",key:"svg-2"}]],og=B("outline","arrow-left","ArrowLeft",tg),ng=[["path",{d:"M5 12l14 0",key:"svg-0"}],["path",{d:"M13 18l6 -6",key:"svg-1"}],["path",{d:"M13 6l6 6",key:"svg-2"}]],Yt=B("outline","arrow-right","ArrowRight",ng),ag=[["path",{d:"M13 3l0 7l6 0l-8 11l0 -7l-6 0l8 -11",key:"svg-0"}]],ig=B("outline","bolt","Bolt",ag),sg=[["path",{d:"M4 8h16",key:"svg-0"}],["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-1"}],["path",{d:"M8 4v4",key:"svg-2"}]],rg=B("outline","browser","Browser",sg),lg=[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]],Fl=B("outline","check","Check",lg),dg=[["path",{d:"M6 9l6 6l6 -6",key:"svg-0"}]],Mi=B("outline","chevron-down","ChevronDown",dg),cg=[["path",{d:"M15 6l-6 6l6 6",key:"svg-0"}]],Vl=B("outline","chevron-left","ChevronLeft",cg),ug=[["path",{d:"M9 6l6 6l-6 6",key:"svg-0"}]],mt=B("outline","chevron-right","ChevronRight",ug),pg=[["path",{d:"M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z",key:"svg-0"}],["path",{d:"M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1",key:"svg-1"}]],gg=B("outline","copy","Copy",pg),hg=[["path",{d:"M12 6m-7 0a7 3 0 1 0 14 0a7 3 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M5 6v12c0 1.657 3.134 3 7 3s7 -1.343 7 -3v-12",key:"svg-1"}]],Is=B("outline","cylinder","Cylinder",hg),mg=[["path",{d:"M6 5a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2v-14z",key:"svg-0"}],["path",{d:"M11 4h2",key:"svg-1"}],["path",{d:"M12 17v.01",key:"svg-2"}]],fg=B("outline","device-mobile","DeviceMobile",mg),yg=[["path",{d:"M12 6h-6a2 2 0 0 0 -2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-6",key:"svg-0"}],["path",{d:"M11 13l9 -9",key:"svg-1"}],["path",{d:"M15 4h5v5",key:"svg-2"}]],Wl=B("outline","external-link","ExternalLink",yg),xg=[["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-0"}],["path",{d:"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z",key:"svg-1"}],["path",{d:"M10 13l-1 2l1 2",key:"svg-2"}],["path",{d:"M14 13l1 2l-1 2",key:"svg-3"}]],nv=B("outline","file-code","FileCode",xg),bg=[["path",{d:"M4 21v-4a3 3 0 0 1 3 -3h5",key:"svg-0"}],["path",{d:"M9 17l3 -3l-3 -3",key:"svg-1"}],["path",{d:"M14 3v4a1 1 0 0 0 1 1h4",key:"svg-2"}],["path",{d:"M5 11v-6a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-9.5",key:"svg-3"}]],Kt=B("outline","file-symlink","FileSymlink",bg),wg=[["path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2",key:"svg-1"}],["path",{d:"M4 16v2a2 2 0 0 0 2 2h2",key:"svg-2"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v2",key:"svg-3"}],["path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2",key:"svg-4"}]],vg=B("outline","focus-centered","FocusCentered",wg),kg=[["path",{d:"M5 19l2.757 -7.351a1 1 0 0 1 .936 -.649h12.307a1 1 0 0 1 .986 1.164l-.996 5.211a2 2 0 0 1 -1.964 1.625h-14.026a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2h4l3 3h7a2 2 0 0 1 2 2v2",key:"svg-0"}]],av=B("outline","folder-open","FolderOpen",kg),jg=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 16v.01",key:"svg-1"}],["path",{d:"M12 13a2 2 0 0 0 .914 -3.782a1.98 1.98 0 0 0 -2.414 .483",key:"svg-2"}]],Cg=B("outline","help-circle","HelpCircle",jg),Sg=[["path",{d:"M3 4m0 3a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v10a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3z",key:"svg-0"}],["path",{d:"M9 10m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M15 8l2 0",key:"svg-2"}],["path",{d:"M15 12l2 0",key:"svg-3"}],["path",{d:"M7 16l10 0",key:"svg-4"}]],Ni=B("outline","id","Id",Sg),_g=[["path",{d:"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0",key:"svg-0"}],["path",{d:"M12 9h.01",key:"svg-1"}],["path",{d:"M11 12h1v4h1",key:"svg-2"}]],Ii=B("outline","info-circle","InfoCircle",_g),Pg=[["path",{d:"M4 20l16 0",key:"svg-0"}],["path",{d:"M9 4m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-1"}]],Mg=B("outline","layout-align-bottom","LayoutAlignBottom",Pg),Ng=[["path",{d:"M12 4l0 5",key:"svg-0"}],["path",{d:"M12 15l0 5",key:"svg-1"}],["path",{d:"M6 9m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z",key:"svg-2"}]],Ig=B("outline","layout-align-center","LayoutAlignCenter",Ng),Eg=[["path",{d:"M4 4l0 16",key:"svg-0"}],["path",{d:"M8 9m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z",key:"svg-1"}]],Rg=B("outline","layout-align-left","LayoutAlignLeft",Eg),Dg=[["path",{d:"M4 12l5 0",key:"svg-0"}],["path",{d:"M15 12l5 0",key:"svg-1"}],["path",{d:"M9 6m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-2"}]],Bg=B("outline","layout-align-middle","LayoutAlignMiddle",Dg),Lg=[["path",{d:"M20 4l0 16",key:"svg-0"}],["path",{d:"M4 9m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z",key:"svg-1"}]],Tg=B("outline","layout-align-right","LayoutAlignRight",Lg),Ag=[["path",{d:"M4 4l16 0",key:"svg-0"}],["path",{d:"M9 8m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z",key:"svg-1"}]],zg=B("outline","layout-align-top","LayoutAlignTop",Ag),$g=[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M4 12h8",key:"svg-1"}],["path",{d:"M12 15h8",key:"svg-2"}],["path",{d:"M12 9h8",key:"svg-3"}],["path",{d:"M12 4v16",key:"svg-4"}]],Es=B("outline","layout-board-split","LayoutBoardSplit",$g),Fg=[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M10 4l4 16",key:"svg-1"}],["path",{d:"M12 12l-8 2",key:"svg-2"}]],Vg=B("outline","layout-collage","LayoutCollage",Fg),Wg=[["path",{d:"M5 4h4a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-6a1 1 0 0 1 1 -1",key:"svg-0"}],["path",{d:"M5 16h4a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-2a1 1 0 0 1 1 -1",key:"svg-1"}],["path",{d:"M15 12h4a1 1 0 0 1 1 1v6a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-6a1 1 0 0 1 1 -1",key:"svg-2"}],["path",{d:"M15 4h4a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1v-2a1 1 0 0 1 1 -1",key:"svg-3"}]],Og=B("outline","layout-dashboard","LayoutDashboard",Wg),Hg=[["path",{d:"M9 15l6 -6",key:"svg-0"}],["path",{d:"M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464",key:"svg-1"}],["path",{d:"M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463",key:"svg-2"}]],Xg=B("outline","link","Link",Hg),Yg=[["path",{d:"M3 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M9 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M13 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]],Ol=B("outline","lock-open-2","LockOpen2",Yg),qg=[["path",{d:"M5 13a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v6a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2v-6z",key:"svg-0"}],["path",{d:"M11 16a1 1 0 1 0 2 0a1 1 0 0 0 -2 0",key:"svg-1"}],["path",{d:"M8 11v-4a4 4 0 1 1 8 0v4",key:"svg-2"}]],Gg=B("outline","lock","Lock",qg),Zg=[["path",{d:"M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z",key:"svg-0"}],["path",{d:"M17 4a2 2 0 0 0 2 2a2 2 0 0 0 -2 2a2 2 0 0 0 -2 -2a2 2 0 0 0 2 -2",key:"svg-1"}],["path",{d:"M19 11h2m-1 -1v2",key:"svg-2"}]],iv=B("outline","moon-stars","MoonStars",Zg),Kg=[["path",{d:"M21 14.008v-5.018a1.98 1.98 0 0 0 -1 -1.717l-4 -2.008a2.016 2.016 0 0 0 -2 0l-10 5.008c-.619 .355 -1 1.01 -1 1.718v5.018c0 .709 .381 1.363 1 1.717l4 2.008a2.016 2.016 0 0 0 2 0l10 -5.008c.619 -.355 1 -1.01 1 -1.718z",key:"svg-0"}],["path",{d:"M9 21v-7.5",key:"svg-1"}],["path",{d:"M9 13.5l11.5 -5.5",key:"svg-2"}],["path",{d:"M3.5 11l5.5 2.5",key:"svg-3"}]],Ug=B("outline","rectangular-prism","RectangularPrism",Kg),Qg=[["path",{d:"M3 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-0"}],["path",{d:"M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-1"}],["path",{d:"M17 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z",key:"svg-2"}],["path",{d:"M5 11v-3a3 3 0 0 1 3 -3h8a3 3 0 0 1 3 3v3",key:"svg-3"}],["path",{d:"M16.5 8.5l2.5 2.5l2.5 -2.5",key:"svg-4"}]],Jg=B("outline","reorder","Reorder",Qg),eh=[["path",{d:"M6 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-0"}],["path",{d:"M18 5m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M12 19h4.5c.71 0 1.372 -.212 1.924 -.576m1.545 -2.459a3.5 3.5 0 0 0 -3.469 -3.965h-.499m-4 0h-3.501a3.5 3.5 0 0 1 -2.477 -5.972m2.477 -1.028h3.5",key:"svg-2"}],["path",{d:"M3 3l18 18",key:"svg-3"}]],th=B("outline","route-off","RouteOff",eh),oh=[["path",{d:"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0",key:"svg-0"}],["path",{d:"M21 21l-6 -6",key:"svg-1"}]],Ei=B("outline","search","Search",oh),nh=[["path",{d:"M8 9l4 -4l4 4",key:"svg-0"}],["path",{d:"M16 15l-4 4l-4 -4",key:"svg-1"}]],Ri=B("outline","selector","Selector",nh),ah=[["path",{d:"M6 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-0"}],["path",{d:"M18 6m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-1"}],["path",{d:"M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0",key:"svg-2"}],["path",{d:"M8.7 10.7l6.6 -3.4",key:"svg-3"}],["path",{d:"M8.7 13.3l6.6 3.4",key:"svg-4"}]],sv=B("outline","share","Share",ah),ih=[["path",{d:"M12 4l-8 4l8 4l8 -4l-8 -4",key:"svg-0"}],["path",{d:"M4 12l8 4l8 -4",key:"svg-1"}],["path",{d:"M4 16l8 4l8 -4",key:"svg-2"}]],Di=B("outline","stack-2","Stack2",ih),sh=[["path",{d:"M12 12m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0",key:"svg-0"}],["path",{d:"M3 12h1m8 -9v1m8 8h1m-9 8v1m-6.4 -15.4l.7 .7m12.1 -.7l-.7 .7m0 11.4l.7 .7m-12.1 -.7l-.7 .7",key:"svg-1"}]],rv=B("outline","sun","Sun",sh),rh=[["path",{d:"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0",key:"svg-0"}],["path",{d:"M12 12m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0",key:"svg-1"}],["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-2"}]],lh=B("outline","target","Target",rh),dh=[["path",{d:"M3 6a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-0"}],["path",{d:"M21 11v-3a2 2 0 0 0 -2 -2h-6l3 3m0 -6l-3 3",key:"svg-1"}],["path",{d:"M3 13v3a2 2 0 0 0 2 2h6l-3 -3m0 6l3 -3",key:"svg-2"}],["path",{d:"M15 18a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-3"}]],vo=B("outline","transform","Transform",dh),ch=[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2",key:"svg-1"}]],uh=B("outline","user","User",ch),ph=[["path",{d:"M18 6l-12 12",key:"svg-0"}],["path",{d:"M6 6l12 12",key:"svg-1"}]],Ut=B("outline","x","X",ph),gh=[["path",{d:"M4 8v-2a2 2 0 0 1 2 -2h2",key:"svg-0"}],["path",{d:"M4 16v2a2 2 0 0 0 2 2h2",key:"svg-1"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v2",key:"svg-2"}],["path",{d:"M16 20h2a2 2 0 0 0 2 -2v-2",key:"svg-3"}],["path",{d:"M8 11a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-4"}],["path",{d:"M16 16l-2.5 -2.5",key:"svg-5"}]],Le=B("outline","zoom-scan","ZoomScan",gh),hh=[["path",{d:"M10.52 2.614a2.095 2.095 0 0 1 2.835 -.117l.126 .117l7.905 7.905c.777 .777 .816 2.013 .117 2.836l-.117 .126l-7.905 7.905a2.094 2.094 0 0 1 -2.836 .117l-.126 -.117l-7.907 -7.906a2.096 2.096 0 0 1 -.115 -2.835l.117 -.126l7.905 -7.905zm5.969 9.535l.01 -.116l-.003 -.12l-.016 -.114l-.03 -.11l-.044 -.112l-.052 -.098l-.076 -.105l-.07 -.081l-3.5 -3.5l-.095 -.083a1 1 0 0 0 -1.226 0l-.094 .083l-.083 .094a1 1 0 0 0 0 1.226l.083 .094l1.792 1.793h-5.085l-.117 .007a1 1 0 0 0 0 1.986l.117 .007h5.085l-1.792 1.793l-.083 .094a1 1 0 0 0 1.403 1.403l.094 -.083l3.5 -3.5l.097 -.112l.05 -.074l.037 -.067l.05 -.112l.023 -.076l.025 -.117z",key:"svg-0"}]],mh=B("filled","direction-sign-filled","DirectionSignFilled",hh),fh=[["path",{d:"M9 3a1 1 0 0 1 .608 .206l.1 .087l2.706 2.707h6.586a3 3 0 0 1 2.995 2.824l.005 .176v8a3 3 0 0 1 -2.824 2.995l-.176 .005h-14a3 3 0 0 1 -2.995 -2.824l-.005 -.176v-11a3 3 0 0 1 2.824 -2.995l.176 -.005h4z",key:"svg-0"}]],yh=B("filled","folder-filled","FolderFilled",fh),xh=[["path",{d:"M6 4v16a1 1 0 0 0 1.524 .852l13 -8a1 1 0 0 0 0 -1.704l-13 -8a1 1 0 0 0 -1.524 .852z",key:"svg-0"}]],bh=B("filled","player-play-filled","PlayerPlayFilled",xh),wh=[["path",{d:"M19.496 4.136l-12 7a1 1 0 0 0 0 1.728l12 7a1 1 0 0 0 1.504 -.864v-14a1 1 0 0 0 -1.504 -.864z",key:"svg-0"}],["path",{d:"M4 4a1 1 0 0 1 .993 .883l.007 .117v14a1 1 0 0 1 -1.993 .117l-.007 -.117v-14a1 1 0 0 1 1 -1z",key:"svg-1"}]],vh=B("filled","player-skip-back-filled","PlayerSkipBackFilled",wh),kh=[["path",{d:"M3 5v14a1 1 0 0 0 1.504 .864l12 -7a1 1 0 0 0 0 -1.728l-12 -7a1 1 0 0 0 -1.504 .864z",key:"svg-0"}],["path",{d:"M20 4a1 1 0 0 1 .993 .883l.007 .117v14a1 1 0 0 1 -1.993 .117l-.007 -.117v-14a1 1 0 0 1 1 -1z",key:"svg-1"}]],jh=B("filled","player-skip-forward-filled","PlayerSkipForwardFilled",kh),Ch=[["path",{d:"M17 4h-10a3 3 0 0 0 -3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3 -3v-10a3 3 0 0 0 -3 -3z",key:"svg-0"}]],Sh=B("filled","player-stop-filled","PlayerStopFilled",Ch),_h=[["path",{d:"M8.243 7.34l-6.38 .925l-.113 .023a1 1 0 0 0 -.44 1.684l4.622 4.499l-1.09 6.355l-.013 .11a1 1 0 0 0 1.464 .944l5.706 -3l5.693 3l.1 .046a1 1 0 0 0 1.352 -1.1l-1.091 -6.355l4.624 -4.5l.078 -.085a1 1 0 0 0 -.633 -1.62l-6.38 -.926l-2.852 -5.78a1 1 0 0 0 -1.794 0l-2.853 5.78z",key:"svg-0"}]],Ph=B("filled","star-filled","StarFilled",_h),Va=g.createContext(null);function Mh({value:e,children:t}){return g.useContext(Va)?n.jsx(n.Fragment,{children:t}):n.jsx(Va.Provider,{value:e,children:t})}function zn({element:e,className:t,style:o}){const a=g.useContext(Va);if(!e||!e.icon||e.icon==="none")return null;let i;return e.icon.startsWith("http://")||e.icon.startsWith("https://")?i=n.jsx("img",{src:e.icon,alt:e.title}):a&&(i=n.jsx(a,{node:e})),i?n.jsx("div",{className:P(t,"likec4-element-icon"),"data-likec4-icon":e.icon,style:o,children:i}):null}const Nh={browser:rg,cylinder:Is,mobile:fg,person:uh,queue:Jg,rectangle:Ug,storage:Is};function Ih({element:e,className:t}){const o=n.jsx(zn,{element:e,className:t});if(o)return o;const a=Nh[e.shape];return n.jsx("div",{className:P(t,"likec4-shape-icon"),children:n.jsx(a,{})})}function Eh(e){switch(e){case"dots":return sa.Dots;case"lines":return sa.Lines;case"cross":return sa.Cross;default:it(e)}}const Rh=(e,t)=>typeof e.background=="string"&&typeof t.background=="string"?e.background===t.background:I(e.background,t.background),Hl=g.memo(({background:e})=>typeof e=="string"?n.jsx(us,{variant:Eh(e),size:2,gap:20}):n.jsx(us,{...e}),Rh);Hl.displayName="Background";function A(e){const t=g.useRef(e);t.current=e;const o=g.useRef(null);return o.current==null&&(o.current=((...a)=>t.current?.(...a))),o.current}const Dh=()=>{},Xl=(e,t)=>{if(e===t)return!0;if(e.length!==t.length)return!1;for(const[o,a]of e.entries())if(!(a===t[o]||ee(a,t[o])))return!1;return!0};function It(e,t,o,a){const i=_u();Pu(i?Dh:e,t,Xl,a)}function Yl(){return si()}function $n(e,t){return Ln(A(e),t??ee)}function Bi(){return Rn()}const Bh=e=>Math.round(e.transform[2]*100)/100;function Lh(){return Ln(Bh)}const Th=e=>e.transform[2]<.2;function Ah(){return Ln(Th)}function zh(){const e=typeof window<"u"&&typeof window.devicePixelRatio=="number"?window.devicePixelRatio:1;return ze(Math.floor(e),{min:1,max:4})}let To;function ut(e){return To??=zh(),To<2?Math.round(e):Math.round(e*To)/To}class Re{constructor(t,o){this.x=t,this.y=o}static create(...t){return t.length===2?new Re(t[0],t[1]):new Re(t[0].x,t[0].y)}static add(t,o){return{x:t.x+o.x,y:t.y+o.y}}static subtract(t,o){return{x:t.x-o.x,y:t.y-o.y}}static multiply(t,o){return{x:t.x*o,y:t.y*o}}static dot(t,o){return t.x*o.x+t.y*o.y}add(t){return new Re(this.x+t.x,this.y+t.y)}subtract(t){return new Re(this.x-t.x,this.y-t.y)}multiply(t){return new Re(this.x*t,this.y*t)}dot(t){return this.x*t.x+this.y*t.y}cross(t){return new Re(this.y*t.x-this.x*t.y,this.x*t.y-this.y*t.x)}length(){return this.x===0&&this.y===0?0:Math.sqrt(this.x**2+this.y**2)}normalize(){const t=this.length();return t===0?new Re(0,0):new Re(this.x/t,this.y/t)}}function we(...e){return e.length===1&&e[0]instanceof Re?e[0]:e.length===2?new Re(e[0],e[1]):new Re(e[0].x,e[0].y)}function Rs(e){const t={internals:{positionAbsolute:e.internals.positionAbsolute}};return e.measured&&(t.measured=e.measured),ct(e.width)&&(t.width=e.width),ct(e.height)&&(t.height=e.height),ct(e.initialWidth)&&(t.initialWidth=e.initialWidth),ct(e.initialHeight)&&(t.initialHeight=e.initialHeight),t}function Ds(e,t){const o=e.internals.positionAbsolute,a=t.internals.positionAbsolute;if(o.x!==a.x||o.y!==a.y)return!1;const i=e.measured?.width??e.width??e.initialWidth??0,s=t.measured?.width??t.width??t.initialWidth??0;if(i!==s)return!1;const l=e.measured?.height??e.height??e.initialHeight??0,r=t.measured?.height??t.height??t.initialHeight??0;return l===r}function po(e){const{width:t,height:o}=at(e),{x:a,y:i}=e.internals.positionAbsolute;return{x:a+t/2,y:i+o/2}}function ao(e,t,o=0){const a=po(e),{width:i,height:s}=at(e),l=we(t.x,t.y).subtract(a),r=(o+(i||0)/2)/l.x,d=(o+(s||0)/2)/l.y,u=Math.min(Math.abs(r),Math.abs(d));return we(l).multiply(u).add(a)}function Bs(e,t){return ao(e,po(t))}function fn(e){let[t,...o]=e;q(t,"start should be defined");const a=[];for(;ve(o,3);){const[i,s,l,...r]=o,d=new Mu(t[0],t[1],i[0],i[1],s[0],s[1],l[0],l[1]),u=d.inflections();u.length===0&&u.push(.5),u.forEach(c=>{const{x:p,y:h}=d.get(c);a.push({x:Math.round(p),y:Math.round(h)})}),o=r,t=l}return q(o.length===0,"all points should be consumed"),a}const Ls=(e,t)=>Math.abs(e-t)<3.1;function ql(e,t){const[o,a]=Na(e)?e:[e.x,e.y],[i,s]=Na(t)?t:[t.x,t.y];return Ls(o,i)&&Ls(a,s)}function ie(e){return e.stopPropagation()}function $h(e){let[t,...o]=e;q(t,"start should be defined");let a=`M ${t[0]},${t[1]}`;for(;ve(o,3);){const[i,s,l,...r]=o;a=a+` C ${i[0]},${i[1]} ${s[0]},${s[1]} ${l[0]},${l[1]}`,o=r}return q(o.length===0,"all points should be consumed"),a}const Ts=(e,t)=>(e.data.dimmed??!1)===t?e:{...e,data:{...e.data,dimmed:t}};function Fh(e,t){return t!==void 0?Ts(e,t):o=>Ts(o,e)}const As=(e,t)=>(e.data.hovered??!1)===t?e:{...e,data:{...e.data,hovered:t}};function Vh(e,t){return t!==void 0?As(e,t):o=>As(o,e)}function zs(e,t){return $u(e.data,t)?e:{...e,data:{...e.data,...t}}}function Wh(e,t){return t!==void 0?zs(e,t):o=>zs(o,e)}const G={setDimmed:Fh,setHovered:Vh,setData:Wh},qe={Compound:1,Edge:20,Element:20,Max:30},Fe=.05,Wa=3,$s={default:"16px",withControls:{top:"58px",left:"16px",right:"16px",bottom:"16px"}};function Li({nodes:e,edges:t,onEdgesChange:o,onNodesChange:a,className:i,pannable:s=!0,zoomable:l=!0,nodesSelectable:r=!0,nodesDraggable:d=!1,background:u="dots",children:c,colorMode:p,fitViewPadding:h=0,fitView:f=!0,zoomOnDoubleClick:x=!1,onViewportResize:w,onMoveEnd:C,onNodeMouseEnter:v,onNodeMouseLeave:k,onEdgeMouseEnter:_,onEdgeMouseLeave:m,...b}){const j=g.useMemo(()=>({minZoom:Fe,maxZoom:1,padding:h,includeHiddenNodes:!1}),[h]),S=u!=="transparent"&&u!=="solid",D=Ah(),M=Bi(),{colorScheme:Y}=pu();return p||(p=Y==="auto"?"system":Y),n.jsxs(gu,{colorMode:p,nodes:e,edges:t,className:P(u==="transparent"&&"bg-transparent",i),...D&&{"data-likec4-zoom-small":!0},zoomOnPinch:l,zoomOnScroll:!s&&l,...!l&&{zoomActivationKeyCode:null},zoomOnDoubleClick:x,maxZoom:l?Wa:1,minZoom:l?Fe:1,fitView:f,fitViewOptions:j,preventScrolling:l||s,defaultMarkerColor:"var(--xy-edge-stroke)",noDragClassName:"nodrag",noPanClassName:"nopan",noWheelClassName:"nowheel",panOnScroll:s,panOnDrag:s,...!s&&{panActivationKeyCode:null,selectionKeyCode:null},elementsSelectable:r,nodesFocusable:d||r,edgesFocusable:!1,nodesDraggable:d,nodeDragThreshold:4,nodeClickDistance:3,paneClickDistance:3,elevateNodesOnSelect:!1,selectNodesOnDrag:!1,onNodesChange:a,onEdgesChange:o,onMoveEnd:A((O,{x:$,y:N,zoom:F})=>{const E=ut($),J=ut(N);($!==E||N!==J)&&M.setState({transform:[E,J,F]}),C?.(O,{x:E,y:J,zoom:F})}),onNodeMouseEnter:A((O,$)=>{if(v){v(O,$);return}a([{id:$.id,type:"replace",item:G.setHovered($,!0)}])}),onNodeMouseLeave:A((O,$)=>{if(k){k(O,$);return}a([{id:$.id,type:"replace",item:G.setHovered($,!1)}])}),onEdgeMouseEnter:A((O,$)=>{if(_){_(O,$);return}o([{id:$.id,type:"replace",item:G.setHovered($,!0)}])}),onEdgeMouseLeave:A((O,$)=>{if(m){m(O,$);return}o([{id:$.id,type:"replace",item:G.setHovered($,!1)}])}),onNodeDoubleClick:ie,onEdgeDoubleClick:ie,...b,children:[S&&n.jsx(Hl,{background:u}),w&&n.jsx(Hh,{onViewportResize:w}),c]})}const Oh=({width:e,height:t})=>(e||1)*(t||1),Hh=({onViewportResize:e})=>{const t=Ln(Oh);return It(e,[t]),null};function Fs(e,t){return t.map(o=>{const a=e.find(i=>i.id===o.id);if(a&&a.type===o.type&&a.source===o.source&&a.target===o.target){const i=I(a.data,o.data);return i&&I(a.hidden??!1,o.hidden??!1)&&I(a.selected??!1,o.selected??!1)&&I(a.animated??!1,o.animated??!1)&&I(a.sourceHandle??null,o.sourceHandle??null)&&I(a.targetHandle??null,o.targetHandle??null)&&I(a.zIndex??0,o.zIndex??0)&&I(a.label??null,o.label??null)?a:{...gt(a,["hidden","zIndex"]),...o,data:i?a.data:o.data}}return o})}function Gl(e,t){return kl(t)?Fs(e,t):(t=e,o=>Fs(o,t))}function Vs(e,t){return t.map(o=>{const a=e.find(i=>i.id===o.id);if(a&&I(a.type,o.type)){const i=I(a.data,o.data),{width:s,height:l}=at(a);return i&&I(s,o.initialWidth)&&I(l,o.initialHeight)&&I(a.parentId??null,o.parentId??null)&&I(a.hidden??!1,o.hidden??!1)&&I(a.zIndex??0,o.zIndex??0)&&I(a.position,o.position)?a:{...gt(a,["measured","parentId","hidden","zIndex"]),...o,width:o.initialWidth,height:o.initialHeight,data:i?a.data:o.data}}return o})}function Oa(e,t){return kl(t)?Vs(e,t):(t=e,o=>Vs(o,t))}const Ti=g.createContext(null);function Zl(){const e=g.useContext(Ti);if(!e)throw new Error("useRootContainer must be used within a RootContainer");return e}function Xh(){return Zl().ref}function Yh(){return Zl().ref.current}const Kl=g.createContext(null);function qh(){const e=g.useContext(Kl);return e===null&&console.warn("ReduceGraphicsMode is not provided"),e??!1}const[Gh,Zh]=Zr("PanningAtomSafeCtx is not provided");function Kh({id:e,className:t,reduceGraphics:o=!1,children:a}){const[i,s]=g.useState(!1),l=g.useRef(null),r=g.useRef(null);r.current||(r.current=Gu(!1)),Zu(()=>{s(!0)},[]),g.useEffect(()=>r.current?.subscribe(u=>{l.current?.setAttribute("data-likec4-diagram-panning",u?"true":"false")}),[]);const d=g.useMemo(()=>({id:e,ref:l}),[e,l]);return n.jsx(Gh,{value:r.current,children:n.jsx(Kl.Provider,{value:o,children:n.jsx("div",{id:e,className:P("likec4-root",t),ref:l,...o&&{"data-likec4-reduced-graphics":!0},children:i&&!!d.ref.current&&n.jsx(Ti.Provider,{value:d,children:a})})})})}const Ul={onChange:null,onNavigateTo:null,onNodeClick:null,onNodeContextMenu:null,onCanvasContextMenu:null,onEdgeClick:null,onEdgeContextMenu:null,onCanvasClick:null,onCanvasDblClick:null,onBurgerMenuClick:null,onOpenSource:null,onInitialized:null,onLayoutTypeChange:null},Ha=ei(Ul),Ql=g.createContext({...Pn(Ha,e=>[e,null]),handlersRef:{current:Ul}});function Uh({handlers:e,children:t}){const o=bl(e),a=Ha.map(s=>Tn(e[s])),i=g.useMemo(()=>({...Pn(Ha,s=>o.current[s]?[s,(...l)=>o.current[s]?.(...l)]:[s,null]),handlersRef:o}),[o,...a]);return n.jsx(Ql.Provider,{value:i,children:t})}function Qt(){return g.useContext(Ql)}const Jl={enableReadOnly:!0,enableCompareWithLatest:!1,enableControls:!1,enableDynamicViewWalkthrough:!1,enableElementDetails:!1,enableFocusMode:!1,enableNavigateTo:!1,enableNotations:!1,enableRelationshipBrowser:!1,enableRelationshipDetails:!1,enableSearch:!1,enableNavigationButtons:!1,enableFitView:!1,enableVscode:!1,enableElementTags:!1},Xa=g.createContext(Jl);function Pt({children:e,features:t,overrides:o}){const a=g.useContext(Xa),[i,s]=g.useState(a);return g.useEffect(()=>{s(l=>{const r={...a,...t,...o};return ee(l,r)?l:r})},[a,t,o]),n.jsx(Xa.Provider,{value:i,children:e})}const Qh={enableControls:!1,enableReadOnly:!0,enableCompareWithLatest:!1};Pt.Overlays=({children:e})=>n.jsx(Pt,{overrides:Qh,children:e});function Z(){return g.useContext(Xa)}function Jh({feature:e,children:t,and:o=!0}){return Z()[`enable${e}`]===!0&&o?n.jsx(n.Fragment,{children:t}):null}function ed({children:e}){const t=g.useContext(Ou);return g.useEffect(()=>{t||console.warn("LikeC4Diagram must be a child of MantineProvider")},[]),t?n.jsx(n.Fragment,{children:e}):n.jsx(Hu,{defaultColorScheme:"auto",children:e})}ed.displayName="EnsureMantine";const em=({reducedMotion:e="user",children:t})=>{const o=ti()?.();return n.jsx(Xu,{features:Yu,strict:!0,children:n.jsx(qu,{reducedMotion:e,...o&&{nonce:o},children:t})})},Fn=g.createContext(null),Ai=g.createContext(null);function je(){const e=g.useContext(Fn);if(!e)throw new Error("LikeC4Model not found. Make sure you have LikeC4ModelProvider.");return e}function tm(){const e=je(),[t,o]=g.useState(e.$data.specification);return g.useEffect(()=>{o(a=>I(a,e.$data.specification)?a:e.$data.specification)},[e]),t}const td=g.createContext({}),om=gp,nm=e=>{const t=e.color;if(Cl(e))return`
      --colors-likec4-tag-bg: ${t};
      --colors-likec4-tag-bg-hover: color-mix(in srgb, ${t}, var(--colors-likec4-mix-color) 20%);
    `;if(!om.includes(t))return"";let o="12";return["mint","grass","lime","yellow","amber"].includes(t)&&(o="dark-2"),`
  --colors-likec4-tag-border: var(--colors-${t}-8);
  --colors-likec4-tag-bg: var(--colors-${t}-9);
  --colors-likec4-tag-bg-hover: var(--colors-${t}-10);
  --colors-likec4-tag-text: var(--colors-${t}-${o});
  `};function am(e,t){return!e||Ct(e)?"":ce(hi(e),Qu(([o,a])=>[`:is(${t} [data-likec4-tag="${o}"]) {`,nm(a),"}"]),fl(`
`))}function im({children:e,rootSelector:t}){const o=tm().tags,a=am(o,t);return n.jsxs(td.Provider,{value:o,children:[a!==""&&n.jsx(sm,{stylesheet:a}),e]})}const sm=g.memo(({stylesheet:e})=>{const t=ti()?.();return n.jsx("style",{"data-likec4-tags":!0,type:"text/css",dangerouslySetInnerHTML:{__html:e},nonce:t})});function rm(e){return g.useContext(td)[e]??{color:"tomato"}}function lm(){return pl().replace("mantine-","likec4-")}var dm="css,pos,insetX,insetY,insetEnd,end,insetStart,start,flexDir,p,pl,pr,pt,pb,py,paddingY,paddingX,px,pe,paddingEnd,ps,paddingStart,ml,mr,mt,mb,m,my,marginY,mx,marginX,me,marginEnd,ms,marginStart,ringWidth,ringColor,ring,ringOffset,w,minW,maxW,h,minH,maxH,textShadowColor,bgPosition,bgPositionX,bgPositionY,bgAttachment,bgClip,bg,bgColor,bgOrigin,bgImage,bgRepeat,bgBlendMode,bgSize,bgGradient,bgLinear,bgRadial,bgConic,rounded,roundedTopLeft,roundedTopRight,roundedBottomRight,roundedBottomLeft,roundedTop,roundedRight,roundedBottom,roundedLeft,roundedStartStart,roundedStartEnd,roundedStart,roundedEndStart,roundedEndEnd,roundedEnd,borderX,borderXWidth,borderXColor,borderY,borderYWidth,borderYColor,borderStart,borderStartWidth,borderStartColor,borderEnd,borderEndWidth,borderEndColor,shadow,shadowColor,x,y,z,scrollMarginY,scrollMarginX,scrollPaddingY,scrollPaddingX,aspectRatio,boxDecorationBreak,zIndex,boxSizing,objectPosition,objectFit,overscrollBehavior,overscrollBehaviorX,overscrollBehaviorY,position,top,left,inset,insetInline,insetBlock,insetBlockEnd,insetBlockStart,insetInlineEnd,insetInlineStart,right,bottom,float,visibility,display,hideFrom,hideBelow,flexBasis,flex,flexDirection,flexGrow,flexShrink,gridTemplateColumns,gridTemplateRows,gridColumn,gridRow,gridColumnStart,gridColumnEnd,gridAutoFlow,gridAutoColumns,gridAutoRows,gap,gridGap,gridRowGap,gridColumnGap,rowGap,columnGap,justifyContent,alignContent,alignItems,alignSelf,padding,paddingLeft,paddingRight,paddingTop,paddingBottom,paddingBlock,paddingBlockEnd,paddingBlockStart,paddingInline,paddingInlineEnd,paddingInlineStart,marginLeft,marginRight,marginTop,marginBottom,margin,marginBlock,marginBlockEnd,marginBlockStart,marginInline,marginInlineEnd,marginInlineStart,spaceX,spaceY,outlineWidth,outlineColor,outline,outlineOffset,focusRing,focusVisibleRing,focusRingColor,focusRingOffset,focusRingWidth,focusRingStyle,divideX,divideY,divideColor,divideStyle,width,inlineSize,minWidth,minInlineSize,maxWidth,maxInlineSize,height,blockSize,minHeight,minBlockSize,maxHeight,maxBlockSize,boxSize,color,fontFamily,fontSize,fontSizeAdjust,fontPalette,fontKerning,fontFeatureSettings,fontWeight,fontSmoothing,fontVariant,fontVariantAlternates,fontVariantCaps,fontVariationSettings,fontVariantNumeric,letterSpacing,lineHeight,textAlign,textDecoration,textDecorationColor,textEmphasisColor,textDecorationStyle,textDecorationThickness,textUnderlineOffset,textTransform,textIndent,textShadow,textOverflow,verticalAlign,wordBreak,textWrap,truncate,lineClamp,listStyleType,listStylePosition,listStyleImage,listStyle,backgroundPosition,backgroundPositionX,backgroundPositionY,backgroundAttachment,backgroundClip,background,backgroundColor,backgroundOrigin,backgroundImage,backgroundRepeat,backgroundBlendMode,backgroundSize,backgroundGradient,backgroundLinear,backgroundRadial,backgroundConic,textGradient,gradientFromPosition,gradientToPosition,gradientFrom,gradientTo,gradientVia,gradientViaPosition,borderRadius,borderTopLeftRadius,borderTopRightRadius,borderBottomRightRadius,borderBottomLeftRadius,borderTopRadius,borderRightRadius,borderBottomRadius,borderLeftRadius,borderStartStartRadius,borderStartEndRadius,borderStartRadius,borderEndStartRadius,borderEndEndRadius,borderEndRadius,border,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,borderBlockStartWidth,borderBlockEndWidth,borderColor,borderInline,borderInlineWidth,borderInlineColor,borderBlock,borderBlockWidth,borderBlockColor,borderLeft,borderLeftColor,borderInlineStart,borderInlineStartWidth,borderInlineStartColor,borderRight,borderRightColor,borderInlineEnd,borderInlineEndWidth,borderInlineEndColor,borderTop,borderTopColor,borderBottom,borderBottomColor,borderBlockEnd,borderBlockEndColor,borderBlockStart,borderBlockStartColor,opacity,boxShadow,boxShadowColor,mixBlendMode,filter,brightness,contrast,grayscale,hueRotate,invert,saturate,sepia,dropShadow,blur,backdropFilter,backdropBlur,backdropBrightness,backdropContrast,backdropGrayscale,backdropHueRotate,backdropInvert,backdropOpacity,backdropSaturate,backdropSepia,borderCollapse,borderSpacing,borderSpacingX,borderSpacingY,tableLayout,transitionTimingFunction,transitionDelay,transitionDuration,transitionProperty,transition,animation,animationName,animationTimingFunction,animationDuration,animationDelay,animationPlayState,animationComposition,animationFillMode,animationDirection,animationIterationCount,animationRange,animationState,animationRangeStart,animationRangeEnd,animationTimeline,transformOrigin,transformBox,transformStyle,transform,rotate,rotateX,rotateY,rotateZ,scale,scaleX,scaleY,translate,translateX,translateY,translateZ,accentColor,caretColor,scrollBehavior,scrollbar,scrollbarColor,scrollbarGutter,scrollbarWidth,scrollMargin,scrollMarginLeft,scrollMarginRight,scrollMarginTop,scrollMarginBottom,scrollMarginBlock,scrollMarginBlockEnd,scrollMarginBlockStart,scrollMarginInline,scrollMarginInlineEnd,scrollMarginInlineStart,scrollPadding,scrollPaddingBlock,scrollPaddingBlockStart,scrollPaddingBlockEnd,scrollPaddingInline,scrollPaddingInlineEnd,scrollPaddingInlineStart,scrollPaddingLeft,scrollPaddingRight,scrollPaddingTop,scrollPaddingBottom,scrollSnapAlign,scrollSnapStop,scrollSnapType,scrollSnapStrictness,scrollSnapMargin,scrollSnapMarginTop,scrollSnapMarginBottom,scrollSnapMarginLeft,scrollSnapMarginRight,scrollSnapCoordinate,scrollSnapDestination,scrollSnapPointsX,scrollSnapPointsY,scrollSnapTypeX,scrollSnapTypeY,scrollTimeline,scrollTimelineAxis,scrollTimelineName,touchAction,userSelect,overflow,overflowWrap,overflowX,overflowY,overflowAnchor,overflowBlock,overflowInline,overflowClipBox,overflowClipMargin,overscrollBehaviorBlock,overscrollBehaviorInline,fill,stroke,strokeWidth,strokeDasharray,strokeDashoffset,strokeLinecap,strokeLinejoin,strokeMiterlimit,strokeOpacity,srOnly,debug,appearance,backfaceVisibility,clipPath,hyphens,mask,maskImage,maskSize,textSizeAdjust,container,containerName,containerType,cursor,colorPalette,_hover,_focus,_focusWithin,_focusVisible,_disabled,_active,_visited,_target,_readOnly,_readWrite,_empty,_checked,_enabled,_expanded,_highlighted,_complete,_incomplete,_dragging,_before,_after,_firstLetter,_firstLine,_marker,_selection,_file,_backdrop,_first,_last,_only,_even,_odd,_firstOfType,_lastOfType,_onlyOfType,_peerFocus,_peerHover,_peerActive,_peerFocusWithin,_peerFocusVisible,_peerDisabled,_peerChecked,_peerInvalid,_peerExpanded,_peerPlaceholderShown,_groupFocus,_groupHover,_groupActive,_groupFocusWithin,_groupFocusVisible,_groupDisabled,_groupChecked,_groupExpanded,_groupInvalid,_indeterminate,_required,_valid,_invalid,_autofill,_inRange,_outOfRange,_placeholder,_placeholderShown,_pressed,_selected,_grabbed,_underValue,_overValue,_atValue,_default,_optional,_open,_closed,_fullscreen,_loading,_hidden,_current,_currentPage,_currentStep,_today,_unavailable,_rangeStart,_rangeEnd,_now,_topmost,_motionReduce,_motionSafe,_print,_landscape,_portrait,_dark,_light,_osDark,_osLight,_highContrast,_lessContrast,_moreContrast,_ltr,_rtl,_scrollbar,_scrollbarThumb,_scrollbarTrack,_horizontal,_vertical,_icon,_starting,_noscript,_invertedColors,_shapeSizeXs,_shapeSizeSm,_shapeSizeMd,_shapeSizeLg,_shapeSizeXl,_shapeRectangle,_shapePerson,_shapeBrowser,_shapeMobile,_shapeCylinder,_shapeStorage,_shapeQueue,_notDisabled,_reduceGraphics,_reduceGraphicsOnPan,_noReduceGraphics,_whenPanning,_smallZoom,_compoundTransparent,_edgeActive,_whenHovered,_whenSelectable,_whenSelected,_whenDimmed,_whenFocused,_p3,_srgb,_rec2020,xs,xsOnly,xsDown,sm,smOnly,smDown,md,mdOnly,mdDown,lg,lgOnly,lgDown,xl,xlOnly,xlDown,xsToSm,xsToMd,xsToLg,xsToXl,smToMd,smToLg,smToXl,mdToLg,mdToXl,lgToXl,@/xs,@/sm,@/md,@/lg,@likec4-root/xs,@likec4-root/sm,@likec4-root/md,@likec4-root/lg,@likec4-dialog/xs,@likec4-dialog/sm,@likec4-dialog/md,@likec4-dialog/lg,textStyle,layerStyle,animationStyle",cm=dm.split(","),um="WebkitAppearance,WebkitBorderBefore,WebkitBorderBeforeColor,WebkitBorderBeforeStyle,WebkitBorderBeforeWidth,WebkitBoxReflect,WebkitLineClamp,WebkitMask,WebkitMaskAttachment,WebkitMaskClip,WebkitMaskComposite,WebkitMaskImage,WebkitMaskOrigin,WebkitMaskPosition,WebkitMaskPositionX,WebkitMaskPositionY,WebkitMaskRepeat,WebkitMaskRepeatX,WebkitMaskRepeatY,WebkitMaskSize,WebkitOverflowScrolling,WebkitTapHighlightColor,WebkitTextFillColor,WebkitTextStroke,WebkitTextStrokeColor,WebkitTextStrokeWidth,WebkitTouchCallout,WebkitUserModify,WebkitUserSelect,accentColor,alignContent,alignItems,alignSelf,alignTracks,all,anchorName,anchorScope,animation,animationComposition,animationDelay,animationDirection,animationDuration,animationFillMode,animationIterationCount,animationName,animationPlayState,animationRange,animationRangeEnd,animationRangeStart,animationTimeline,animationTimingFunction,appearance,aspectRatio,backdropFilter,backfaceVisibility,background,backgroundAttachment,backgroundBlendMode,backgroundClip,backgroundColor,backgroundImage,backgroundOrigin,backgroundPosition,backgroundPositionX,backgroundPositionY,backgroundRepeat,backgroundSize,blockSize,border,borderBlock,borderBlockColor,borderBlockEnd,borderBlockEndColor,borderBlockEndStyle,borderBlockEndWidth,borderBlockStart,borderBlockStartColor,borderBlockStartStyle,borderBlockStartWidth,borderBlockStyle,borderBlockWidth,borderBottom,borderBottomColor,borderBottomLeftRadius,borderBottomRightRadius,borderBottomStyle,borderBottomWidth,borderCollapse,borderColor,borderEndEndRadius,borderEndStartRadius,borderImage,borderImageOutset,borderImageRepeat,borderImageSlice,borderImageSource,borderImageWidth,borderInline,borderInlineColor,borderInlineEnd,borderInlineEndColor,borderInlineEndStyle,borderInlineEndWidth,borderInlineStart,borderInlineStartColor,borderInlineStartStyle,borderInlineStartWidth,borderInlineStyle,borderInlineWidth,borderLeft,borderLeftColor,borderLeftStyle,borderLeftWidth,borderRadius,borderRight,borderRightColor,borderRightStyle,borderRightWidth,borderSpacing,borderStartEndRadius,borderStartStartRadius,borderStyle,borderTop,borderTopColor,borderTopLeftRadius,borderTopRightRadius,borderTopStyle,borderTopWidth,borderWidth,bottom,boxAlign,boxDecorationBreak,boxDirection,boxFlex,boxFlexGroup,boxLines,boxOrdinalGroup,boxOrient,boxPack,boxShadow,boxSizing,breakAfter,breakBefore,breakInside,captionSide,caret,caretColor,caretShape,clear,clip,clipPath,clipRule,color,colorInterpolationFilters,colorScheme,columnCount,columnFill,columnGap,columnRule,columnRuleColor,columnRuleStyle,columnRuleWidth,columnSpan,columnWidth,columns,contain,containIntrinsicBlockSize,containIntrinsicHeight,containIntrinsicInlineSize,containIntrinsicSize,containIntrinsicWidth,container,containerName,containerType,content,contentVisibility,counterIncrement,counterReset,counterSet,cursor,cx,cy,d,direction,display,dominantBaseline,emptyCells,fieldSizing,fill,fillOpacity,fillRule,filter,flex,flexBasis,flexDirection,flexFlow,flexGrow,flexShrink,flexWrap,float,floodColor,floodOpacity,font,fontFamily,fontFeatureSettings,fontKerning,fontLanguageOverride,fontOpticalSizing,fontPalette,fontSize,fontSizeAdjust,fontSmooth,fontStretch,fontStyle,fontSynthesis,fontSynthesisPosition,fontSynthesisSmallCaps,fontSynthesisStyle,fontSynthesisWeight,fontVariant,fontVariantAlternates,fontVariantCaps,fontVariantEastAsian,fontVariantEmoji,fontVariantLigatures,fontVariantNumeric,fontVariantPosition,fontVariationSettings,fontWeight,forcedColorAdjust,gap,grid,gridArea,gridAutoColumns,gridAutoFlow,gridAutoRows,gridColumn,gridColumnEnd,gridColumnGap,gridColumnStart,gridGap,gridRow,gridRowEnd,gridRowGap,gridRowStart,gridTemplate,gridTemplateAreas,gridTemplateColumns,gridTemplateRows,hangingPunctuation,height,hyphenateCharacter,hyphenateLimitChars,hyphens,imageOrientation,imageRendering,imageResolution,imeMode,initialLetter,initialLetterAlign,inlineSize,inset,insetBlock,insetBlockEnd,insetBlockStart,insetInline,insetInlineEnd,insetInlineStart,interpolateSize,isolation,justifyContent,justifyItems,justifySelf,justifyTracks,left,letterSpacing,lightingColor,lineBreak,lineClamp,lineHeight,lineHeightStep,listStyle,listStyleImage,listStylePosition,listStyleType,margin,marginBlock,marginBlockEnd,marginBlockStart,marginBottom,marginInline,marginInlineEnd,marginInlineStart,marginLeft,marginRight,marginTop,marginTrim,marker,markerEnd,markerMid,markerStart,mask,maskBorder,maskBorderMode,maskBorderOutset,maskBorderRepeat,maskBorderSlice,maskBorderSource,maskBorderWidth,maskClip,maskComposite,maskImage,maskMode,maskOrigin,maskPosition,maskRepeat,maskSize,maskType,masonryAutoFlow,mathDepth,mathShift,mathStyle,maxBlockSize,maxHeight,maxInlineSize,maxLines,maxWidth,minBlockSize,minHeight,minInlineSize,minWidth,mixBlendMode,objectFit,objectPosition,offset,offsetAnchor,offsetDistance,offsetPath,offsetPosition,offsetRotate,opacity,order,orphans,outline,outlineColor,outlineOffset,outlineStyle,outlineWidth,overflow,overflowAnchor,overflowBlock,overflowClipBox,overflowClipMargin,overflowInline,overflowWrap,overflowX,overflowY,overlay,overscrollBehavior,overscrollBehaviorBlock,overscrollBehaviorInline,overscrollBehaviorX,overscrollBehaviorY,padding,paddingBlock,paddingBlockEnd,paddingBlockStart,paddingBottom,paddingInline,paddingInlineEnd,paddingInlineStart,paddingLeft,paddingRight,paddingTop,page,pageBreakAfter,pageBreakBefore,pageBreakInside,paintOrder,perspective,perspectiveOrigin,placeContent,placeItems,placeSelf,pointerEvents,position,positionAnchor,positionArea,positionTry,positionTryFallbacks,positionTryOrder,positionVisibility,printColorAdjust,quotes,r,resize,right,rotate,rowGap,rubyAlign,rubyMerge,rubyPosition,rx,ry,scale,scrollBehavior,scrollMargin,scrollMarginBlock,scrollMarginBlockEnd,scrollMarginBlockStart,scrollMarginBottom,scrollMarginInline,scrollMarginInlineEnd,scrollMarginInlineStart,scrollMarginLeft,scrollMarginRight,scrollMarginTop,scrollPadding,scrollPaddingBlock,scrollPaddingBlockEnd,scrollPaddingBlockStart,scrollPaddingBottom,scrollPaddingInline,scrollPaddingInlineEnd,scrollPaddingInlineStart,scrollPaddingLeft,scrollPaddingRight,scrollPaddingTop,scrollSnapAlign,scrollSnapCoordinate,scrollSnapDestination,scrollSnapPointsX,scrollSnapPointsY,scrollSnapStop,scrollSnapType,scrollSnapTypeX,scrollSnapTypeY,scrollTimeline,scrollTimelineAxis,scrollTimelineName,scrollbarColor,scrollbarGutter,scrollbarWidth,shapeImageThreshold,shapeMargin,shapeOutside,shapeRendering,stopColor,stopOpacity,stroke,strokeDasharray,strokeDashoffset,strokeLinecap,strokeLinejoin,strokeMiterlimit,strokeOpacity,strokeWidth,tabSize,tableLayout,textAlign,textAlignLast,textAnchor,textBox,textBoxEdge,textBoxTrim,textCombineUpright,textDecoration,textDecorationColor,textDecorationLine,textDecorationSkip,textDecorationSkipInk,textDecorationStyle,textDecorationThickness,textEmphasis,textEmphasisColor,textEmphasisPosition,textEmphasisStyle,textIndent,textJustify,textOrientation,textOverflow,textRendering,textShadow,textSizeAdjust,textSpacingTrim,textTransform,textUnderlineOffset,textUnderlinePosition,textWrap,textWrapMode,textWrapStyle,timelineScope,top,touchAction,transform,transformBox,transformOrigin,transformStyle,transition,transitionBehavior,transitionDelay,transitionDuration,transitionProperty,transitionTimingFunction,translate,unicodeBidi,userSelect,vectorEffect,verticalAlign,viewTimeline,viewTimelineAxis,viewTimelineInset,viewTimelineName,viewTransitionName,visibility,whiteSpace,whiteSpaceCollapse,widows,width,willChange,wordBreak,wordSpacing,wordWrap,writingMode,x,y,zIndex,zoom,alignmentBaseline,baselineShift,colorInterpolation,colorRendering,glyphOrientationVertical",pm=um.split(",").concat(cm),gm=new Map(pm.map(e=>[e,!0])),hm=/&|@/,od=ye(e=>gm.has(e)||e.startsWith("--")||hm.test(e));const mm=(e,t)=>!t.includes(e)&&!od(e),fm=(e,t)=>e.__shouldForwardProps__&&t?o=>e.__shouldForwardProps__(o)&&t(o):t,ym=(e,t)=>{if(e&&!t)return e;if(!e&&t)return t;if(e.__cva__&&t.__cva__||e.__recipe__&&t.__recipe__)return e.merge(t);const o=new TypeError("Cannot merge cva with recipe. Please use either cva or recipe.");throw TypeError.captureStackTrace?.(o),o},xm=e=>typeof e=="string"?e:e?.displayName||e?.name||"Component";function la(e,t={},o={}){const a=t.__cva__||t.__recipe__?t:wo(t),i=o.shouldForwardProp||mm,s=h=>o.forwardProps?.includes(h)?!0:i(h,a.variantKeys),l=Object.assign(o.dataAttr&&t.__name__?{"data-recipe":t.__name__}:{},o.defaultProps),r=ym(e.__cva__,a),d=fm(e,s),u=e.__base__||e,c=g.forwardRef(function(h,f){const{as:x=u,unstyled:w,children:C,...v}=h,k=g.useMemo(()=>Object.assign({},l,v),[v]),[_,m,b,j,S]=g.useMemo(()=>he(k,$a.keys,d,r.variantKeys,od),[k]);function D(){const{css:O,...$}=j,N=r.__getCompoundVariantCss__?.(b);return P(r(b,!1),y(N,$,O),k.className)}function M(){const{css:O,...$}=j,N=r.raw(b);return P(y(N,$,O),k.className)}const Y=()=>{if(w){const{css:O,...$}=j;return P(y($,O),k.className)}return t.__recipe__?D():M()};return g.createElement(x,{ref:f,...m,...S,...$a(_),className:Y()},C??k.children)}),p=xm(u);return c.displayName=`styled.${p}`,c.__cva__=r,c.__base__=u,c.__shouldForwardProps__=s,c}function bm(){const e=new Map;return new Proxy(la,{apply(t,o,a){return la(...a)},get(t,o){return e.has(o)||e.set(o,la(o)),e.get(o)}})}const ft=bm(),Ws={transform(e){return e}},wm=(e={})=>{const t=bo(Ws,e);return Ws.transform(t,xo)},K=g.forwardRef(function(e,t){const[o,a]=he(e,[]),i=wm(o),s={ref:t,...i,...a};return g.createElement(ft.div,s)}),Os={transform(e){const{justify:t,gap:o,...a}=e;return{display:"flex",alignItems:"center",justifyContent:t,gap:o,flexDirection:"column",...a}},defaultValues:{alignItems:"stretch",gap:"sm"}},zi=(e={})=>{const t=bo(Os,e);return Os.transform(t,xo)},ko=e=>y(zi(e));ko.raw=zi;const Et=g.forwardRef(function(e,t){const[o,a]=he(e,["justify","gap"]),i=zi(o),s={ref:t,...i,...a};return g.createElement(ft.div,s)}),Hs={transform(e){const{justify:t,gap:o,...a}=e;return{display:"flex",alignItems:"center",justifyContent:t,gap:o,flexDirection:"row",...a}},defaultValues:{gap:"sm"}},$i=(e={})=>{const t=bo(Hs,e);return Hs.transform(t,xo)},pe=e=>y($i(e));pe.raw=$i;const oe=g.forwardRef(function(e,t){const[o,a]=he(e,["justify","gap"]),i=$i(o),s={ref:t,...i,...a};return g.createElement(ft.div,s)}),Xs={transform(e){return{position:"relative",maxWidth:"8xl",mx:"auto",px:{base:"4",md:"6",lg:"8"},...e}}},nd=(e={})=>{const t=bo(Xs,e);return Xs.transform(t,xo)},ad=e=>y(nd(e));ad.raw=nd;const Ys={transform(e,{map:t,isCssUnit:o,isCssVar:a}){const{inline:i,block:s,...l}=e,r=d=>o(d)||a(d)?d:`token(spacing.${d}, ${d})`;return{"--bleed-x":t(i,r),"--bleed-y":t(s,r),marginInline:"calc(var(--bleed-x, 0) * -1)",marginBlock:"calc(var(--bleed-y, 0) * -1)",...l}},defaultValues:{inline:"0",block:"0"}},id=(e={})=>{const t=bo(Ys,e);return Ys.transform(t,xo)},sd=e=>y(id(e));sd.raw=id;function Fi({error:e,resetErrorBoundary:t}){const o=e instanceof Error?e.message:"Unknown error",a=g.useRef(null);return g.useEffect(()=>{a.current?.showModal()},[]),n.jsx("dialog",{ref:a,className:y({margin:"0",padding:"0",position:"fixed",top:"10",left:"10",width:"[calc(100vw - ({spacing.10} * 2))]",height:"max-content",maxHeight:"[calc(100vh - ({spacing.10} * 3))]",background:"likec4.overlay.body",rounded:"sm",borderWidth:3,borderColor:"likec4.overlay.border",shadow:"xl",outline:"none",_backdrop:{cursor:"zoom-out",backdropFilter:"blur(18px)",bg:"[color-mix(in oklab, {colors.likec4.overlay.backdrop} 60%, transparent)]"}}),onClick:i=>{if(i.stopPropagation(),i.target?.nodeName?.toUpperCase()==="DIALOG"){a.current?.close();return}},onClose:i=>{i.stopPropagation(),t()},children:n.jsxs(oe,{p:"xl",gap:"lg",alignItems:"flex-start",flexWrap:"nowrap",children:[n.jsx($e,{size:"md",radius:"xl",color:"red",children:n.jsx(Ut,{style:{width:20,height:20}})}),n.jsxs(Et,{flex:"1",children:[n.jsx(L,{fz:"md",children:"Oops, something went wrong"}),n.jsx(We,{maw:"100%",mah:400,type:"auto",children:n.jsx(L,{fz:"md",c:"red",style:{whiteSpace:"pre-wrap",userSelect:"all"},children:o})}),n.jsxs(oe,{gap:"md",mt:"md",children:[n.jsx(ke,{size:"sm",variant:"default",onClick:()=>t(),children:"Reset"}),n.jsx(L,{fz:"sm",c:"dimmed",children:"See console for more details and report the issue if it persists."})]})]})]})})}function rd(e){return n.jsx(ci,{FallbackComponent:Fi,onError:(t,o)=>{console.error(t,o)},...e})}const Vn=g.createContext(null);Vn.displayName="DiagramActorSafeContext";const vm=Vn.Provider;function Rt(){const e=g.useContext(Vn);if(e===null)throw new Error("DiagramActorRef is not provided");return e.actor}function H(){const e=g.useContext(Vn);if(e===null)throw new Error("DiagramActorRef is not provided");return e}function Vi(e,t=ee){const o=Rt();return ne(o,e,t)}function Ve(e,t=ee,o){const a=Rt(),i=g.useCallback(s=>e(s.context),o??[]);return ne(a,i,t)}function Me(e,t){const o=Rt(),a=g.useRef(t);a.current=t,g.useEffect(()=>{const i=o.on(e,s=>{a.current(s)});return()=>{i.unsubscribe()}},[o,e])}const km=e=>e.children.overlays;function ld(){return Vi(km,Object.is)}const jm=e=>e.children.search??null;function Cm(){return Vi(jm,Object.is)}const Sm=e=>e.context.view.id;function Wn(){const e=Rt();return ne(e,Sm)}const _m=e=>e.context.view;function Pm(){const e=Rt();return ne(e,_m,ee)}function Mm(){return g.useContext(Ai)}function Nm(){const e=g.useContext(Ai);if(!e)throw new Error("No LikeC4ViewModel in context found");return e}function Jt(){const e=Yh();return g.useMemo(()=>e?{portalProps:{target:e},withinPortal:!0}:{withinPortal:!1},[e])}const Im=ot({delays:{"open timeout":500,"close timeout":350},actions:{"update activatedBy":T({activatedBy:({context:e,event:t})=>{switch(!0){case t.type.includes("click"):return"click";case t.type.includes("mouseEnter"):return"hover";default:return e.activatedBy}}}),"keep dropdown open":T({activatedBy:"click"}),"update selected folder":T(({event:e})=>e.type==="breadcrumbs.click.root"?{selectedFolder:""}:(z(e,["breadcrumbs.click.folder","select.folder"]),{selectedFolder:e.folderPath})),"reset selected folder":T({selectedFolder:({context:e})=>e.viewModel?.folder.path??""}),"update inputs":T(({context:e,event:t})=>{z(t,"update.inputs");const o=t.inputs.viewModel?.id!==e.viewModel?.id;let a=e.selectedFolder;return t.inputs.viewModel?.folder.path.startsWith(a)||(a=t.inputs.viewModel?.folder.path??""),{view:t.inputs.view,viewModel:t.inputs.viewModel,selectedFolder:a,activatedBy:o?"hover":e.activatedBy}}),"reset search query":T({searchQuery:""}),"update search query":T(({event:e})=>(z(e,"searchQuery.change"),{searchQuery:e.value??""})),"emit navigateTo":ul(({event:e})=>(z(e,"select.view"),{type:"navigateTo",viewId:e.viewId}))},guards:{"was opened on hover":({context:e})=>e.activatedBy==="hover","has search query":({context:e})=>!Ct(e.searchQuery),"search query is empty":({context:e})=>Ct(e.searchQuery)}}).createMachine({id:"breadcrumbs",context:({input:e})=>({...e,breadcrumbs:[],activatedBy:"hover",selectedFolder:"",searchQuery:"",folderColumns:[]}),initial:"idle",entry:["update activatedBy","reset selected folder"],on:{"update.inputs":{actions:"update inputs"},"searchQuery.change":{actions:["update search query",be({type:"searchQuery.changed"})]}},states:{idle:{id:"idle",on:{"breadcrumbs.mouseEnter.*":{target:"pending",actions:"update activatedBy"},"breadcrumbs.click.*":{target:"active",actions:"update activatedBy"}}},pending:{on:{"breadcrumbs.mouseEnter.*":{actions:"update activatedBy"},"breadcrumbs.mouseLeave.*":{target:"idle"},"breadcrumbs.click.*":{target:"active",actions:"update activatedBy"}},after:{"open timeout":{target:"active"}}},active:{tags:["active"],initial:"decide",on:{"dropdown.dismiss":{target:"#idle"},"breadcrumbs.mouseLeave":{guard:"was opened on hover",target:".closing"},"dropdown.mouseLeave":{guard:"was opened on hover",target:".closing"},"searchQuery.changed":{target:".decide"}},states:{decide:{always:[{guard:"has search query",target:"search"},{target:"opened"}]},opened:{on:{"searchQuery.changed":{guard:"has search query",actions:"keep dropdown open",target:"search"},"breadcrumbs.click.viewtitle":{actions:"reset selected folder"},"breadcrumbs.click.*":{actions:"update selected folder"},"select.folder":{actions:["keep dropdown open","update selected folder"]},"select.view":{actions:["emit navigateTo"]}}},search:{on:{"breadcrumbs.click.viewtitle":{actions:["reset search query","reset selected folder"],target:"opened"},"breadcrumbs.click.*":{actions:["reset search query","update selected folder"],target:"opened"},"select.view":{actions:["emit navigateTo"]}}},closing:{on:{"breadcrumbs.mouseEnter.*":{target:"decide"},"dropdown.mouseEnter":{target:"decide"}},after:{"close timeout":{target:"#idle"}}}}}}}),Em=Im,Rm=({context:e})=>{const t=e.view.drifts??null;return!e.features.enableCompareWithLatest||!t?{isEnabled:!1,isEditable:!1,isActive:!1,drifts:[],layout:e.view._layout??"auto"}:{isEnabled:!0,isEditable:!e.features.enableReadOnly,isActive:e.toggledFeatures.enableCompareWithLatest===!0,drifts:t,layout:e.view._layout??"auto"}};function Wi(){const e=Rt(),t=ne(e,Rm,ee),o=A(s=>{if(!t.isEnabled){console.warn("Compare with latest feature is not enabled");return}e.send({type:"emit.onLayoutTypeChange",layoutType:s})}),a=A(s=>{if(!t.isEnabled){console.warn("Compare with latest feature is not enabled");return}const l=s?s==="on":!t.isActive;t.isActive&&!l&&t.layout==="auto"&&o("manual"),e.send({type:"toggle.feature",feature:"CompareWithLatest",forceValue:l})}),i=A(()=>{if(!t.isEnabled){console.warn("Compare with latest feature is not enabled");return}e.send({type:"layout.resetManualLayout"})});return[t,{toggleCompare:a,switchLayout:o,resetManualLayout:i}]}const Oe=(e,t,o)=>{const a=i=>({[e]:"__ignore__",...t,...Nt(i)});return{recipeFn:(i,s=!0)=>{const l=El({conditions:{shift:Ll,finalize:Bl,breakpoints:{keys:["base","xs","sm","md","lg","xl"]}},utility:{toHash:(d,u)=>u(d.join(":")),transform:(d,u)=>(Zp(e,o,i,d),u==="__ignore__"?{className:e}:(u=Ci(u),{className:`${e}--${d}_${u}`}))}}),r=a(i);if(s){const d=Fa(o,r);return P(l(r),y(d))}return l(r)},getVariantProps:a,__getCompoundVariantCss__:i=>Fa(o,a(i))}},st=(e,t)=>{if(e&&!t)return e;if(!e&&t)return t;const o=(...s)=>P(e(...s),t(...s)),a=za(e.variantKeys,t.variantKeys),i=a.reduce((s,l)=>(s[l]=za(e.variantMap[l],t.variantMap[l]),s),{});return Object.assign(o,{__recipe__:!0,__name__:`${e.__name__} ${t.__name__}`,raw:s=>s,variantKeys:a,variantMap:i,splitVariantProps(s){return he(s,a)}})},da=Oe("action-btn",{size:"md",radius:"md",variant:"filled"},[]),dd={variant:["transparent","filled"],size:["sm","md"],radius:["sm","md"]},qs=Object.keys(dd),On=Object.assign(ye(da.recipeFn),{__recipe__:!0,__name__:"actionBtn",__getCompoundVariantCss__:da.__getCompoundVariantCss__,raw:e=>e,variantKeys:qs,variantMap:dd,merge(e){return st(this,e)},splitVariantProps(e){return he(e,qs)},getVariantProps:da.getVariantProps}),ca=Oe("likec4-compound-node",{},[]),cd={isTransparent:["false","true"],inverseColor:["true","false"],borderStyle:["solid","dashed","dotted","none"]},Gs=Object.keys(cd),Dm=Object.assign(ye(ca.recipeFn),{__recipe__:!0,__name__:"compoundNode",__getCompoundVariantCss__:ca.__getCompoundVariantCss__,raw:e=>e,variantKeys:Gs,variantMap:cd,merge(e){return st(this,e)},splitVariantProps(e){return he(e,Gs)},getVariantProps:ca.getVariantProps}),ua=Oe("likec4-edge-action-btn",{},[]),ud={},Zs=Object.keys(ud),Bm=Object.assign(ye(ua.recipeFn),{__recipe__:!0,__name__:"edgeActionBtn",__getCompoundVariantCss__:ua.__getCompoundVariantCss__,raw:e=>e,variantKeys:Zs,variantMap:ud,merge(e){return st(this,e)},splitVariantProps(e){return he(e,Zs)},getVariantProps:ua.getVariantProps}),pa=Oe("likec4-element-node-data",{},[]),pd={},Ks=Object.keys(pd),Lm=Object.assign(ye(pa.recipeFn),{__recipe__:!0,__name__:"elementNodeData",__getCompoundVariantCss__:pa.__getCompoundVariantCss__,raw:e=>e,variantKeys:Ks,variantMap:pd,merge(e){return st(this,e)},splitVariantProps(e){return he(e,Ks)},getVariantProps:pa.getVariantProps}),ga=Oe("likec4-element-shape",{},[]),gd={shapetype:["html","svg"]},Us=Object.keys(gd),hd=Object.assign(ye(ga.recipeFn),{__recipe__:!0,__name__:"elementShapeRecipe",__getCompoundVariantCss__:ga.__getCompoundVariantCss__,raw:e=>e,variantKeys:Us,variantMap:gd,merge(e){return st(this,e)},splitVariantProps(e){return he(e,Us)},getVariantProps:ga.getVariantProps}),ha=Oe("likec4-tag",{autoTextColor:!1},[]),md={autoTextColor:["false","true"]},Qs=Object.keys(md),Tm=Object.assign(ye(ha.recipeFn),{__recipe__:!0,__name__:"likec4tag",__getCompoundVariantCss__:ha.__getCompoundVariantCss__,raw:e=>e,variantKeys:Qs,variantMap:md,merge(e){return st(this,e)},splitVariantProps(e){return he(e,Qs)},getVariantProps:ha.getVariantProps}),ma=Oe("likec4-markdown-block",{uselikec4palette:!1,value:"markdown"},[]),fd={uselikec4palette:["true","false"],value:["markdown","plaintext"]},Js=Object.keys(fd),Am=Object.assign(ye(ma.recipeFn),{__recipe__:!0,__name__:"markdownBlock",__getCompoundVariantCss__:ma.__getCompoundVariantCss__,raw:e=>e,variantKeys:Js,variantMap:fd,merge(e){return st(this,e)},splitVariantProps(e){return he(e,Js)},getVariantProps:ma.getVariantProps}),fa=Oe("likec4-navigation-panel-icon",{variant:"default",type:"default"},[{type:"warning",variant:"filled",css:{backgroundColor:{base:"likec4.panel.action.warning.bg",_hover:"likec4.panel.action.warning.bg.hover"}}}]),yd={variant:["default","filled"],type:["default","warning"]},er=Object.keys(yd),Oi=Object.assign(ye(fa.recipeFn),{__recipe__:!0,__name__:"navigationPanelActionIcon",__getCompoundVariantCss__:fa.__getCompoundVariantCss__,raw:e=>e,variantKeys:er,variantMap:yd,merge(e){return st(this,e)},splitVariantProps(e){return he(e,er)},getVariantProps:fa.getVariantProps}),ya=Oe("likec4-overlay",{fullscreen:!1,withBackdrop:!0},[]),xd={fullscreen:["false","true"],withBackdrop:["false","true"]},tr=Object.keys(xd),zm=Object.assign(ye(ya.recipeFn),{__recipe__:!0,__name__:"overlay",__getCompoundVariantCss__:ya.__getCompoundVariantCss__,raw:e=>e,variantKeys:tr,variantMap:xd,merge(e){return st(this,e)},splitVariantProps(e){return he(e,tr)},getVariantProps:ya.getVariantProps}),bd={pointerEvents:"all",isStepEdge:!1,cursor:"default"},$m=[],Fm=[["root","likec4-edge-label__root"],["stepNumber","likec4-edge-label__stepNumber"],["labelContents","likec4-edge-label__labelContents"],["labelText","likec4-edge-label__labelText"],["labelTechnology","likec4-edge-label__labelTechnology"]],Vm=Fm.map(([e,t])=>[e,Oe(t,bd,Pi($m,e))]),Wm=ye((e={})=>Object.fromEntries(Vm.map(([t,o])=>[t,o.recipeFn(e)]))),or=["pointerEvents","cursor","isStepEdge"],Om=e=>({...bd,...Nt(e)}),Hm=Object.assign(Wm,{__recipe__:!1,__name__:"edgeLabel",raw:e=>e,classNameMap:{},variantKeys:or,variantMap:{pointerEvents:["none","all"],cursor:["pointer","default"],isStepEdge:["false","true"]},splitVariantProps(e){return he(e,or)},getVariantProps:Om}),wd={truncateLabel:!1},Xm=[],Ym=[["root","likec4-navlink__root"],["body","likec4-navlink__body"],["section","likec4-navlink__section"],["label","likec4-navlink__label"],["description","likec4-navlink__description"]],qm=Ym.map(([e,t])=>[e,Oe(t,wd,Pi(Xm,e))]),Gm=ye((e={})=>Object.fromEntries(qm.map(([t,o])=>[t,o.recipeFn(e)]))),nr=["truncateLabel"],Zm=e=>({...wd,...Nt(e)}),Km=Object.assign(Gm,{__recipe__:!1,__name__:"navigationLink",raw:e=>e,classNameMap:{},variantKeys:nr,variantMap:{truncateLabel:["true","false"]},splitVariantProps(e){return he(e,nr)},getVariantProps:Zm}),vd=_e.withProps({color:"dark",fz:"xs",openDelay:600,closeDelay:120,label:"",children:null,offset:8,withinPortal:!1}),kd=()=>n.jsx($e,{component:Q,variant:"transparent",size:16,className:y({display:{base:"none","@/md":"flex"},color:{base:"mantine.colors.gray[5]",_dark:"mantine.colors.dark[3]"}}),children:n.jsx(mt,{})});Kr.withProps({separator:n.jsx(kd,{}),separatorMargin:4});const tt=g.forwardRef(({variant:e="default",className:t,disabled:o=!1,type:a,...i},s)=>n.jsx(U,{size:"md",variant:"transparent",radius:"sm",component:Be,...!o&&{whileHover:{scale:1.085},whileTap:{scale:1,translateY:1}},disabled:o,...i,className:P(t,Oi({variant:e,type:a})),ref:s}));function Um({onResetManualLayout:e}){return n.jsxs(Te,{withinPortal:!1,floatingStrategy:"absolute",shadow:"lg",position:"bottom-start",offset:{mainAxis:4},children:[n.jsx(Te.Target,{children:n.jsxs(se,{className:P("mantine-active",Oi({variant:"default"}),pe({gap:"2",py:"1.5",px:"2",lineHeight:"1",rounded:"sm",textStyle:"xs",fontWeight:"medium",color:{base:"likec4.panel.action",_hover:"likec4.panel.action.hover"},userSelect:"none"})),children:[n.jsx(K,{children:"Actions"}),n.jsx(Mi,{size:12,stroke:2,opacity:.7})]})}),n.jsxs(Te.Dropdown,{children:[n.jsx(Te.Item,{disabled:!0,rightSection:n.jsx(pt,{size:"xs",radius:"sm",children:"Soon"}),children:"Apply changes"}),n.jsx(Te.Item,{fz:"sm",onClick:e,children:"Reset manual layout"})]})]})}function Qm({value:e,onChange:t}){const o=g.useMemo(()=>[{value:"manual",label:"Saved"},{value:"auto",label:"Latest"}],[]);return n.jsx(Q,{layout:"position",children:n.jsx(Nn,{size:"xs",color:e==="manual"?"orange":"green",value:e,component:Q,onChange:a=>{q(a==="manual"||a==="auto","Invalid layout type"),t(a)},classNames:{label:y({fontSize:"xxs",fontWeight:"medium"})},data:o})})}const ar=yo.withProps({mx:2,size:"xs",orientation:"vertical"});function Jm(){const[e,{toggleCompare:t,switchLayout:o,resetManualLayout:a}]=Wi();return n.jsxs(n.Fragment,{children:[n.jsx(K,{css:{textStyle:"xs",color:"likec4.panel.text",userSelect:"none"},children:"Compare"}),n.jsx(Qm,{value:e.layout,onChange:o}),e.isEditable&&n.jsxs(oe,{gap:"1",children:[n.jsx(ar,{}),n.jsx(Um,{onResetManualLayout:a}),n.jsx(ar,{})]}),n.jsx(tt,{size:"sm",onClick:i=>{i.stopPropagation(),t()},children:n.jsx(Ut,{})})]})}const jd=g.memo(()=>{const{enableCompareWithLatest:e}=Z();return n.jsx(ue,{children:e&&n.jsx(Q,{layout:"position",className:pe({gap:"2",layerStyle:"likec4.panel",position:"relative",px:"2",py:"1",pl:"3",pointerEvents:"all"}),initial:{opacity:0,translateX:-20},animate:{opacity:1,translateX:0},exit:{opacity:0,translateX:-20},children:n.jsx(Jm,{})})})});jd.displayName="ComparePanel";const jo=_e.withProps({color:"dark",fz:"xs",openDelay:600,closeDelay:120,label:"",children:null,offset:8,position:"right"}),ef=()=>{const e=H();return n.jsx(jo,{label:"Center camera",children:n.jsx(tt,{onClick:()=>e.fitDiagram(),children:n.jsx(vg,{})})})};y({gap:"xxs",_empty:{display:"none"}});y({top:"md",left:"md",margin:"0",pointerEvents:"none","& :where(button, .action-icon, [role='dialog'])":{pointerEvents:"all"},"& .action-icon":{"--ai-size":"2rem"},"& .tabler-icon":{width:"65%",height:"65%"},_reduceGraphics:{"& .action-icon":{"--ai-radius":"0px"}}});y({shadow:{base:"md",_whenPanning:"none"}});y({"& .tabler-icon":{width:"65%",height:"65%"}});const Ao=y({flex:"1 1 40%",textAlign:"center",fontWeight:500,padding:"[4px 6px]",fontSize:"11px",zIndex:1}),tf=y({background:"mantine.colors.gray[2]",borderRadius:"sm",border:"1px solid",borderColor:"mantine.colors.gray[4]",_dark:{background:"mantine.colors.dark[5]",borderColor:"mantine.colors.dark[4]"}}),of=y({position:"relative",borderRadius:"sm",background:"mantine.colors.gray[3]",boxShadow:"inset 1px 1px 3px 0px #00000024",_dark:{background:"mantine.colors.dark[7]"}}),nf=y({position:"absolute",width:8,height:8,border:"2px solid",borderColor:"mantine.colors.gray[5]",borderRadius:3,transform:"translate(-50%, -50%)"}),af=e=>({viewId:e.view.id,isManualLayout:e.view._layout==="manual",autoLayout:e.view.autoLayout}),sf=()=>{const e=H(),[t,o]=g.useState(null),[a,i]=g.useState({}),{autoLayout:s,viewId:l,isManualLayout:r}=Ve(af),{ref:d,hovered:u}=Ma(),c=f=>x=>{a[f]=x,i(a)},p=f=>x=>{x.stopPropagation(),e.fitDiagram(),e.triggerChange({op:"change-autolayout",layout:{...s,direction:f}})},h=(f,x)=>{e.fitDiagram(),e.triggerChange({op:"change-autolayout",layout:{...s,nodeSep:f,rankSep:x}})};return r?null:n.jsxs(nt,{position:"right-start",clickOutsideEvents:["pointerdown"],radius:"xs",shadow:"lg",offset:{mainAxis:10},children:[n.jsx(Gt,{children:n.jsx(jo,{label:"Change Auto Layout",children:n.jsx(tt,{children:n.jsx(Og,{})})})}),n.jsx(Zt,{className:"likec4-top-left-panel",p:8,pt:6,opacity:u?.6:1,children:n.jsxs(X,{pos:"relative",ref:o,children:[n.jsx(ku,{target:a[s.direction],parent:t,className:tf}),n.jsx(X,{mb:10,children:n.jsx(L,{inline:!0,fz:"xs",c:"dimmed",fw:500,children:"Auto layout:"})}),n.jsxs(_t,{gap:2,wrap:"wrap",justify:"stretch",maw:160,children:[n.jsx(se,{className:Ao,ref:c("TB"),onClick:p("TB"),children:"Top-Bottom"}),n.jsx(se,{className:Ao,ref:c("BT"),onClick:p("BT"),children:"Bottom-Top"}),n.jsx(se,{className:Ao,ref:c("LR"),onClick:p("LR"),children:"Left-Right"}),n.jsx(se,{className:Ao,ref:c("RL"),onClick:p("RL"),children:"Right-Left"})]}),n.jsx(X,{my:10,children:n.jsx(L,{inline:!0,fz:"xs",c:"dimmed",fw:500,children:"Spacing:"})}),n.jsx(rf,{ref:d,isVertical:s.direction==="TB"||s.direction==="BT",nodeSep:s.nodeSep,rankSep:s.rankSep,onChange:h},l)]})})]})},Tt=400,rf=g.forwardRef(({isVertical:e,nodeSep:t,rankSep:o,onChange:a},i)=>{e||([t,o]=[o,t]);const s=oi(({x:h,y:f})=>{e||([h,f]=[f,h]),a(Math.round(h*Tt),Math.round(f*Tt))},[a,e],250,2e3),[l,r]=Ur({defaultValue:Tc({x:(t??100)/Tt,y:(o??120)/Tt}),onChange:s}),{ref:d}=Ac(r);let u=Math.round(l.x*Tt),c=Math.round(l.y*Tt);e||([u,c]=[c,u]);const p=ni(d,i);return n.jsxs(X,{ref:p,className:of,pt:"100%",children:[n.jsx(X,{className:nf,style:{left:`${l.x*100}%`,top:`${l.y*100}%`}}),n.jsx(X,{pos:"absolute",left:2,bottom:2,children:n.jsxs(L,{component:"div",fz:8,c:"dimmed",fw:500,children:[c,", ",u]})})]})}),Ke=({label:e,icon:t,onClick:o})=>n.jsx(jo,{label:e,withinPortal:!1,position:"top",children:n.jsx(tt,{classNames:{root:"action-icon",icon:y({"& > svg":{width:"70%",height:"70%"}})},onClick:o,children:t})}),Cd=g.memo(()=>{const e=H(),t=Jt();return n.jsxs(nt,{position:"right",offset:{mainAxis:12},clickOutsideEvents:["pointerdown"],...t,children:[n.jsx(Gt,{children:n.jsx(jo,{label:"Manual layouting tools",children:n.jsx(tt,{children:n.jsx(Vg,{})})})}),n.jsx(Zt,{className:pe({gap:"0.5",layerStyle:"likec4.panel",padding:"1",pointerEvents:"all"}),children:n.jsxs(Mn,{children:[n.jsx(Ke,{label:"Align in columns",icon:n.jsx(Es,{}),onClick:o=>{o.stopPropagation(),e.align("Column")}}),n.jsx(Ke,{label:"Align left",icon:n.jsx(Rg,{}),onClick:o=>{o.stopPropagation(),e.align("Left")}}),n.jsx(Ke,{label:"Align center",icon:n.jsx(Ig,{}),onClick:o=>{o.stopPropagation(),e.align("Center")}}),n.jsx(Ke,{label:"Align right",icon:n.jsx(Tg,{}),onClick:o=>{o.stopPropagation(),e.align("Right")}}),n.jsx(Ke,{label:"Align in rows",icon:n.jsx(Es,{style:{transform:"rotate(90deg)"}}),onClick:o=>{o.stopPropagation(),e.align("Row")}}),n.jsx(Ke,{label:"Align top",icon:n.jsx(zg,{}),onClick:o=>{o.stopPropagation(),e.align("Top")}}),n.jsx(Ke,{label:"Align middle",icon:n.jsx(Bg,{}),onClick:o=>{o.stopPropagation(),e.align("Middle")}}),n.jsx(Ke,{label:"Align bottom",icon:n.jsx(Mg,{}),onClick:o=>{o.stopPropagation(),e.align("Bottom")}}),n.jsx(Ke,{label:"Reset all control points",icon:n.jsx(th,{}),onClick:o=>{o.stopPropagation(),e.resetEdgeControlPoints()}})]})})]})});Cd.displayName="ManualLayoutToolsButton";const lf=()=>{const e=H();return n.jsx(jo,{label:"Switch to Read-only",children:n.jsx(tt,{onClick:()=>e.toggleFeature("ReadOnly"),children:n.jsx(Ol,{size:14,stroke:2})})})};function df(){const{enableReadOnly:e}=Z();return n.jsx(ue,{children:!e&&n.jsx(Q,{layout:"position",className:ko({gap:"xs",layerStyle:"likec4.panel",position:"relative",cursor:"pointer",padding:"xxs",pointerEvents:"all"}),initial:{opacity:0,translateX:-20},animate:{opacity:1,translateX:0},exit:{opacity:0,translateX:-20},children:n.jsxs(Mn,{openDelay:600,closeDelay:120,children:[n.jsx(sf,{}),n.jsx(Cd,{}),n.jsx(ef,{}),n.jsx(lf,{})]})})})}const Hi=g.createContext(null);Hi.displayName="NavigationPanelActorSafeContext";const cf=Hi.Provider,Xi=()=>{const e=g.useContext(Hi);if(e===null)throw new Error("NavigationPanelActorRef is not found in the context");return e};function Yi(e,t=ee){const o=Xi();return ne(o,e,t)}function uf(e,t=ee){return Yi(o=>e(o.context),t)}function Co(){const e=Xi();return g.useMemo(()=>({actorRef:e,send:t=>e.send(t),selectFolder:t=>e.send({type:"select.folder",folderPath:t}),selectView:t=>e.send({type:"select.view",viewId:t}),isOpened:()=>e.getSnapshot().hasTag("active"),clearSearch:()=>e.send({type:"searchQuery.change",value:""}),closeDropdown:()=>e.send({type:"dropdown.dismiss"})}),[e])}const pf=g.forwardRef((e,t)=>n.jsxs("svg",{ref:t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 222 56",...e,children:[n.jsx("path",{fill:"#5E98AF",d:"M33.95 33.78V0H2.37A2.37 2.37 0 0 0 0 2.35V33.9h33.95v-.12ZM38.57 33.78H55.6v-14.6c0-1.3-1.06-2.35-2.36-2.35H38.57v16.95ZM33.95 38.37H17.04v14.6c0 1.29 1.06 2.35 2.36 2.35h14.67V38.37h-.12ZM38.57 38.37v16.95h14.67c1.3 0 2.36-1.06 2.36-2.36v-14.6H38.57Z"}),n.jsx("path",{className:y({fill:"[#FCFBF7]",_light:{fill:"[#222221]"}}),d:"M71.61 12.08c-.06 3.61.3 29.95.23 31.87 0 1.8 0 3.6.06 5.41 0 .3.18.58.47.58 4.1.18 8.13-.17 12.22-.11 1.34.05 2.69 0 3.97 0 1.29-.06 1.4-.59 1.35-1.63-.06-1.63-.06-3.08-.06-4.65-.06-.82-.53-1.11-1.23-1.11-2.4.06-4.8-.06-7.19.06-.4.06-.82.06-1.23.06-.7-.06-.87-.24-.93-1v-.86c-.18-4.83.17-9.83.17-14.66-.06-4.07 0-7.73-.06-11.34 0-1.57 0-3.14-.05-4.65-.06-.93 0-1.92-.24-2.85-.11-.35-.29-.81-.7-.81h-5.5c-.93 0-1.22.64-1.28 1.57v4.12ZM103.81 35c-.17-6.63-.1-13.67-.05-20.24 0-2.04-.12-4.25-.12-6.28 0-2.21-.87-2.1-2.04-2.15-1.7-.06-2.46-.06-4.15-.06-1.11-.06-1.58.23-1.58 1.34 0 5.7-.18 21.8-.12 24.13.06 2.33.3 12.91.18 15.24-.06.81 0 1.62.06 2.44.05.29.23.58.7.58 1.93-.12 3.74-.12 5.67-.17.7-.06 1.28-.24 1.58-1 .05-.4-.12-11.04-.12-13.83Zm13.92 4.47c0-2.03-.3-7.56-.23-8.72 0-.17.11-.4.17-.4.12 0 .35.11.41.17 1.87 2.44 10.64 19.36 11.7 19.42.28.06.58.06.87.06 1.99-.12 3.74 0 5.73 0 2.04 0 .7-1.98.35-2.5-.53-.76-7.48-13.14-7.9-13.9-1.16-1.98-2.16-4.13-3.32-6.05-.12-.23-.24-.58-.18-.81.12-.7.3-1.34.59-1.98a93.18 93.18 0 0 1 4.55-8.14c1.88-2.97 2.93-4.83 4.45-7.5.35-.64.58-1.34.82-2.1.05-.29-.18-.58-.53-.58-1.11-.05-5.15 0-6.43 0-.59 0-1.17.12-1.46.64-.76 1.46-8.6 15.7-9.35 16.98-.06.12-.24.18-.41.18 0 0-.12-.18-.12-.3-.06-3.25.53-13.9.4-16.04-.05-1.28-.28-1.4-1.57-1.46-1.4-.05-3.33-.05-4.73-.05-1.3 0-1.4.7-1.58 1.62-.06.18-.06 5.64-.06 8.09 0 3.54-.3 25.76.11 32.8 0 .7.18 1.1.77 1.1 1.57-.12 3.91 0 5.49 0 1.11 0 1.29-.12 1.29-1.98 0-2.5.23-4.77.23-7.85 0-.23-.06-.46-.06-.7Zm25.66-1.4h-.06c0 1.46-.05 2.97 0 4.49.06 1.86.18 3.72.3 5.58 0 .64.17.81.76.93 1.22.29 2.4.35 3.62.35 3.16-.12 6.31.11 9.47 0 1.29-.06 1.87.06 3.16-.18 1.17-.23 1.58-.87 1.58-2.61-.12-1.1-.06-1.57-.06-2.91 0-1.92-1.35-2.56-2.52-2.5-.81.06-4.73-.06-6.31-.06-2.63.06-2.22.4-2.22-2.33 0-2.2.06-5.05.06-7.32 0-1.22.11-1.63 1.28-1.63h7.31c1.17.17 1.99-.64 1.99-1.86 0-1.22.12-1.28.12-2.5l-.18-1.75c-.12-.99-.47-1.33-1.46-1.33-.64 0-1.29.05-1.93.11-2.52.18-3.68-.17-6.14 0-.82 0-.93-.11-1-.87-.23-2.27 0-4.77.24-7.04.06-.93.3-1.1 1.17-1.16l8.24-.06c1.11-.11 1.46-.06 1.4-1.16-.11-1.69.06-3.43-.11-5.12-.12-.93-.41-1.1-1.46-1.1-1.76.05-2.17.05-3.92.17-1.75.06-8.77.06-10.46.06-2.46 0-2.63-.18-2.7 2.8-.1 2.32-.05 4.7-.05 7.09 0 4.07-.23 18.66-.12 21.92Zm47.76-24.82c.06-1.92 0-3.5 0-5.35 0-2.15-3.92-1.92-5.32-1.86a18.95 18.95 0 0 0-15.08 9.77c-.82 1.57-1.4 3.2-1.81 4.88a34 34 0 0 0-.59 12.15c.41 3.78 1.4 7.56 3.74 10.59 4.04 5.3 11.46 7.15 17.83 6.16.3-.06.59-.11.82-.29.18-.11.35-.35.35-.58l.18-3.31c.06-1.05 0-1 0-2.04 0-1.4-2.93-.35-4.74-.35-1.75 0-3.62-.06-5.2-.87-2.8-1.57-4.38-4.71-5.26-7.68-1-3.2-1.23-6.63-.64-9.88.7-4.25 2.74-9.13 7.25-10.59 2.57-.87 5.31-.58 7.89-.29.35.06.58-.17.58-.46Zm26.77 15.3c.06-2.5 0-14.84 0-18.38.06-.82 0-1.63-.11-2.45-.06-.99-.24-1.28-1.29-1.33h-4.44c-.82 0-1.35.4-1.82 1.27-1.34 3.2-10.75 24.02-12.15 26.58-.53.99-1 1.63-1 2.68v4.24c0 .76-.06 1.28 1.23 1.28l11.1-.06c1.47 0 1.47.3 1.47 1.1 0 .88-.12 4.9-.12 5.3 0 .58.12 1.16 1.23 1.16h5.08c1.23 0 1.23-.7 1.23-2.03.06-1.17-.06-3.5-.06-4.66 0-.93.18-.98 1.76-.98 1.22 0 1.75-.12 1.75-.88.06-1.57 0-2.67 0-4.42 0-1.04-.93-.98-2.92-.98-.65 0-.7-.18-.7-1.05-.12-1.8-.24-4.6-.24-6.4Zm-7.25-5.94c-.05.7-.11 10.82-.11 12.27-.06.81-.24 1.05-1 1.1-1.93.06-3.85.06-5.78.06-.47 0-.65-.4-.41-.87.23-.4 4.85-11.57 6.13-14.48.18-.17.24-.35.41-.52.18-.12.41-.18.59-.23.06 0 .23.29.23.46 0 .76-.06 1.51-.06 2.21Z"})]})),gf=g.forwardRef((e,t)=>n.jsx("svg",{ref:t,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 56 56",...e,children:n.jsx("path",{fill:"#5E98AF",d:"M33.95 33.78V0H2.37A2.37 2.37 0 0 0 0 2.35V33.9h33.95v-.12ZM38.57 33.78H55.6v-14.6c0-1.3-1.06-2.35-2.36-2.35H38.57v16.95ZM33.95 38.37H17.04v14.6c0 1.29 1.06 2.35 2.36 2.35h14.67V38.37h-.12ZM38.57 38.37v16.95h14.67c1.3 0 2.36-1.06 2.36-2.36v-14.6H38.57Z"})})),hf=()=>{const e=Co(),{onBurgerMenuClick:t}=Qt();return n.jsx(Q,{layout:"position",children:n.jsxs(se,{onMouseEnter:()=>{e.send({type:"breadcrumbs.mouseEnter.root"})},onMouseLeave:()=>{e.send({type:"breadcrumbs.mouseLeave.root"})},onClick:o=>{o.stopPropagation(),t&&e.isOpened()&&setTimeout(()=>{t()},100),e.send({type:"breadcrumbs.click.root"})},className:P("mantine-active",pe({padding:"0.5",width:{base:"[20px]","@/md":"[64px]"}})),children:[n.jsx(pf,{className:y({display:{base:"none","@/md":"block"}})}),n.jsx(gf,{className:y({display:{base:"block","@/md":"none"}})})]})})},Sd=wo({base:{transitionDuration:"normal"},variants:{delay:{true:{transitionDelay:{base:"0.2s",_hover:"0s"}}}}});function mf({data:{hovered:e=!1},icon:t,onClick:o}){const a=mi(e,e?130:0)[0]&&e;return n.jsx(Q,{initial:!1,animate:{scale:a?1.2:1,x:a?-1:0,y:a?-1:0},whileHover:{scale:1.4,x:-3,y:-1},className:"likec4-compound-navigation compound-action",whileTap:{scale:1},onClick:ie,children:n.jsx(U,{className:P("nodrag nopan",Sd({delay:e&&!a}),On({variant:"transparent"})),onClick:o,onDoubleClick:ie,children:t??n.jsx(Le,{stroke:2})})})}function _d({data:{hovered:e=!1},icon:t,onClick:o}){const a=mi(e,e?130:0)[0]&&e;return n.jsx(Q,{initial:!1,animate:{scale:a?1.2:1},whileHover:{scale:1.4},whileTap:{scale:1},className:"likec4-compound-details details-button",children:n.jsx(U,{className:P("nodrag nopan",Sd({delay:e&&!a}),On({variant:"transparent"})),onClick:o,onDoubleClick:ie,children:t??n.jsx(Ni,{stroke:1.8,style:{width:"75%"}})})})}function So({nodeProps:{data:{hovered:e=!1,dimmed:t=!1,...o}},className:a,children:i,style:s,...l}){let r=ze(o.style.opacity??100,{min:0,max:100});const d=r<99,u=65,c=u+ze((100-u)*(r/100),{min:0,max:100-u}),p=Dm({isTransparent:d,inverseColor:r<60,borderStyle:o.style.border??(d?"dashed":"none")}),h=ze(o.depth??1,{min:1,max:5});return n.jsx(Q,{className:P(p,a),initial:!1,"data-likec4-hovered":e,"data-likec4-color":o.color,"data-compound-depth":h,...t!==!1&&{"data-likec4-dimmed":t},style:{...s,"--_border-transparency":`${c}%`,"--_compound-transparency":`${r}%`},...l,children:i})}function _o({data:e}){const t=zn({element:e,className:"likec4-compound-icon"});return n.jsxs("div",{className:"likec4-compound-title-container",children:[t,n.jsx(L,{component:"h3",className:"likec4-compound-title",truncate:"end",children:e.title})]})}function Hn({icon:e,onClick:t}){return n.jsx(U,{className:P("nodrag nopan",Bm()),onPointerDownCapture:ie,onClick:t,role:"button",onDoubleClick:ie,children:e??n.jsx(Le,{})})}const ff=".react-flow__edge.selected",yf=y({_reduceGraphics:{transition:"none"}}),xf=y({pointerEvents:"none",fill:"none",strokeWidth:"calc(var(--xy-edge-stroke-width) + 2)",strokeOpacity:.08,_noReduceGraphics:{transitionProperty:"stroke-width, stroke-opacity",transitionDuration:"fast",transitionTimingFunction:"inOut"},_whenHovered:{transitionTimingFunction:"out",strokeWidth:"calc(var(--xy-edge-stroke-width) + 4)",strokeOpacity:.2},_whenSelected:{strokeWidth:"calc(var(--xy-edge-stroke-width) + 6)",strokeOpacity:.25,_whenHovered:{strokeOpacity:.4}}}),bf=y({fill:"[var(--xy-edge-stroke)]",stroke:"[var(--xy-edge-stroke)]"}),wf=y({fill:"none",strokeDashoffset:0,_noReduceGraphics:{animationStyle:"xyedgeAnimated",animationPlayState:"paused",transition:"stroke 130ms ease-out,stroke-width 130ms ease-out"},":where([data-edge-dir='back']) &":{animationDirection:"reverse"},_whenHovered:{_noReduceGraphics:{animationPlayState:"running",animationDelay:"450ms"}},[`:where(${ff}, [data-edge-active='true'], [data-edge-animated='true']) &`]:{_noReduceGraphics:{animationPlayState:"running",animationDelay:"0ms"}},_whenDimmed:{animationPlayState:"paused"},_smallZoom:{animationName:"none"},_whenPanning:{strokeDasharray:"none !important",animationPlayState:"paused"}});function Po({className:e,component:t="g",selected:o=!1,data:{color:a="gray",hovered:i=!1,active:s=!1,dimmed:l=!1,...r},children:d,style:u}){const c={className:P(e,yf,"likec4-edge-container"),"data-likec4-color":a,"data-edge-dir":r.dir??"forward","data-edge-active":s,"data-edge-animated":s,"data-likec4-hovered":i,...o&&{"data-likec4-selected":o},...l!==!1&&{"data-likec4-dimmed":l}};return t==="svg"?n.jsx("svg",{style:u,...c,children:d}):(q(t==="g",'EdgeContainer: component must be "g" or "svg"'),n.jsx("g",{style:u,...c,children:d}))}const Mo=g.forwardRef(({edgeProps:{id:e,data:{label:t,technology:o,hovered:a=!1},selected:i=!1,selectable:s=!1},pointerEvents:l="all",className:r,style:d,children:u,...c},p)=>{const h=jl(e)?np(e):null,f=Hm({pointerEvents:l,isStepEdge:h!==null,cursor:s||h!==null?"pointer":"default"}),x=Se(t)||Se(o);return n.jsxs(Q,{ref:p,className:P(f.root,"likec4-edge-label",r),"data-edge-id":e,animate:{scale:a&&!i?1.06:1},...c,children:[h!==null&&n.jsx(K,{className:f.stepNumber,children:h}),x&&n.jsxs(K,{className:f.labelContents,children:[Se(t)&&n.jsx(K,{className:P(f.labelText,y({lineClamp:5})),children:t}),Se(o)&&n.jsx(K,{className:f.labelTechnology,children:"[ "+o+" ]"}),u]})]})});Mo.displayName="EdgeLabel";const ir=e=>{if(e!==void 0)return ct(e)?`${Math.round(e)}px`:e};function Xn({edgeProps:{id:e,selected:t=!1,data:{hovered:o=!1,active:a=!1,dimmed:i=!1,labelBBox:s,color:l="gray"}},labelPosition:r,className:d,style:u,children:c,...p}){let h=$n(g.useCallback(C=>C.edgeLookup.get(e)?.zIndex??qe.Edge,[e]));(o||a)&&(h+=100);let f=r?.x??s?.x,x=r?.y??s?.y;if(f===void 0||x===void 0)return null;const w=r?.translate;return n.jsx(yl,{children:n.jsx("div",{...p,className:P("nodrag nopan","likec4-edge-label-container",d),"data-likec4-hovered":o,"data-likec4-color":l,"data-edge-active":a,"data-edge-animated":a,...t!==!1&&{"data-likec4-selected":t},...i!==!1&&{"data-likec4-dimmed":i},style:{...s&&{maxWidth:s.width+18},zIndex:h,...u,transform:`translate(${ir(f)}, ${ir(x)}) ${w||""}`},children:c},e)})}const vf=e=>n.jsx("marker",{viewBox:"-4 -4 14 16",refX:5,refY:4,markerWidth:"7",markerHeight:"8",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:n.jsx("path",{d:"M0,0 L7,4 L0,8 L4,4 Z",stroke:"context-stroke",fill:"context-stroke",strokeDasharray:0,strokeWidth:1,strokeLinecap:"round"})}),kf=e=>n.jsx("marker",{viewBox:"-1 -1 12 10",refX:4,refY:3,markerWidth:"8",markerHeight:"6",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:n.jsx("path",{d:"M 0 0 L 8 3 L 0 6 L 1 3 z",fill:"context-stroke",strokeWidth:0})}),jf=e=>n.jsx("marker",{viewBox:"-1 -1 12 12",refX:8,refY:4,markerWidth:"8",markerHeight:"8",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:n.jsx("path",{d:"M 8 0 L 0 4 L 8 8 M 8 4 L 0 4",fill:"none",strokeWidth:1})}),Cf=e=>n.jsx("marker",{viewBox:"-1 -1 12 10",refX:4,refY:3,markerWidth:"8",markerHeight:"6",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:n.jsx("path",{d:"M 0 0 L 8 3 L 0 6 L 1 3 z",stroke:"context-stroke",fill:"context-stroke",strokeWidth:1.25,strokeLinejoin:"miter",strokeLinecap:"square"})}),Sf=e=>n.jsx("marker",{viewBox:"-4 -4 16 14",refX:5,refY:4,markerWidth:"10",markerHeight:"8",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:n.jsx("path",{d:"M5,0 L10,4 L5,8 L0,4 Z",fill:"context-stroke",strokeWidth:0,strokeLinecap:"round"})}),_f=e=>n.jsx("marker",{viewBox:"-4 -4 16 14",refX:6,refY:4,markerWidth:"10",markerHeight:"8",preserveAspectRatio:"xMaxYMid meet",orient:"auto-start-reverse",...e,children:n.jsx("path",{d:"M5,0 L10,4 L5,8 L0,4 Z",stroke:"context-stroke",fill:"context-stroke",strokeWidth:1.25,strokeLinecap:"round"})}),Pf=e=>n.jsx("marker",{viewBox:"0 0 10 10",refX:4,refY:4,markerWidth:"6",markerHeight:"6",...e,children:n.jsx("circle",{strokeWidth:0,fill:"context-stroke",cx:4,cy:4,r:3})}),Mf=e=>n.jsx("marker",{viewBox:"0 0 10 10",refX:4,refY:4,markerWidth:"6",markerHeight:"6",...e,children:n.jsx("circle",{strokeWidth:1.25,stroke:"context-stroke",fill:"context-stroke",cx:4,cy:4,r:3})}),sr={Arrow:kf,Crow:jf,OArrow:Cf,Open:vf,Diamond:Sf,ODiamond:_f,Dot:Pf,ODot:Mf};function rr(e){if(!(!e||e==="none"))switch(e){case"normal":return"Arrow";case"crow":return"Crow";case"onormal":return"OArrow";case"diamond":return"Diamond";case"odiamond":return"ODiamond";case"open":case"vee":return"Open";case"dot":return"Dot";case"odot":return"ODot";default:it(e)}}const No=g.forwardRef(({edgeProps:{id:e,data:{line:t,dir:o,tail:a,head:i},selectable:s=!0,style:l,interactionWidth:r},isDragging:d=!1,onEdgePointerDown:u,strokeWidth:c,svgPath:p},h)=>{let f=rr(a),x=rr(i??"normal");o==="back"&&([f,x]=[x,f]);const w=f?sr[f]:null,C=x?sr[x]:null,v=t==="dotted",k=v||t==="dashed";let _;return v?_="1,8":k&&(_="8,10"),n.jsxs(n.Fragment,{children:[s&&!d&&n.jsx("path",{className:P("react-flow__edge-interaction",y({fill:"none"})),onPointerDown:u,d:p,style:{strokeWidth:r??10,stroke:"currentcolor",strokeOpacity:0}}),n.jsxs("g",{className:bf,onPointerDown:u,children:[n.jsxs("defs",{children:[w&&n.jsx(w,{id:"start"+e}),C&&n.jsx(C,{id:"end"+e})]}),!d&&n.jsx("path",{className:P("react-flow__edge-path","hide-on-reduced-graphics",xf),d:p,style:l,strokeLinecap:"round"},"edge-path-bg"),n.jsx("path",{ref:h,className:P("react-flow__edge-path",s&&"react-flow__edge-interaction",wf),d:p,style:l,strokeWidth:c,strokeLinecap:"round",strokeDasharray:_,markerStart:w?`url(#start${e})`:void 0,markerEnd:C?`url(#end${e})`:void 0},"edge-path")]})]})});No.displayName="EdgePath";const Nf=pe({position:"absolute",zIndex:1,justifyContent:"center",alignItems:"center",_smallZoom:{display:"none"}}),If=pe({gap:"1.5",justifyContent:"center",alignItems:"center"});function Yn({selected:e=!1,data:{hovered:t=!1},buttons:o}){const a=pl();return o.length?n.jsx(K,{className:Nf,style:{top:"calc(100% - 30px)",transform:"translateX(-50%)",left:"50%",width:"auto",minHeight:30},children:n.jsx(Q,{layoutRoot:!0,initial:!1,style:{originY:0},animate:{opacity:t||e?1:.75,scale:t?1.1:e?.9:.8,y:t||e?6:0},"data-likec4-hovered":t,className:P("nodrag nopan",If),children:o.map((i,s)=>n.jsx(U,{component:Be,className:On({}),initial:!1,whileTap:{scale:1},whileHover:{scale:1.3},onClick:i.onClick,onDoubleClick:ie,children:i.icon||n.jsx(ig,{})},`${a}-${i.key??s}`))},`${a}-action-buttons`)}):null}const Mt=g.forwardRef(({value:e,textScale:t=1,uselikec4palette:o=!1,hideIfEmpty:a=!1,emptyText:i="no content",className:s,style:l,fontSize:r,...d},u)=>{if(e.isEmpty&&a)return null;const c=e.nonEmpty?e.isMarkdown?{dangerouslySetInnerHTML:{__html:e.html}}:{children:n.jsx("p",{children:e.text})}:{children:n.jsx(L,{component:"span",fz:"xs",c:"dimmed",style:{userSelect:"none"},children:i})};return n.jsx(K,{ref:u,...d,className:P(Am({uselikec4palette:o,value:e.isMarkdown?"markdown":"plaintext"}),s),style:{...l,...r&&{"--text-fz":`var(--font-sizes-${r}, var(--font-sizes-md))`},"--mantine-scale":t},...c})});Mt.displayName="Markdown";const Pd=g.forwardRef(({className:e,...t},o)=>n.jsx("div",{...t,ref:o,className:P(e,Lm(),"likec4-element")})),Md=({data:e,...t})=>n.jsx(zn,{element:e,...t}),Nd=g.forwardRef(({className:e,...t},o)=>n.jsx("div",{...t,className:P(e,"likec4-element-node-content"),ref:o})),Id=g.forwardRef(({data:{title:e,style:t},className:o,...a},i)=>{const{size:s}=wi(t),l=s==="sm"||s==="xs";return n.jsx(L,{component:"div",...a,className:P(o,"likec4-element-title"),"data-likec4-node-title":"",lineClamp:l?2:3,ref:i,children:e})}),Ed=g.forwardRef(({data:e,children:t,className:o,...a},i)=>{const s=e?.technology??t;return Se(s)?n.jsx(L,{component:"div",...a,className:P(o,"likec4-element-technology"),"data-likec4-node-technology":"",ref:i,children:s}):null}),Rd=g.forwardRef(({data:{description:e,style:t},className:o,...a},i)=>{if(!e?.nonEmpty)return null;const{size:s}=wi(t),l=s==="sm"||s==="xs";return n.jsx(Mt,{...a,className:P(o,"likec4-element-description"),"data-likec4-node-description":"",value:e,uselikec4palette:!0,hideIfEmpty:!0,maxHeight:e.isMarkdown?"8rem   ":void 0,lineClamp:l?3:5,ref:i})});function He({iconSize:e,data:t}){return n.jsxs(Pd,{style:ct(e)?{"--likec4-icon-size":`${e}px`}:void 0,children:[n.jsx(Md,{data:t}),n.jsxs(Nd,{children:[n.jsx(Id,{data:t}),n.jsx(Ed,{data:t}),n.jsx(Rd,{data:t})]})]})}He.Root=Pd;He.Icon=Md;He.Content=Nd;He.Title=Id;He.Technology=Ed;He.Description=Rd;const Ef=y({position:"absolute",top:"0.5",right:"0.5",_shapeBrowser:{right:"[5px]"},_shapeCylinder:{top:"[14px]"},_shapeStorage:{top:"[14px]"},_shapeQueue:{top:"[1px]",right:"3"},_smallZoom:{display:"none"}});function qi({selected:e=!1,data:{hovered:t=!1},icon:o,onClick:a}){return n.jsx(K,{className:P(Ef,"details-button"),children:n.jsx(U,{className:P("nodrag nopan",On({variant:"transparent"})),component:Be,initial:!1,style:{originX:.45,originY:.55},animate:t||e?{scale:1.2,opacity:.8}:{scale:1,opacity:.5},whileHover:{scale:1.4,opacity:1},whileTap:{scale:1.15},onClick:a,onDoubleClick:ie,children:o??n.jsx(Ni,{stroke:1.8,style:{width:"75%"}})})})}const Rf=y({position:"relative",width:"full",height:"full",padding:"0",margin:"0",display:"flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",_focusVisible:{outline:"none"},_whenSelectable:{pointerEvents:"all",_before:{content:'" "',position:"absolute",top:"[calc(100% - 4px)]",left:"0",width:"full",height:"24px",background:"transparent",pointerEvents:"all"}},_reduceGraphicsOnPan:{_before:{display:"none"}},":where(.react-flow__node.selectable:not(.dragging)) &":{cursor:"pointer"}}),eo=g.forwardRef(({nodeProps:{selected:e=!1,selectable:t=!1,data:{hovered:o=!1,dimmed:a=!1,...i}},className:s,style:l,children:r,...d},u)=>{let c=1;switch(!0){case o:c=1.05;break;case e:c=1.02;break}const{size:p,padding:h,textSize:f}=wi(i.style??{});return n.jsx(Q,{ref:u,className:P(Rf,"group","likec4-element-node",s),initial:!1,...t&&{animate:{scale:c},whileTap:{scale:.98}},"data-likec4-hovered":o,"data-likec4-color":i.color,"data-likec4-shape":i.shape,"data-likec4-shape-size":p,"data-likec4-spacing":h,"data-likec4-text-size":f,...a!==!1&&{"data-likec4-dimmed":a},style:{...l},...d,children:r})});eo.displayName="ElementNodeContainer";function Df(e,t){if(e._type==="dynamic")try{if(t??=e.variant,t==="sequence")return e.sequenceLayout.bounds}catch{}return e.bounds}function Bf({points:e,controlPoints:t,labelBBox:o}){let a=1/0,i=1/0,s=-1/0,l=-1/0;for(const r of e)a=Math.min(a,r[0]),i=Math.min(i,r[1]),s=Math.max(s,r[0]),l=Math.max(l,r[1]);if(t)for(const r of t)a=Math.min(a,r.x),i=Math.min(i,r.y),s=Math.max(s,r.x),l=Math.max(l,r.y);return o&&(a=Math.min(a,o.x),i=Math.min(i,o.y),s=Math.max(s,o.x+o.width),l=Math.max(l,o.y+o.height)),{x:a,y:i,width:s-a,height:l-i}}function Lf({nodes:e,edges:t}){return ht.expand(ht.merge(...e,...t.map(Bf)),10)}function Dd(e,t,o=.065){const a=Math.round(e/2),i=a,s=ut(o*a),l=t-2*s;return{path:`  M ${e},${s}
        a ${i},${s} 0,0,0 ${-e} 0
        l 0,${l}
        a ${i},${s} 0,0,0 ${e} 0
        l 0,${-l}
        z
        `.replace(/\s+/g," ").trim(),ry:s,rx:i}}function Bd(e,t,o=.185){const a=t,i=Math.round(a/2),s=ut(a/2*o),l=e-2*s;return{path:`
    M ${s},0
    a ${s},${i} 0,0,0 0 ${a}
    l ${l},0
    a ${s},${i} 0,0,0 0 ${-a}
    z`.replace(/\s+/g," ").trim(),ry:i,rx:s}}const xt={width:115,height:120,path:"M57.9197 0C10.9124 0 33.5766 54.75 33.5766 54.75C38.6131 62.25 45.3285 60.75 45.3285 66C45.3285 70.5 39.4526 72 33.5766 72.75C24.3431 72.75 15.9489 71.25 7.55474 84.75C2.51825 93 0 120 0 120H115C115 120 112.482 93 108.285 84.75C99.8905 70.5 91.4963 72.75 82.2628 72C76.3869 71.25 70.5109 69.75 70.5109 65.25C70.5109 60.75 77.2263 62.25 82.2628 54C82.2628 54.75 104.927 0 57.9197 0V0Z"};function lr({shape:e,w:t,h:o}){switch(e){case"mobile":return n.jsxs(n.Fragment,{children:[n.jsx("rect",{width:t,height:o,rx:6,"data-likec4-fill":"mix-stroke",strokeWidth:0}),n.jsxs("g",{"data-likec4-fill":"fill",strokeWidth:0,children:[n.jsx("circle",{cx:17,cy:o/2,r:12}),n.jsx("rect",{x:33,y:12,width:t-44,height:o-24,rx:5})]})]});case"browser":return n.jsxs(n.Fragment,{children:[n.jsx("rect",{width:t,height:o,rx:6,"data-likec4-fill":"mix-stroke",strokeWidth:0}),n.jsxs("g",{"data-likec4-fill":"fill",strokeWidth:0,children:[n.jsx("circle",{cx:16,cy:17,r:7}),n.jsx("circle",{cx:36,cy:17,r:7}),n.jsx("circle",{cx:56,cy:17,r:7}),n.jsx("rect",{x:70,y:8,width:t-80,height:17,rx:4}),n.jsx("rect",{x:10,y:32,width:t-20,height:o-42,rx:4})]})]});case"person":return n.jsxs(n.Fragment,{children:[n.jsx("rect",{width:t,height:o,rx:6,strokeWidth:0}),n.jsx("svg",{x:t-xt.width-6,y:o-xt.height,width:xt.width,height:xt.height,viewBox:`0 0 ${xt.width} ${xt.height}`,"data-likec4-fill":"mix-stroke",children:n.jsx("path",{strokeWidth:0,d:xt.path})})]});case"queue":{const{path:a,rx:i,ry:s}=Bd(t,o);return n.jsxs(n.Fragment,{children:[n.jsx("path",{d:a,strokeWidth:2}),n.jsx("ellipse",{cx:i,cy:s,ry:s-.75,rx:i,"data-likec4-fill":"mix-stroke",strokeWidth:2})]})}case"storage":case"cylinder":{const{path:a,rx:i,ry:s}=Dd(t,o);return n.jsxs(n.Fragment,{children:[n.jsx("path",{d:a,strokeWidth:2}),n.jsx("ellipse",{cx:i,cy:s,ry:s,rx:i-.75,"data-likec4-fill":"mix-stroke",strokeWidth:2})]})}default:return it(e)}}function Tf({shape:e,w:t,h:o}){let a;switch(e){case"queue":a=n.jsx("path",{d:Bd(t,o).path});break;case"storage":case"cylinder":{a=n.jsx("path",{d:Dd(t,o).path});break}default:{a=n.jsx("rect",{x:-1,y:-1,width:t+2,height:o+2,rx:6});break}}return n.jsx("g",{className:"likec4-shape-outline",children:a})}function Af({multiple:e,withOutLine:t}){return n.jsxs("div",{className:hd({shapetype:"html"}),children:[e&&n.jsx("div",{className:"likec4-shape-multiple"}),t&&n.jsx("div",{className:"likec4-shape-outline"})]})}function to({data:e,width:t,height:o,showSeletionOutline:a=!0}){let i=t&&t>10?t:e.width,s=o&&o>10?o:e.height;const l=e.style?.multiple??!1;if(e.shape==="rectangle")return n.jsx(Af,{multiple:l,withOutLine:a});const r=hd({shapetype:"svg"});return n.jsxs(n.Fragment,{children:[l&&n.jsx("svg",{className:r,"data-likec4-shape-multiple":"true",viewBox:`0 0 ${i} ${s}`,children:n.jsx(lr,{shape:e.shape,w:i,h:s})}),n.jsxs("svg",{className:r,viewBox:`0 0 ${i} ${s}`,children:[a&&n.jsx(Tf,{shape:e.shape,w:i,h:s}),n.jsx(lr,{shape:e.shape,w:i,h:s})]})]})}const qn=g.forwardRef(({tag:e,cursor:t,className:o,style:a,...i},s)=>{const l=rm(e);return n.jsxs(K,{ref:s,"data-likec4-tag":e,className:P(Tm({autoTextColor:Cl(l)}),o),...i,style:{cursor:t,...a},children:[n.jsx("span",{children:"#"}),n.jsx("span",{children:e})]})}),zf=(e,t)=>e.data.width===t.data.width&&I(e.data.tags,t.data.tags)&&(e.data.hovered??!1)===(t.data.hovered??!1),Io=g.memo(({id:e,data:{tags:t,width:o,hovered:a=!1}})=>{const{hovered:i,ref:s}=Ma(),{hovered:l,ref:r}=Ma(),[d,u]=zc(!1,a?120:300);g.useEffect(()=>{u(C=>C?a||i||l:a&&(i||l))},[i,l,a]);const c=Lh(),p=c>1.2,h=H(),f=C=>{h.send({type:"tag.highlight",tag:C})},x=g.useCallback(()=>{h.send({type:"tag.unhighlight"})},[]);if(!t||t.length===0)return null;const w=Math.max(Math.round(o*c)-10,200);return n.jsxs(n.Fragment,{children:[n.jsx("div",{ref:s,className:P("likec4-element-tags",pe({pointerEvents:"all",gap:"1",alignItems:"flex-end",justifyItems:"stretch",position:"absolute",width:"100%",bottom:"0",left:"0",padding:"1",_shapeCylinder:{bottom:"[5px]"},_shapeStorage:{bottom:"[5px]"},_shapeQueue:{bottom:"0",paddingLeft:"[14px]"}})),onClick:ie,children:t.map(C=>n.jsx(K,{"data-likec4-tag":C,className:y({layerStyle:"likec4.tag",flex:"1",display:"flex",alignItems:"center",justifyContent:"center",maxWidth:50,height:5,_whenHovered:{height:12,borderRadius:4,transitionDelay:".08s"},transition:"fast"})},e+"#"+C))}),n.jsx(ai,{isVisible:d,align:"start",position:ge.Bottom,children:n.jsx(oe,{ref:r,css:{gap:"0.5",alignItems:"baseline",flexWrap:"wrap",pb:"sm",translate:"auto",x:"[-8px]",maxWidth:w},children:t.map(C=>n.jsx(qn,{tag:C,cursor:"pointer",className:y({userSelect:"none",...p&&{fontSize:"lg",borderRadius:"[4px]",px:"1.5"}}),onClick:v=>{v.stopPropagation(),h.openSearch(`#${C}`)},onMouseEnter:()=>f(C),onMouseLeave:x},C))})})]})},zf);Io.displayName="ElementTags";const zo=(e,t)=>Math.abs(e-t)<2.5,$f=(e,t)=>e.id===t.id&&I(e.selected??!1,t.selected??!1)&&I(e.animated??!1,t.animated??!1)&&I(e.source,t.source)&&zo(e.sourceX,t.sourceX)&&zo(e.sourceY,t.sourceY)&&I(e.sourceHandleId??null,t.sourceHandleId??null)&&I(e.sourcePosition,t.sourcePosition)&&I(e.target,t.target)&&zo(e.targetY,t.targetY)&&zo(e.targetX,t.targetX)&&I(e.targetHandleId??null,t.targetHandleId??null)&&I(e.targetPosition,t.targetPosition)&&I(e.data,t.data);function Gi(e){const t=g.memo(e,$f);return t.displayName=`MemoEdge(${e.displayName||e.name})`,t}function Ff(e,t){return e.id===t.id&&I(e.type,t.type)&&I(e.selected??!1,t.selected??!1)&&I(e.dragging??!1,t.dragging??!1)&&I(e.width??0,t.width??0)&&I(e.height??0,t.height??0)&&I(e.zIndex??0,t.zIndex??0)&&I(e.data,t.data)}const dr=Symbol.for("isMemoized");function Ue(e,t="Node"){if(e.hasOwnProperty(dr))return e;const o=g.memo(e,Ff);return o.displayName=t,Object.defineProperty(o,dr,{enumerable:!1,writable:!1,value:!0}),o}const $o={top:"50%",left:"50%",right:"unset",bottom:"unset",visibility:"hidden",width:5,height:5,transform:"translate(-50%, -50%)"},Eo=()=>n.jsxs(n.Fragment,{children:[n.jsx(Pe,{type:"target",position:ge.Top,style:$o}),n.jsx(Pe,{type:"target",position:ge.Left,style:$o}),n.jsx(Pe,{type:"source",position:ge.Right,style:$o}),n.jsx(Pe,{type:"source",position:ge.Bottom,style:$o})]}),Vf=g.forwardRef((e,t)=>n.jsx("svg",{height:"24",width:"24",fill:"currentColor",...e,viewBox:"0 0 24 24",ref:t,children:n.jsx("path",{d:"M12 1C5.923 1 1 5.923 1 12c0 4.867 3.149 8.979 7.521 10.436.55.096.756-.233.756-.522 0-.262-.013-1.128-.013-2.049-2.764.509-3.479-.674-3.699-1.292-.124-.317-.66-1.293-1.127-1.554-.385-.207-.936-.715-.014-.729.866-.014 1.485.797 1.691 1.128.99 1.663 2.571 1.196 3.204.907.096-.715.385-1.196.701-1.471-2.448-.275-5.005-1.224-5.005-5.432 0-1.196.426-2.186 1.128-2.956-.111-.275-.496-1.402.11-2.915 0 0 .921-.288 3.024 1.128a10.193 10.193 0 0 1 2.75-.371c.936 0 1.871.123 2.75.371 2.104-1.43 3.025-1.128 3.025-1.128.605 1.513.221 2.64.111 2.915.701.77 1.127 1.747 1.127 2.956 0 4.222-2.571 5.157-5.019 5.432.399.344.743 1.004.743 2.035 0 1.471-.014 2.654-.014 3.025 0 .289.206.632.756.522C19.851 20.979 23 16.854 23 12c0-6.077-4.922-11-11-11Z"})})),cr="https://github.com/",Zi=g.forwardRef(({value:e,className:t,...o},a)=>{const i=e.url.includes("://")?e.url:new window.URL(e.url,window.location.href).toString();let s=i.startsWith(cr);return n.jsx(pt,{ref:a,variant:"default",radius:"sm",size:"sm",tt:"none",leftSection:e.title?n.jsx(n.Fragment,{children:e.title}):null,rightSection:n.jsx($c,{value:i,timeout:1500,children:({copy:l,copied:r})=>n.jsx(U,{className:y({opacity:r?1:.45,transition:"fast",_hover:{opacity:1}}),tabIndex:-1,size:"20",variant:r?"light":"transparent",color:r?"teal":"gray","data-active":r,onClick:d=>{d.stopPropagation(),d.preventDefault(),l()},children:r?n.jsx(Fl,{}):n.jsx(gg,{stroke:2.5})})}),...o,className:P(t,"group"),classNames:{root:y({flexWrap:"nowrap",minHeight:24,maxWidth:500,userSelect:"all",pr:"0",backgroundColor:{base:"transparent",_hover:{base:"mantine.colors.gray[1]",_dark:"mantine.colors.dark[5]"}}}),section:y({'&:is([data-position="left"])':{color:"mantine.colors.dimmed",userSelect:"none",pointerEvents:"none",_groupHover:{color:"[var(--badge-color)]",opacity:.7}}})},children:n.jsxs(ft.a,{href:i,target:"_blank",style:{color:"var(--badge-color)",cursor:"pointer"},css:{transition:"fast",opacity:{base:.7,_hover:1},textDecoration:{base:"none",_hover:"underline"}},children:[s&&n.jsx(Vf,{height:"12",width:"12",style:{verticalAlign:"middle",marginRight:"4px"}}),s?i.replace(cr,""):i]})})}),Wf=({context:e})=>{const t=e.view;return{id:t.id,title:e.viewModel?.title??(t.title&&Pl(t.title))??"Untitled View",description:e.viewModel?.description??Ge.from(t.description),tags:t.tags??[],links:t.links??[]}},Of=e=>{const[t,o]=g.useState(!1),a=Yi(Wf,I),i=Jt();return n.jsxs(nt,{position:"bottom-end",shadow:"xl",clickOutsideEvents:["pointerdown","mousedown","click"],offset:{mainAxis:4},opened:t,onChange:o,...i,...e,children:[n.jsx(Hf,{linksCount:a.links.length,onOpen:()=>o(!0)}),t&&n.jsx(Xf,{data:a,onClose:()=>o(!1)})]})},Hf=({linksCount:e,onOpen:t})=>n.jsx(nt.Target,{children:n.jsxs(se,{component:Be,layout:"position",whileTap:{scale:.95,translateY:1},onClick:o=>{o.stopPropagation(),t()},className:P("group",pe({gap:"2",paddingInline:"2",paddingBlock:"1",rounded:"sm",userSelect:"none",cursor:"pointer",color:{base:"likec4.panel.action",_hover:"likec4.panel.action.hover"},backgroundColor:{_hover:"likec4.panel.action.bg.hover"},display:{base:"none","@/xs":"flex"}}),""),children:[n.jsx(Ni,{size:16,stroke:1.8}),e>0&&n.jsxs(oe,{gap:"[1px]",children:[n.jsx(Xg,{size:14,stroke:2}),n.jsx(K,{css:{fontSize:"11px",fontWeight:600,lineHeight:1,opacity:.8},children:e})]})]})}),ur=ft("div",{base:{fontSize:"xs",color:"mantine.colors.dimmed",fontWeight:500,userSelect:"none",mb:"xxs"}}),Xf=({data:{id:e,title:t,description:o,tags:a,links:i},onClose:s})=>{const l=H();return Me("paneClick",s),Me("nodeClick",s),n.jsxs(nt.Dropdown,{className:P("nowheel nopan nodrag",ko({margin:"xs",layerStyle:"likec4.dropdown",gap:"md",padding:"md",paddingBottom:"lg",pointerEvents:"all",maxWidth:"calc(100cqw - 52px)",minWidth:"200px",maxHeight:"calc(100cqh - 100px)",width:"max-content",cursor:"default",overflow:"auto",overscrollBehavior:"contain","@/sm":{minWidth:400,maxWidth:550},"@/lg":{maxWidth:700}})),children:[n.jsxs("section",{children:[n.jsx(L,{component:"div",fw:500,size:"xl",lh:"sm",children:t}),n.jsxs(oe,{alignItems:"flex-start",mt:"1",children:[n.jsx(Yf,{label:"id",value:e}),n.jsx(oe,{gap:"xs",flexWrap:"wrap",children:a.map(r=>n.jsx(qn,{tag:r,cursor:"pointer",onClick:d=>{d.stopPropagation(),l.openSearch(`#${r}`)}},r))})]})]}),i.length>0&&n.jsxs("section",{className:pe({alignItems:"baseline"}),children:[n.jsx(ur,{children:"Links"}),n.jsx(oe,{gap:"xs",flexWrap:"wrap",children:i.map((r,d)=>n.jsx(Zi,{value:r},`${d}-${r.url}`))})]}),o.isEmpty&&n.jsx(L,{component:"div",fw:500,size:"xs",c:"dimmed",style:{userSelect:"none"},children:"No description"}),o.nonEmpty&&n.jsxs("section",{children:[n.jsx(ur,{children:"Description"}),n.jsx(Mt,{value:o,fontSize:"sm",emptyText:"No description",className:y({userSelect:"all"})})]})]})},Yf=({label:e,value:t})=>n.jsxs(oe,{gap:"0.5",children:[n.jsx(qf,{children:e}),n.jsx(pt,{size:"sm",radius:"sm",variant:"light",color:"gray",tt:"none",fw:500,classNames:{root:y({width:"max-content",overflow:"visible",px:"1",color:{_dark:"mantine.colors.gray[4]",_light:"mantine.colors.gray[8]"}}),label:y({overflow:"visible"}),section:y({opacity:.5,userSelect:"none",marginInlineEnd:"0.5"})},children:t})]}),qf=ft("div",{base:{color:"mantine.colors.dimmed",fontWeight:500,fontSize:"xxs",userSelect:"none"}}),Ld=g.memo(()=>{const[e,{toggleCompare:t}]=Wi(),o=Jt(),{drifts:a,isActive:i,isEnabled:s}=e;return n.jsx(ue,{propagate:!0,children:s&&!i&&n.jsxs(Fc,{position:"bottom-start",openDelay:600,closeDelay:200,floatingStrategy:"absolute",offset:{mainAxis:4,crossAxis:-22},...o,children:[n.jsx(Vc,{children:n.jsx(se,{component:Be,layout:"position",onClick:l=>{t()},whileTap:{scale:.95,translateY:1},className:P("group",Oi({variant:"filled",type:"warning"}),pe({gap:"xxs",padding:"1.5",rounded:"sm",userSelect:"none",cursor:"pointer",fontSize:"xs",fontWeight:600})),children:i?n.jsx(n.Fragment,{children:"Stop Compare"}):n.jsx($l,{size:18})})}),n.jsx(Wc,{p:"0",children:n.jsxs(Qr,{color:"orange",withBorder:!1,withCloseButton:!1,title:"View is out of sync",children:[n.jsx(L,{mt:2,size:"sm",lh:"xs",children:"Model has changed since this view was last updated."}),n.jsxs(L,{mt:4,size:"sm",lh:"xs",children:["Detected changes:",a.map(l=>n.jsxs(g.Fragment,{children:[n.jsx("br",{}),n.jsxs("span",{children:["- ",l]})]},l))]}),n.jsx(ke,{mt:"xs",size:"compact-sm",variant:"default",onClick:l=>{l.stopPropagation(),t()},children:"Compare with current state"})]})})]})})});Ld.displayName="ManualLayoutWarning";const Gf=()=>{const e=H(),{hasStepBack:t,hasStepForward:o}=Ve(a=>({hasStepBack:a.navigationHistory.currentIndex>0,hasStepForward:a.navigationHistory.currentIndex<a.navigationHistory.history.length-1}));return n.jsxs(Q,{layout:"position",className:pe({gap:"0.5"}),children:[n.jsx(tt,{disabled:!t,onClick:a=>{a.stopPropagation(),e.navigate("back")},children:n.jsx(og,{size:14})}),n.jsx(tt,{disabled:!o,onClick:a=>{a.stopPropagation(),e.navigate("forward")},children:n.jsx(Yt,{size:14})})]})},Zf=()=>{const e=Wn(),{enableVscode:t}=Z(),{onOpenSource:o}=Qt();return t?n.jsx(vd,{label:"Open View Source",children:n.jsx(tt,{onClick:a=>{a.stopPropagation(),o?.({view:e})},children:n.jsx(Kt,{style:{width:"60%",height:"60%"}})})}):null},Td=g.memo(()=>{const{enableSearch:e,enableCompareWithLatest:t}=Z(),o=H(),a=Oc();return n.jsx(ue,{children:e&&!t&&n.jsxs(se,{component:Be,layout:"position",onClick:i=>{i.stopPropagation(),o.openSearch()},whileTap:{scale:.95,translateY:1},className:P("group",pe({gap:"xxs",paddingInline:"sm",paddingBlock:"xxs",userSelect:"none",layerStyle:"likec4.panel.action",display:{base:"none","@/md":"flex"}})),children:[n.jsx(Ei,{size:14,stroke:2.5}),n.jsx(K,{css:{fontSize:"11px",fontWeight:600,lineHeight:1,opacity:.8,whiteSpace:"nowrap"},children:a?" + K":"Ctrl + K"})]})})});Td.displayName="SearchControl";const Kf=e=>({visible:e.features.enableReadOnly!==!0&&(e.view._type!=="dynamic"||e.dynamicViewVariant!=="sequence"),isReadOnly:e.toggledFeatures.enableReadOnly??e.features.enableReadOnly}),Uf=()=>{const{visible:e,isReadOnly:t}=Ve(Kf),o=H();return n.jsx(ue,{mode:"popLayout",children:e&&n.jsxs(se,{component:Be,layout:"position",onClick:a=>{a.stopPropagation(),o.toggleFeature("ReadOnly")},initial:{opacity:0,scale:.6},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.6},whileTap:{translateY:1},className:P("group",pe({gap:"0.5",paddingInline:"xxs",paddingBlock:"xxs",rounded:"sm",userSelect:"none",cursor:"pointer",color:{base:"likec4.panel.action",_hover:"likec4.panel.action.hover"},backgroundColor:{_hover:"likec4.panel.action.bg.hover"}})),children:[t?n.jsx(Gg,{size:14,stroke:2}):n.jsx(Ol,{size:14,stroke:2}),t&&n.jsx(Q,{className:y({fontSize:"11px",fontWeight:600,lineHeight:1,opacity:.8}),children:"Edit"})]})})},yn=wo({base:{fontSize:"sm",fontWeight:"500",transition:"fast",color:{base:"likec4.panel.action",_hover:"likec4.panel.action.hover"}},variants:{truncate:{true:{truncate:!0}},dimmed:{true:{color:{base:"likec4.panel.text.dimmed",_hover:"likec4.panel.action"}}}}}),xn=g.createContext(null),Ad=[];function lv(){const e=g.useContext(xn);return e?e.projects:Ad}const Qf=()=>{},Jf={projects:Ad,onProjectChange:Qf};function ey(){return g.useContext(xn)??Jf}function ty(){const e=g.useContext(Fn);if(!e)throw new Error("No LikeC4ModelContext found");return e.projectId}function zd(){const e=g.useContext(Fn);e||console.error("No LikeC4ModelContext found");const t=e?.$styles??dp.DEFAULT,[o,a]=g.useState(t);return g.useEffect(()=>{a(i=>i.equals(t)?i:t)},[t]),o}const $d=g.forwardRef((e,t)=>n.jsx(ke,{variant:"filled",size:"xs",fw:"500",...e,ref:t,component:Be,whileTap:{scale:.95},layout:"position",layoutId:"trigger-dynamic-walkthrough",className:y({flexShrink:0})}));function oy(){const{enableReadOnly:e,enableCompareWithLatest:t}=Z(),o=H(),a=Co();let i="Start Dynamic View Walkthrough";switch(!0){case!e:i="Walkthrough not available in Edit mode";break;case t:i="Walkthrough not available when Compare is active";break}return n.jsx(vd,{label:i,children:n.jsx($d,{onClick:s=>{s.stopPropagation(),a.closeDropdown(),o.startWalkthrough()},initial:{opacity:0,scale:.6,translateX:-10},animate:{opacity:1,scale:1,translateX:0},exit:{opacity:0,translateX:-20},size:"compact-xs",h:26,disabled:!e||t,classNames:{label:y({display:{base:"none","@/md":"inherit"}}),section:y({marginInlineStart:{base:"0","@/md":"2"}})},rightSection:n.jsx(bh,{size:10}),children:"Start"})})}const ny=g.forwardRef(({value:e,onChange:t},o)=>n.jsx(Q,{ref:o,layout:"position",children:n.jsx(Nn,{size:"xs",value:e,component:Q,onChange:a=>{q(a==="diagram"||a==="sequence","Invalid dynamic view variant"),t(a)},classNames:{label:y({fontSize:"xxs"})},data:[{value:"diagram",label:"Diagram"},{value:"sequence",label:"Sequence"}]})}));function ay(){const e=Ve(o=>o.dynamicViewVariant),t=H();return n.jsxs(ue,{children:[n.jsx(ny,{value:e,onChange:o=>{t.switchDynamicViewVariant(o)}}),n.jsx(oy,{},"trigger-dynamic-walkthrough")]})}const pr=ke.withProps({component:Be,layout:"position",whileTap:{scale:.95},variant:"light",size:"xs",fw:"500"}),iy=()=>{const{portalProps:e}=Jt();return n.jsx(hl,{...e,children:n.jsx(K,{css:{position:"absolute",margin:"0",padding:"0",top:"0",left:"0",width:"100%",height:"100%",border:"2px solid",borderColor:"mantine.colors.orange[6]",pointerEvents:"none",md:{borderWidth:4}}})})};function sy(){const e=H(),{isParallel:t,hasNext:o,hasPrevious:a,currentStep:i,totalSteps:s}=Ve(l=>{const r=l.xyedges.findIndex(d=>d.id===l.activeWalkthrough?.stepId);return{isParallel:Se(l.activeWalkthrough?.parallelPrefix),hasNext:r<l.xyedges.length-1,hasPrevious:r>0,currentStep:r+1,totalSteps:l.xyedges.length}});return n.jsxs(ue,{propagate:!0,mode:"popLayout",children:[n.jsx($d,{variant:"light",size:"xs",color:"orange",mr:"sm",onClick:l=>{l.stopPropagation(),e.stopWalkthrough()},rightSection:n.jsx(Sh,{size:10}),children:"Stop"},"stop-walkthrough"),n.jsx(pr,{disabled:!a,onClick:()=>e.walkthroughStep("previous"),leftSection:n.jsx(vh,{size:10}),children:"Previous"},"prev"),n.jsxs(pt,{component:Q,layout:"position",size:"md",radius:"sm",variant:t?"gradient":"transparent",gradient:{from:"red",to:"orange",deg:90},rightSection:n.jsx(Q,{className:y({fontSize:"xxs",display:t?"block":"none"}),children:"parallel"}),className:y({alignItems:"baseline"}),children:[i," / ",s]},"step-badge"),n.jsx(pr,{disabled:!o,onClick:()=>e.walkthroughStep("next"),rightSection:n.jsx(jh,{size:10}),children:"Next"},"next"),t&&n.jsx(iy,{},"parallel-frame")]})}const ry=({context:e})=>{const t=e.view,o=e.viewModel?.folder;return{folders:!o||o.isRoot?[]:o.breadcrumbs.map(a=>({folderPath:a.path,title:a.title})),viewId:t.id,viewTitle:e.viewModel?.title??(t.title&&Pl(t.title))??"Untitled View",isDynamicView:(e.viewModel?._type??t._type)==="dynamic"}},Fd=g.memo(()=>{const e=Co(),{enableNavigationButtons:t,enableDynamicViewWalkthrough:o}=Z(),{folders:a,viewTitle:i,isDynamicView:s}=ne(e.actorRef,ry,I),l=a.flatMap(({folderPath:d,title:u},c)=>[n.jsx(se,{component:Be,className:P(yn({dimmed:!0,truncate:!0}),"mantine-active",y({userSelect:"none",maxWidth:"200px",display:{base:"none","@/md":"block"}})),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},title:u,onMouseEnter:()=>e.send({type:"breadcrumbs.mouseEnter.folder",folderPath:d}),onMouseLeave:()=>e.send({type:"breadcrumbs.mouseLeave.folder",folderPath:d}),onClick:p=>{p.stopPropagation(),e.send({type:"breadcrumbs.click.folder",folderPath:d})},children:u},d),n.jsx(kd,{},`separator-${c}`)]),r=n.jsx(se,{component:Be,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:P("mantine-active",yn({truncate:!0}),y({userSelect:"none"})),title:i,onMouseEnter:()=>e.send({type:"breadcrumbs.mouseEnter.viewtitle"}),onMouseLeave:()=>e.send({type:"breadcrumbs.mouseLeave.viewtitle"}),onClick:d=>{d.stopPropagation(),e.send({type:"breadcrumbs.click.viewtitle"})},children:i},"view-title");return n.jsxs(ue,{propagate:!0,mode:"popLayout",children:[n.jsx(hf,{},"burger-button"),t&&n.jsx(Gf,{},"nav-buttons"),n.jsxs(Q,{layout:"position",className:pe({gap:"1",flexShrink:1,flexGrow:1,overflow:"hidden"}),children:[l,r]},"breadcrumbs"),n.jsxs(Q,{layout:"position",className:pe({gap:"0.5",flexGrow:0,_empty:{display:"none"}}),children:[n.jsx(Of,{onOpen:()=>e.closeDropdown()}),n.jsx(Zf,{}),n.jsx(Uf,{})]},"actions"),o&&s&&n.jsx(ay,{},"dynamic-view-controls"),n.jsx(Td,{},"search-control"),n.jsx(Ld,{},"outdated-manual-layout-warning")]})});Fd.displayName="NavigationPanelControls";const Ya=g.forwardRef(({className:e,truncateLabel:t=!0,...o},a)=>n.jsx(Hc,{...o,component:"button",classNames:Km({truncateLabel:t}),className:P("group","mantine-active",e),ref:a}));Ya.displayName="NavigationLink";const Vd=e=>{const{enableNavigateTo:t}=Z(),o=H(),{navigateTo:a}=e.data;return a&&t?n.jsx(mf,{onClick:i=>{i.stopPropagation(),o.navigateTo(a,e.id)},...e}):null},ly=(e,t)=>I(e.data.id,t.data.id)&&I(e.selected??!1,t.selected??!1)&&I(e.data.modelFqn??null,t.data.modelFqn??null)&&I(e.data.navigateTo??null,t.data.navigateTo??null)&&I(e.data.hovered??!1,t.data.hovered??!1)&&(!e.extraButtons&&!t.extraButtons||ee(e.extraButtons,t.extraButtons)),Wd=g.memo(({extraButtons:e,...t})=>{const{enableNavigateTo:o,enableRelationshipBrowser:a}=Z(),i=H(),{id:s,navigateTo:l,modelFqn:r}=t.data;let d=g.useMemo(()=>{const u=[];return l&&o&&u.push({key:"navigate",icon:n.jsx(Le,{}),onClick:c=>{c.stopPropagation(),i.navigateTo(l,s)}}),a&&u.push({key:"relationships",icon:n.jsx(vo,{}),onClick:c=>{c.stopPropagation(),i.openRelationshipsBrowser(r)}}),u},[o,a,r,l,s,i]);return e&&ve(e,1)&&(d=[...d,...e]),n.jsx(Yn,{...t,buttons:d})},ly),dy=({extraButtons:e,...t})=>{const{enableNavigateTo:o,enableRelationshipBrowser:a}=Z(),i=H(),{id:s,navigateTo:l,modelFqn:r}=t.data;let d=g.useMemo(()=>{const u=[];return l&&o&&u.push({key:"navigate",icon:n.jsx(Le,{}),onClick:c=>{c.stopPropagation(),i.navigateTo(l,s)}}),a&&r&&u.push({key:"relationships",icon:n.jsx(vo,{}),onClick:c=>{c.stopPropagation(),i.openRelationshipsBrowser(r)}}),u},[o,a,r,l,s]);return e&&ve(e,1)&&(d=[...d,...e]),n.jsx(Yn,{...t,buttons:d})};function Od({data:e}){const t=e.drifts;return!t||t.length===0?null:n.jsx(K,{className:"likec4-node-drifts",css:{position:"absolute",inset:"0",pointerEvents:"none","& + .likec4-element-shape":{outlineColor:"likec4.compare.manual.outline",outlineWidth:{base:"2px",_light:"4px"},outlineStyle:"solid",outlineOffset:"1"}},children:n.jsx(ai,{isVisible:e.hovered===!0,align:"start",position:ge.Bottom,children:n.jsx(Qr,{color:"orange",withBorder:!1,withCloseButton:!1,title:"Changes:",children:t.map(o=>n.jsxs(L,{mt:2,size:"sm",lh:"xs",children:["- ",o]},o))})})})}const Hd=_e.withProps({color:"dark",fz:"xs",openDelay:400,closeDelay:150,label:"",children:null,offset:4,withinPortal:!1});function Gn({fqn:e}){const t=H();return n.jsx(Hd,{label:"Browse relationships",children:n.jsx(U,{size:"sm",variant:"subtle",color:"gray",onClick:o=>{o.stopPropagation(),t.openRelationshipsBrowser(e)},children:n.jsx(vo,{stroke:2,style:{width:"72%",height:"72%"}})})})}function Zn(e){const{onOpenSource:t}=Qt();return t?n.jsx(Hd,{label:"Open source",children:n.jsx(U,{size:"sm",variant:"subtle",color:"gray",onClick:o=>{o.stopPropagation(),e.elementId?t?.({element:e.elementId}):e.deploymentId&&t?.({deployment:e.deploymentId})},children:n.jsx(Kt,{stroke:1.8,style:{width:"70%"}})})}):null}const gr=["primary","secondary","muted"];function Kn({elementColor:e,elementOpacity:t,onColorPreview:o,isOpacityEditable:a=!1,onChange:i,...s}){const{theme:l}=zd();return n.jsxs(nt,{clickOutsideEvents:["pointerdown","mousedown","click"],position:"right-end",offset:2,withinPortal:!1,...s,children:[n.jsx(Gt,{children:n.jsx(ke,{variant:"subtle",color:"gray",size:"compact-xs",px:3,children:n.jsx(Ba,{color:l.colors[e].elements.fill,size:14,withShadow:!0,style:{color:"#fff",cursor:"pointer"}})})}),n.jsxs(Zt,{p:"xs",children:[n.jsx(cy,{theme:l,elementColor:e,onColorPreview:o,onChange:r=>i({color:r})}),a&&n.jsxs(n.Fragment,{children:[n.jsx(ks,{h:"xs"}),n.jsx(yo,{label:"opacity",labelPosition:"left"}),n.jsx(ks,{h:"xs"}),n.jsx(uy,{elementOpacity:t,onOpacityChange:r=>{i({opacity:r})}})]})]})]})}function cy({theme:e,elementColor:t,onColorPreview:o,onChange:a}){const i=l=>r=>{r.stopPropagation(),o(null),t!==l&&a(l)},s=ei(e.colors).filter(l=>!gr.includes(l));return n.jsx(Ne,{gap:2,onMouseLeave:()=>o(null),children:n.jsxs(Mn,{openDelay:1e3,closeDelay:300,children:[n.jsx(_t,{maw:120,gap:"6",justify:"flex-start",align:"flex-start",direction:"row",wrap:"wrap",children:gr.map(l=>n.jsx(_e,{label:l,fz:"xs",color:"dark",offset:2,withinPortal:!1,transitionProps:{duration:140,transition:"slide-up"},children:n.jsx(Ba,{color:e.colors[l].elements.fill,size:18,withShadow:!0,onMouseEnter:()=>o(l),onClick:i(l),style:{color:"#fff",cursor:"pointer"},children:t===l&&n.jsx(js,{style:{width:Je(10),height:Je(10)}})})},l))}),n.jsx(_t,{mt:"sm",maw:110,gap:"6",justify:"flex-start",align:"flex-start",direction:"row",wrap:"wrap",children:s.map(l=>n.jsx(_e,{label:l,fz:"xs",color:"dark",offset:2,transitionProps:{duration:140,transition:"slide-up"},children:n.jsx(Ba,{color:e.colors[l].elements.fill,size:18,onMouseEnter:()=>o(l),onClick:i(l),style:{color:"#fff",cursor:"pointer"},children:t===l&&n.jsx(js,{style:{width:Je(10),height:Je(10)}})})},l))})]})})}function uy({elementOpacity:e=100,onOpacityChange:t}){const[o,a]=g.useState(e);return al(()=>{a(e)},[e]),n.jsx(ep,{size:"sm",color:"dark",value:o,onChange:a,onChangeEnd:t})}const py=y({color:"mantine.colors.dimmed",fontSize:"10px",fontWeight:600,maxWidth:"220px",cursor:"default",userSelect:"all",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}),gy=()=>Ve(e=>e.xynodes.filter(t=>t.selected).length);function Un({title:e,children:t,nodeProps:o,...a}){const i=gy(),{selected:s=!1,dragging:l=!1,data:{hovered:r=!1}}=o,d=r&&i===0||s&&i===1;let u=150;d?s?u=100:u=1e3:i>0&&(u=50);const[c]=mi(d,u);return c?n.jsx(ai,{isVisible:!l,offset:4,...a,children:n.jsx(li,{className:P("nodrag","nopan"),px:5,pb:8,pt:4,radius:"sm",shadow:"xl",onDoubleClickCapture:ie,onPointerDown:ie,onClick:ie,onDoubleClick:ie,withBorder:!0,children:n.jsxs(Ne,{gap:"6px",children:[n.jsx(X,{px:"4px",children:n.jsx(L,{className:py,children:e})}),n.jsx(re,{gap:4,children:t})]})})}):null}function Qn(e,t){const o=H(),[a,i]=g.useState(null),s=A(r=>{if(r===null){if(!a)return;i(null),o.updateNodeData(t.data.id,{color:a});return}i(d=>d??t.data.color),o.updateNodeData(t.data.id,{color:r})}),l=A(r=>{const{shape:d,color:u,...c}=r;o.updateNodeData(t.data.id,{...d&&{shape:d},...u&&{color:u},style:c}),o.triggerChange({op:"change-element-style",style:r,targets:[e]})});return{elementColor:a??t.data.color,onColorPreview:s,onChange:l}}function hy(e){const{enableVscode:t,enableRelationshipBrowser:o}=Z(),{data:{style:a,modelFqn:i}}=e,{elementColor:s,onColorPreview:l,onChange:r}=Qn(i,e),d=a?.opacity??100;return n.jsxs(Un,{nodeProps:e,title:i,align:"start",children:[n.jsx(Kn,{elementColor:s,onColorPreview:l,isOpacityEditable:!0,elementOpacity:d,onChange:r,position:"left-start"}),n.jsx(Xd,{elementBorderStyle:a?.border??(d<99?"dashed":"none"),onChange:r}),t&&n.jsx(Zn,{elementId:i}),o&&n.jsx(Gn,{fqn:i})]})}function my(e){const{enableVscode:t,enableRelationshipBrowser:o}=Z(),{data:{deploymentFqn:a,style:i,modelFqn:s}}=e,{elementColor:l,onColorPreview:r,onChange:d}=Qn(a,e);return n.jsxs(Un,{nodeProps:e,title:a,align:"start",children:[n.jsx(Kn,{elementColor:l,onColorPreview:r,isOpacityEditable:!0,elementOpacity:i?.opacity,onChange:d,position:"left-start"}),n.jsx(Xd,{elementBorderStyle:i?.border,onChange:d}),t&&n.jsx(Zn,{deploymentId:a}),o&&s&&n.jsx(Gn,{fqn:s})]})}function Xd({elementBorderStyle:e="dashed",onChange:t}){const[o,a]=g.useState(e);return g.useEffect(()=>{a(e)},[e]),n.jsx(X,{children:n.jsx(Nn,{size:"xs",fullWidth:!0,withItemsBorders:!1,value:o,onChange:i=>{const s=i;a(s),t({border:s})},styles:{label:{paddingTop:"0.5",paddingBottom:"0.5"}},data:[{label:"Solid",value:"solid"},{label:"Dashed",value:"dashed"},{label:"Dotted",value:"dotted"},{label:"None",value:"none"}]})})}function fy(e){const{enableVscode:t,enableRelationshipBrowser:o}=Z(),{data:{shape:a,modelFqn:i}}=e,{elementColor:s,onColorPreview:l,onChange:r}=Qn(i,e);return n.jsxs(Un,{nodeProps:e,title:i,align:"start",children:[n.jsx(Yd,{elementShape:a,onChange:r}),n.jsx(Kn,{elementColor:s,onColorPreview:l,onChange:r,position:"right-end"}),t&&n.jsx(Zn,{elementId:i}),o&&n.jsx(Gn,{fqn:i})]})}function yy(e){const{enableVscode:t,enableRelationshipBrowser:o}=Z(),{data:{shape:a,deploymentFqn:i,modelFqn:s}}=e,{elementColor:l,onColorPreview:r,onChange:d}=Qn(i,e);return n.jsxs(Un,{nodeProps:e,title:i,align:"start",children:[n.jsx(Yd,{elementShape:a,onChange:d}),n.jsx(Kn,{elementColor:l,onColorPreview:r,onChange:d,position:"right-end"}),t&&n.jsx(Zn,{deploymentId:i}),o&&s&&n.jsx(Gn,{fqn:s})]})}function Yd({elementShape:e,onChange:t}){return n.jsxs(Te,{openDelay:300,closeDelay:450,floatingStrategy:"fixed",closeOnClickOutside:!0,clickOutsideEvents:["pointerdown","mousedown","click"],closeOnEscape:!0,closeOnItemClick:!1,position:"top-start",offset:2,styles:{item:{padding:"calc(var(--mantine-spacing-xs) / 1.5) var(--mantine-spacing-xs)"}},withinPortal:!1,children:[n.jsx(el,{children:n.jsx(ke,{variant:"light",color:"gray",size:"compact-xs",rightSection:n.jsx(Ri,{size:12}),children:e})}),n.jsx(tl,{onDoubleClick:ie,onClick:ie,children:pp.map(o=>n.jsx(ol,{fz:12,fw:500,value:o,rightSection:e===o?n.jsx(Fl,{size:12}):void 0,onClick:a=>{a.stopPropagation(),t({shape:o})},children:o},o))})]})}function Ki(e){const t=H(),o=e.data.modelFqn;return o?n.jsx(qi,{...e,onClick:a=>{a.stopPropagation(),t.openElementDetails(o,e.id)}}):null}function qd(e){const t=H(),o=e.data.modelFqn;return o?n.jsx(_d,{...e,onClick:a=>{a.stopPropagation(),t.openElementDetails(o,e.id)}}):null}function xy(e){const{enableElementTags:t,enableElementDetails:o,enableReadOnly:a,enableCompareWithLatest:i}=Z();return n.jsxs(eo,{nodeProps:e,children:[i&&n.jsx(Od,{...e}),n.jsx(to,{...e}),n.jsx(He,{...e}),t&&n.jsx(Io,{...e}),n.jsx(Wd,{...e}),o&&n.jsx(Ki,{...e}),!a&&n.jsx(fy,{...e}),n.jsx(Eo,{})]})}function by(e){const{enableElementTags:t,enableElementDetails:o,enableReadOnly:a,enableCompareWithLatest:i}=Z();return n.jsxs(eo,{nodeProps:e,children:[i&&n.jsx(Od,{...e}),n.jsx(to,{...e}),n.jsx(He,{...e}),t&&n.jsx(Io,{...e}),n.jsx(dy,{...e}),o&&n.jsx(Ki,{...e}),!a&&n.jsx(yy,{...e}),n.jsx(Eo,{})]})}function wy(e){const{enableElementDetails:t,enableReadOnly:o}=Z();return n.jsxs(So,{nodeProps:e,children:[n.jsx(_o,{...e}),n.jsx(Vd,{...e}),t&&n.jsx(qd,{...e}),!o&&n.jsx(hy,{...e}),n.jsx(Eo,{})]})}function vy(e){const{enableElementDetails:t,enableReadOnly:o}=Z();return n.jsxs(So,{nodeProps:e,children:[n.jsx(_o,{...e}),n.jsx(Vd,{...e}),t&&n.jsx(qd,{...e}),!o&&n.jsx(my,{...e}),n.jsx(Eo,{})]})}function ky(e){return n.jsxs(So,{nodeProps:e,children:[n.jsx(_o,{...e}),n.jsx(Eo,{})]})}const jy={left:ge.Left,right:ge.Right,top:ge.Top,bottom:ge.Bottom},Cy=({data:e,port:t})=>n.jsxs(n.Fragment,{children:[n.jsx(K,{"data-likec4-color":e.color,className:y({position:"absolute",backgroundColor:"var(--likec4-palette-fill)",rounded:"xs",width:{base:"5px",_whenHovered:"7px",_whenSelected:"7px"},transition:"fast",translateX:"-1/2",translateY:"-1/2",translate:"auto"}),style:{top:t.cy,left:t.cx,height:t.height}}),n.jsx(Pe,{id:t.id,type:t.type,position:jy[t.position],style:{top:t.cy-3,left:t.cx-3,width:6,height:6,right:"unset",bottom:"unset",visibility:"hidden",transform:t.position==="left"?"translate(-150%, 0)":"translate(100%, 0)"}})]}),Sy=e=>Se(e.modelFqn);function _y(e){const{enableElementDetails:t}=Z(),o=e.data,{id:a,positionAbsoluteY:i,data:{viewHeight:s,hovered:l=!1,ports:r}}=e;return n.jsxs(n.Fragment,{children:[n.jsx(K,{"data-likec4-color":"gray",className:y({position:"absolute",rounded:"xs",top:"1",pointerEvents:"none",transition:"fast",translateX:"-1/2",translate:"auto"}),style:{backgroundColor:"var(--likec4-palette-stroke)",opacity:l?.6:.4,left:"50%",width:l?3:2,height:s-i,zIndex:-1,pointerEvents:"none"}}),n.jsxs(eo,{nodeProps:e,children:[n.jsx(to,{...e}),n.jsx(He,{...e}),Sy(o)&&n.jsxs(n.Fragment,{children:[n.jsx(Wd,{...e,data:o}),t&&n.jsx(Ki,{id:a,data:o})]})]}),r.map(d=>n.jsx(Cy,{port:d,data:e.data},d.id))]})}function Py(e){return n.jsx(K,{"data-likec4-color":e.data.color,css:{width:"100%",height:"100%",border:"default",rounded:"sm",borderWidth:1,"--_color":{base:"var(--likec4-palette-stroke)",_dark:"[color-mix(in srgb, var(--likec4-palette-hiContrast) 40%, var(--likec4-palette-fill))]"},borderColor:"[var(--_color)/30]",backgroundColor:"var(--likec4-palette-fill)/15",pointerEvents:"none",paddingLeft:"2",paddingTop:"0.5",fontSize:"xs",fontWeight:"bold",letterSpacing:".75px",color:"[var(--_color)/75]"},children:"PARALLEL"})}const Fo="--_blur",Vo="--_opacity",My="--_level",bn=g.forwardRef(({onClose:e,className:t,classes:o,overlayLevel:a=0,children:i,fullscreen:s=!1,withBackdrop:l=!0,backdrop:r,openDelay:d=130,...u},c)=>{const[p,h]=g.useState(d===0),f=Xc(p),x=g.useRef(null),w=g.useRef(!1),C=Jr()!==!0,v=g.useRef(e);v.current=e;const k=oi(()=>{w.current||(w.current=!0,v.current())},[],50);g.useLayoutEffect(()=>{x.current?.open||x.current?.showModal()},[]),sn(()=>{h(!0)},d>0?d:void 0);const _=zm({fullscreen:s,withBackdrop:l});let m=a>0?"50%":"60%";return r?.opacity!==void 0&&(m=`${r.opacity*100}%`),n.jsx(De.dialog,{ref:ni(x,f,c),className:P(o?.dialog,t,_,s&&rn.classNames.fullWidth),layout:!0,style:{[My]:a},...C?{initial:{[Fo]:"0px",[Vo]:"0%",scale:.95,originY:0,translateY:-20,opacity:0},animate:{[Fo]:a>0?"4px":"8px",[Vo]:m,scale:1,opacity:1,translateY:0,transition:{delay:.075}},exit:{opacity:0,scale:.98,translateY:-20,transition:{duration:.1},[Fo]:"0px",[Vo]:"0%"}}:{initial:{[Fo]:"8px",[Vo]:m}},onClick:b=>{if(b.stopPropagation(),b.target?.nodeName?.toUpperCase()==="DIALOG"){x.current?.close();return}},onCancel:b=>{b.preventDefault(),b.stopPropagation(),k()},onDoubleClick:ie,onPointerDown:ie,onClose:b=>{b.stopPropagation(),k()},...u,children:n.jsx(rn,{forwardProps:!0,children:n.jsx("div",{className:P(o?.body,"likec4-overlay-body"),children:p&&n.jsx(n.Fragment,{children:i})})})})});bn.displayName="Overlay";function Ny({children:e}){const t=g.useContext(Ti);if(!t)throw new Error("PortalToContainer must be used within RootContainer");return n.jsx(hl,{target:t.ref.current??`#${t.id}`,children:e})}const Iy=g.memo(e=>{const{projects:t,onProjectChange:o}=ey(),a=ty();return t.length<=1?null:n.jsxs(oe,{gap:"0.5",alignItems:"baseline",children:[n.jsx(K,{css:{fontWeight:"400",fontSize:"xxs",color:"likec4.panel.text.dimmed",userSelect:"none"},children:"Project"}),n.jsxs(Te,{withinPortal:!1,shadow:"md",position:"bottom-start",offset:{mainAxis:2},children:[n.jsx(el,{children:n.jsx(ke,{tabIndex:-1,autoFocus:!1,variant:"subtle",size:"compact-xs",color:"gray",classNames:{root:y({fontWeight:"400",fontSize:"xxs",height:"auto",lineHeight:1.1,color:{_light:"mantine.colors.gray[9]"}}),section:y({'&:is([data-position="right"])':{marginInlineStart:"1"}})},rightSection:n.jsx(Mi,{opacity:.5,size:12,stroke:1.5}),children:a})}),n.jsx(tl,{children:t.map(({id:i,title:s})=>n.jsx(ol,{onClick:l=>{if(a===i){l.stopPropagation();return}o(i)},children:s??i},i))})]})]})}),Gd=nl({siblingSelector:"[data-likec4-focusable]",parentSelector:"[data-likec4-breadcrumbs-dropdown]",activateOnFocus:!1,loop:!0,orientation:"vertical"});function Ey(e){return e.context.searchQuery.trim().length>=2}const Zd=g.memo(()=>{const e=Co(),t=Yi(Ey);Me("paneClick",()=>{e.closeDropdown()}),Me("nodeClick",()=>{e.closeDropdown()}),Me("edgeClick",()=>{e.closeDropdown()});const o=Yc(a=>{e.send({type:"searchQuery.change",value:a})},250);return n.jsxs(Zt,{className:P("nowheel",ko({layerStyle:"likec4.dropdown",gap:"xs",pointerEvents:"all"})),"data-likec4-breadcrumbs-dropdown":!0,onMouseLeave:()=>e.send({type:"dropdown.mouseLeave"}),onMouseEnter:()=>e.send({type:"dropdown.mouseEnter"}),children:[n.jsx(Iy,{}),n.jsx(oe,{gap:"xs",children:n.jsx(Oy,{defaultValue:e.actorRef.getSnapshot().context.searchQuery,onChange:o})}),n.jsx(We,{scrollbars:"x",type:"auto",offsetScrollbars:"present",classNames:{root:y({maxWidth:["calc(100vw - 50px)","calc(100cqw - 50px)"]})},styles:{viewport:{overscrollBehavior:"none"}},children:t?n.jsx(By,{}):n.jsx(Fy,{})})]})});Zd.displayName="NavigationPanelDropdown";function Ry(e){return Ml(e.context.searchQuery)}const Dy=rp(La),By=g.memo(()=>{const e=je(),t=Co(),o=ne(t.actorRef,Ry),a=g.useDeferredValue(o),i=a.includes(La),s=i?a.split(La):a,[l,r]=g.useState([]);return g.useEffect(()=>{r(d=>{const u=ce(e.views(),Sl(c=>i&&c.$view.title?Ml(c.$view.title).toLowerCase().includes(a):c.id.toLowerCase().includes(a)||!!c.title?.toLowerCase().includes(a)),ap(20),Ta(),qc((c,p)=>Dy(c.folder.path,p.folder.path)));return ee(u,d)?d:u})},[e,a,i]),l.length===0?n.jsx("div",{children:"no results"}):n.jsx(We,{scrollbars:"xy",offsetScrollbars:!1,className:y({width:"100%",maxWidth:["calc(100vw - 250px)","calc(100cqw - 250px)"],maxHeight:["calc(100vh - 200px)","calc(100cqh - 200px)"]}),children:n.jsx(Et,{gap:"0.5",children:l.map(d=>n.jsx(Ty,{view:d,highlight:s,onClick:u=>{u.stopPropagation(),t.selectView(d.id)},"data-likec4-focusable":!0,onKeyDown:Gd},d.id))})})}),Ly=pe({gap:"xxs",rounded:"sm",px:"xs",py:"xxs",_hover:{backgroundColor:{base:"mantine.colors.gray[1]",_dark:"mantine.colors.dark[5]"}},_focus:{outline:"none",color:"mantine.colors.primary.lightColor!",backgroundColor:"mantine.colors.primary.lightHover!"}}),hr=y({_groupFocus:{color:"[inherit!]",transition:"none"}});function Ty({view:e,highlight:t,...o}){const a=e.folder,i=Ud[e.id==="index"?"index":e._type],s=n.jsx(kt,{component:"div",className:P(hr,yn({truncate:!0}),y({"& > mark":{backgroundColor:{base:"mantine.colors.yellow[2]/90",_dark:"mantine.colors.yellow[5]/80",_groupFocus:"[transparent]"},color:{_groupFocus:"[inherit!]"}}})),maw:350,highlight:t,children:e.title??e.id},e.id),l=P(o.className,"group",Ly);if(a.isRoot)return n.jsxs(se,{...o,className:l,children:[i,s]});const r=a.breadcrumbs.map(d=>n.jsx(kt,{component:"div",className:P(y({_groupHover:{color:"mantine.colors.dimmed"}}),hr,yn({dimmed:!0,truncate:!0})),maw:170,highlight:Na(t)?t:[],children:d.title},d.path));return r.push(n.jsxs(oe,{gap:"[4px]",children:[i,s]})),n.jsxs(se,{...o,className:l,children:[Kd,n.jsx(Kr,{separator:n.jsx(mt,{size:12,stroke:1.5}),separatorMargin:3,children:r})]})}const Ay=n.jsx(mt,{size:12,stroke:1.5,className:"mantine-rotate-rtl"}),Kd=n.jsx(yh,{size:16,className:y({opacity:{base:.3,_groupHover:.5,_groupActive:.5,_groupFocus:.5}})}),Wo=y({opacity:{base:.3,_dark:.5,_groupHover:.8,_groupActive:.8,_groupFocus:.8}}),Ud={index:n.jsx(Ph,{size:16,className:Wo}),element:n.jsx(Le,{size:18,stroke:2,className:Wo}),deployment:n.jsx(Di,{size:16,stroke:1.5,className:Wo}),dynamic:n.jsx(mh,{size:18,className:Wo})},zy=We.withProps({scrollbars:"y",className:y({maxHeight:["calc(100vh - 160px)","calc(100cqh - 160px)"]})});function mr(e,t){return{folderPath:e.path,items:[...e.folders.map(o=>({type:"folder",folderPath:o.path,title:o.title,selected:t.selectedFolder.startsWith(o.path)})),...e.views.map(o=>({type:"view",viewType:o.id==="index"?"index":o._type,viewId:o.id,title:o.title??o.id,description:o.description.nonEmpty&&o.description.text||null,selected:o.id===t.viewModel?.id}))]}}const $y=e=>{const t=e.viewModel;if(!t)return[];const o=t.$model,a=[mr(o.rootViewFolder,e)],i=o.viewFolder(e.selectedFolder);if(!i.isRoot)for(const s of i.breadcrumbs)a.push(mr(s,e));return a},Fy=g.memo(()=>{const e=uf($y,I);return n.jsx(oe,{gap:"xs",alignItems:"stretch",children:e.flatMap((t,o)=>[o>0&&n.jsx(yo,{orientation:"vertical"},"divider"+o),n.jsx(Vy,{data:t,isLast:o>0&&o==e.length-1},t.folderPath)])})});function Vy({data:e,isLast:t}){const o=g.useRef(null),a=Xi(),i=s=>l=>{l.stopPropagation(),s.type==="folder"?a.send({type:"select.folder",folderPath:s.folderPath}):a.send({type:"select.view",viewId:s.viewId})};return Gc(()=>{t&&o.current&&o.current.scrollIntoView({block:"nearest",inline:"nearest",behavior:"smooth"})}),n.jsx(K,{mb:"1",ref:o,children:n.jsx(zy,{children:n.jsx(Et,{gap:"0.5",children:e.items.map((s,l)=>n.jsx(Wy,{columnItem:s,onClick:i(s)},`${e.folderPath}/${s.type}/${l}`))})})})}function Wy({columnItem:e,...t}){switch(e.type){case"folder":return n.jsx(Ya,{variant:"light",active:e.selected,label:e.title,leftSection:Kd,rightSection:Ay,maw:"300px",miw:"200px",...t},e.folderPath);case"view":return n.jsx(Ya,{variant:"filled",active:e.selected,label:e.title,description:e.description,leftSection:Ud[e.viewType],maw:"300px",miw:"200px",...t},e.viewId);default:it(e)}}function Oy(e){const[t,o]=Ur({...e,finalValue:""});return n.jsx(Ia,{size:"xs",placeholder:"Search by title or id",variant:"unstyled",height:Je(26),value:t,onKeyDown:Gd,onChange:a=>o(a.currentTarget.value),"data-likec4-focusable":!0,classNames:{wrapper:y({flexGrow:1,backgroundColor:{base:"mantine.colors.gray[1]",_dark:"mantine.colors.dark[5]/80",_hover:{base:"mantine.colors.gray[2]",_dark:"mantine.colors.dark[4]"},_focus:{base:"mantine.colors.gray[2]",_dark:"mantine.colors.dark[4]"}},rounded:"sm"}),input:y({_placeholder:{color:"mantine.colors.dimmed"},_focus:{outline:"none"}})},style:{"--input-fz":"var(--mantine-font-size-sm)"},leftSection:n.jsx(Ei,{size:14}),rightSectionPointerEvents:"all",rightSectionWidth:"min-content",rightSection:!e.value||Ct(e.value)?null:n.jsx(ke,{variant:"subtle",h:"100%",size:"compact-xs",color:"gray",onClick:a=>{a.stopPropagation(),o("")},children:"clear"})})}const Hy=ft("div",{base:{fontSize:"xs",color:"mantine.colors.dimmed",fontWeight:500,userSelect:"none",mb:"xxs"}});function Xy(e){const t=vu(e.activeWalkthrough),o=t?e.xyedges.findIndex(a=>a.id===e.activeWalkthrough?.stepId):-1;return{isActive:t,isParallel:t&&Se(e.activeWalkthrough?.parallelPrefix),hasNext:t&&o<e.xyedges.length-1,hasPrevious:t&&o>0,notes:t?e.xyedges[o]?.data?.notes??Ge.EMPTY:null}}const Yy=g.memo(()=>{const{isActive:e,notes:t}=Ve(Xy);return n.jsx(ue,{children:e&&t&&!t.isEmpty&&n.jsx(De.div,{layout:"position",className:y({position:"relative"}),initial:{opacity:0,translateX:-20},animate:{opacity:1,translateX:0},exit:{opacity:0,translateX:-20},children:n.jsxs(We,{className:ko({position:"absolute",layerStyle:"likec4.dropdown",gap:"sm",padding:"md",paddingTop:"xxs",pointerEvents:"all",maxWidth:"calc(100cqw - 32px)",minWidth:"calc(100cqw - 50px)",maxHeight:"calc(100cqh - 100px)",width:"max-content",cursor:"default",overflow:"auto",overscrollBehavior:"contain","@/sm":{minWidth:400,maxWidth:550},"@/lg":{maxWidth:700}}),type:"scroll",children:[n.jsx(Hy,{children:"Notes"}),n.jsx(Mt,{value:t,fontSize:"sm",emptyText:"No description",className:y({userSelect:"all"})})]})})})}),Qd=g.memo(()=>{const e=Rt(),t=Pm(),o=Mm(),a=ii(Em,{input:{view:t,viewModel:o}});return g.useEffect(()=>{const i=a.on("navigateTo",s=>{e.getSnapshot().context.view.id!==s.viewId&&e.send({type:"navigate.to",viewId:s.viewId})});return()=>i.unsubscribe()},[a,e]),al(()=>{a.send({type:"update.inputs",inputs:{viewModel:o,view:t}})},[o,t]),n.jsx(Et,{css:{alignItems:"flex-start",pointerEvents:"none",position:"absolute",top:"0",left:"0",margin:"0",width:"100%",gap:"xxs",maxWidth:["calc(100vw)","calc(100cqw)"],"@/sm":{margin:"xs",gap:"xs",width:"max-content",maxWidth:["calc(100vw - 2 * {spacing.md})","calc(100cqw - 2 * {spacing.md})"]}},children:n.jsxs(cf,{value:a,children:[n.jsx(qy,{actor:a}),n.jsx(jd,{}),n.jsx(Yy,{}),n.jsx(df,{})]})})});Qd.displayName="NavigationPanel";const qy=({actor:e})=>{const t=ne(e,a=>a.hasTag("active")),o=Jt();return n.jsxs(nt,{offset:{mainAxis:4},opened:t,position:"bottom-start",trapFocus:!0,...o,clickOutsideEvents:["pointerdown","mousedown","click"],onDismiss:()=>e.send({type:"dropdown.dismiss"}),children:[n.jsx(Gy,{actor:e}),t&&n.jsx(Zd,{})]})},Gy=({actor:e})=>{const t=Ve(o=>o.activeWalkthrough!==null);return n.jsx(Xt,{children:n.jsx(Gt,{children:n.jsx(Q,{layout:!0,className:pe({layerStyle:"likec4.panel",position:"relative",gap:"xs",cursor:"pointer",pointerEvents:"all",width:"100%"}),onMouseLeave:()=>e.send({type:"breadcrumbs.mouseLeave"}),children:n.jsx(ue,{mode:"popLayout",children:t?n.jsx(sy,{}):n.jsx(Fd,{})})})})})},Ui=g.createContext(null);Ui.displayName="ElementDetailsActorContext";const Zy=()=>{const e=g.useContext(Ui);if(e===null)throw new Error("ElementDetailsActorRef is not provided");return e},on="--_blur",nn="--_opacity",Ky=y({boxSizing:"border-box",margin:"0",padding:"0",position:"fixed",inset:"0",width:"100vw",height:"100vh",maxWidth:"100vw",maxHeight:"100vh",background:"transparent",border:"transparent",_backdrop:{backdropFilter:"auto",backdropBlur:`var(${on})`,backgroundColor:`[rgb(36 36 36 / var(${nn}, 5%))]`}}),Uy=y({position:"absolute",pointerEvents:"all",display:"flex",flexDirection:"column",padding:"4",gap:"lg",justifyContent:"stretch",color:"mantine.colors.text",backgroundColor:{base:"mantine.colors.body",_dark:"mantine.colors.dark[6]"},boxShadow:"md",overflow:"hidden",border:"none",backgroundImage:`
    linear-gradient(180deg,
      color-mix(in srgb, var(--likec4-palette-fill) 60%, transparent),
      color-mix(in srgb, var(--likec4-palette-fill) 20%, transparent) 8px,
      color-mix(in srgb, var(--likec4-palette-fill) 14%, transparent) 20px,
      transparent 80px
    ),
    linear-gradient(180deg, var(--likec4-palette-fill), var(--likec4-palette-fill) 4px, transparent 4px)
  `,"& .react-flow__attribution":{display:"none"}}),Qy=y({flex:0,cursor:"move"}),Jy=y({display:"block",fontFamily:"likec4.element",fontOpticalSizing:"auto",fontStyle:"normal",fontWeight:600,fontSize:"24px",lineHeight:"xs"}),xa="40px",ex=y({flex:`0 0 ${xa}`,height:xa,width:xa,display:"flex",alignItems:"center",justifyContent:"center",alignSelf:"flex-start",cursor:"move",_dark:{mixBlendMode:"hard-light"},"& :where(svg, img)":{width:"100%",height:"auto",maxHeight:"100%",pointerEvents:"none",filter:`
    drop-shadow(0 0 3px rgb(0 0 0 / 10%))
    drop-shadow(0 1px 8px rgb(0 0 0 / 5%))
    drop-shadow(1px 1px 16px rgb(0 0 0 / 2%))
  `},"& img":{objectFit:"contain"}}),an="--view-title-color",Oo="--icon-color",tx=y({width:"100%",background:"mantine.colors.body",borderRadius:"sm",padding:"[10px 8px]",transition:"fast",border:"1px dashed",borderColor:"mantine.colors.defaultBorder",[an]:"{colors.mantine.colors.dark[1]}",_hover:{background:"mantine.colors.defaultHover",[Oo]:"{colors.mantine.colors.dark[1]}",[an]:"{colors.mantine.colors.defaultColor}"},_dark:{background:"mantine.colors.dark[6]"},_light:{[Oo]:"{colors.mantine.colors.gray[6]}",[an]:"{colors.mantine.colors.gray[7]}",_hover:{[Oo]:"{colors.mantine.colors.gray[7]}"}},"& .mantine-ThemeIcon-root":{transition:"fast",color:`[var(${Oo}, {colors.mantine.colors.dark[2]})]`,"--ti-size":"22px",_hover:{color:"mantine.colors.defaultColor"}},"& > *":{transition:"all 130ms {easings.inOut}"},"&:hover > *":{transitionTimingFunction:"out",transform:"translateX(1.6px)"}}),ox=y({transition:"fast",color:`[var(${an}, {colors.mantine.colors.gray[7]})]`,fontSize:"15px",fontWeight:500,lineHeight:"1.4"}),nx=y({flex:1,display:"flex",flexDirection:"column",justifyContent:"stretch",overflow:"hidden",gap:"sm"}),ax=y({background:"mantine.colors.gray[1]",borderRadius:"sm",flexWrap:"nowrap",gap:"1.5",padding:"1",_dark:{background:"mantine.colors.dark[7]"}}),ix=y({fontSize:"xs",fontWeight:500,flexGrow:1,padding:"[6px 8px]",transition:"fast",borderRadius:"sm",color:"mantine.colors.gray[7]",_hover:{transitionTimingFunction:"out",color:"mantine.colors.defaultColor",background:"mantine.colors.gray[3]"},"&[data-active]":{transition:"none",background:"mantine.colors.white",shadow:"xs",color:"mantine.colors.defaultColor"},_dark:{color:"mantine.colors.dark[1]",_hover:{color:"mantine.colors.white",background:"mantine.colors.dark[6]"},"&:is([data-active])":{color:"mantine.colors.white",background:"mantine.colors.dark[5]"}}}),sx=y({flex:1,overflow:"hidden",position:"relative","&:not(:has(.mantine-ScrollArea-root))":{paddingLeft:"1",paddingRight:"1"},"& .mantine-ScrollArea-root":{width:"100%",height:"100%","& > div":{paddingLeft:"1",paddingRight:"1"}}}),rx=y({flex:1,display:"grid",gridTemplateColumns:"min-content 1fr",gridAutoRows:"min-content max-content",gap:"[24px 20px]",alignItems:"baseline",justifyItems:"stretch"}),lx=y({justifySelf:"end",textAlign:"right",userSelect:"none"}),dx=y({position:"absolute",width:"14px",height:"14px",border:"3.5px solid",borderColor:"mantine.colors.dark[3]",borderTop:"none",borderLeft:"none",borderRadius:"2px",bottom:"0.5",right:"0.5",transition:"fast",cursor:"se-resize",_hover:{borderWidth:"4px",borderColor:"mantine.colors.dark[1]"}});function Jd({children:e}){return n.jsx(n.Fragment,{children:e})}function ec({value:e,isExpanded:t}){const[o,a]=g.useState(!1),i=g.useRef(null);return g.useEffect(()=>{i.current&&a(i.current.scrollWidth>i.current.clientWidth)},[e]),n.jsx(_e,{label:o&&!t?e:null,multiline:!0,w:300,withinPortal:!0,children:n.jsx(L,{ref:i,component:"div",className:y({fontSize:"sm",padding:"xs",userSelect:"all",color:"mantine.colors.text",lineHeight:1.4,whiteSpace:t?"pre-wrap":"nowrap",overflow:t?"visible":"hidden",textOverflow:t?"unset":"ellipsis",wordBreak:t?"break-word":"normal",minWidth:0,width:"100%"}),children:e})})}function cx({values:e,isExpanded:t,onToggle:o}){return t?n.jsx(Ne,{gap:"xs",children:e.map((a,i)=>n.jsxs(_t,{align:"center",gap:"xs",children:[n.jsx(L,{className:y({fontSize:"xs",color:"mantine.colors.gray[5]",fontWeight:500,flexShrink:0,_dark:{color:"mantine.colors.dark[3]"}}),children:""}),n.jsx(X,{className:y({minHeight:"32px",display:"flex",alignItems:"center",flex:1}),children:n.jsx(ec,{value:a,isExpanded:!0})})]},i))}):n.jsx(X,{className:y({minHeight:"32px",display:"flex",alignItems:"center",padding:"xs",gap:"xs",flexWrap:"wrap",minWidth:0,overflow:"hidden"}),children:e.map((a,i)=>n.jsxs(_t,{align:"center",gap:"xs",style:{minWidth:0},children:[n.jsx(L,{className:y({fontSize:"sm",padding:"[4px 8px]",backgroundColor:"mantine.colors.white",color:"mantine.colors.text",borderRadius:"sm",border:"1px solid",borderColor:"mantine.colors.gray[3]",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"min(200px, 100%)",minWidth:"60px",flex:"0 1 auto",userSelect:"all",_dark:{backgroundColor:"mantine.colors.dark[9]",color:"mantine.colors.text",borderColor:"mantine.colors.dark[4]"}}),title:a,children:a}),i<e.length-1&&n.jsx(L,{className:y({fontSize:"xs",color:"mantine.colors.gray[5]",fontWeight:500,flexShrink:0,_dark:{color:"mantine.colors.dark[3]"}}),children:""})]},i))})}function ux({label:e,value:t}){const o=Array.isArray(t)?t:typeof t=="string"&&t.includes(`
`)?t.split(`
`).map(r=>r.trim()).filter(Boolean):[t],a=o.length>1,[i,s]=g.useState(!1),l=()=>{s(!i)};return n.jsxs(n.Fragment,{children:[a?n.jsx(se,{onClick:l,className:y({fontSize:"xs",color:"mantine.colors.dimmed",justifySelf:"end",textAlign:"right",userSelect:"none",display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"xs",padding:"[4px 8px]",borderRadius:"sm",whiteSpace:"nowrap",transition:"all 150ms ease",_hover:{backgroundColor:"mantine.colors.gray[1]",color:"mantine.colors.primary[6]",_dark:{backgroundColor:"mantine.colors.dark[7]",color:"mantine.colors.primary[4]"}}}),children:n.jsxs(_t,{align:"center",gap:"xs",children:[n.jsxs(L,{component:"span",size:"xs",fw:700,children:[e,":"]}),n.jsx(L,{component:"span",className:y({fontSize:"xs",fontWeight:500,color:"mantine.colors.gray[6]",backgroundColor:"mantine.colors.gray[1]",padding:"[1px 4px]",borderRadius:"xs",_dark:{color:"mantine.colors.dark[2]",backgroundColor:"mantine.colors.dark[6]"}}),children:o.length}),i?n.jsx(Mi,{size:12}):n.jsx(mt,{size:12})]})}):n.jsxs(L,{component:"div",className:y({fontSize:"xs",color:"mantine.colors.dimmed",justifySelf:"end",textAlign:"right",userSelect:"none",whiteSpace:"nowrap",padding:"[4px 8px]",fontWeight:700}),children:[e,":"]}),n.jsx(X,{className:y({justifySelf:"stretch",alignSelf:"start"}),children:a?n.jsx(cx,{values:o,isExpanded:i,onToggle:l}):n.jsx(X,{className:y({minHeight:"32px",display:"flex",alignItems:"center"}),children:n.jsx(ec,{value:o[0]||"",isExpanded:i})})})]})}const px=y({"&[data-level='1']":{marginBottom:"sm"}}),gx=y({cursor:"default",marginTop:"0",marginBottom:"0"}),tc=y({transition:"fast",color:"mantine.colors.gray[7]",_dark:{color:"mantine.colors.dark[1]"},"& > *":{transition:"fast"},_hover:{transitionTimingFunction:"out","& > :not([data-no-transform])":{transitionTimingFunction:"out",transform:"translateX(1px)"}}}),hx=P(tc),mx=P(tc,y({cursor:"pointer",width:"100%",justifyContent:"stretch",flexWrap:"nowrap",height:"36px",paddingInlineStart:"[16px]",paddingInlineEnd:"2.5",borderRadius:"sm",alignItems:"center",color:"mantine.colors.gray[7]",_dark:{color:"mantine.colors.gray.lightColor"},_hover:{background:"mantine.colors.gray.lightHover"},"& .tabler-icon":{transition:"fast",width:"90%",opacity:.65}})),fx=({node:e})=>n.jsxs(re,{className:hx,gap:6,align:"baseline",wrap:"nowrap",children:[n.jsxs(L,{component:"div",fz:11,c:"dimmed",children:[e.kind,":"]}),n.jsx(L,{component:"div",fz:"sm",fw:"500",children:e.title})]}),yx=({instance:e})=>{const t=H(),o=t.currentView.id,a=[...e.views()];return n.jsxs(re,{className:mx,gap:4,children:[n.jsx($e,{color:"gray",variant:"transparent",size:"xs",flex:0,children:n.jsx(lh,{stroke:1.2})}),n.jsx(L,{component:"div",fz:"sm",fw:"500",flex:"1 1 100%",children:e.title}),n.jsxs(X,{onClick:ie,pos:"relative","data-no-transform":!0,flex:0,children:[a.length===0&&n.jsx(ke,{size:"compact-xs",variant:"transparent",color:"gray",disabled:!0,children:"no views"}),a.length>0&&n.jsxs(Te,{shadow:"md",withinPortal:!1,position:"bottom-start",offset:0,closeOnClickOutside:!0,clickOutsideEvents:["pointerdown","mousedown","click"],closeOnEscape:!0,trapFocus:!0,children:[n.jsx(Te.Target,{children:n.jsxs(ke,{size:"compact-xs",variant:"subtle",color:"gray",children:[a.length," view",a.length>1?"s":""]})}),n.jsx(Te.Dropdown,{children:a.map(i=>n.jsx(Te.Item,{px:"xs",py:4,disabled:i.id===o,leftSection:n.jsx($e,{size:"sm",variant:"transparent",color:"gray",children:n.jsx(Le,{stroke:1.8,opacity:.65})}),styles:{itemSection:{marginInlineEnd:Je(8)}},onClick:s=>{s.stopPropagation(),t.navigateTo(i.id)},children:i.title},i.id))})]})]})]})},xx=()=>{},bx=g.memo(({elementFqn:e})=>{const t=je().element(e),o=[...t.deployments()],a=In({multiple:!1});a.setHoveredNode=xx;const i=g.useMemo(()=>{let s=[],l=new Map;for(const r of t.deployments()){let d={label:n.jsx(yx,{instance:r}),value:r.id,type:"instance",children:[]};l.set(r.id,d);let u=r.parent;for(;u;){let c=l.get(u.id);if(c){c.children.push(d);break}c={label:n.jsx(fx,{node:u}),value:u.id,type:"node",children:[d]},l.set(u.id,c),d=c,u=u.parent}!u&&!s.includes(d)&&s.push(d)}return s},[t]);return g.useEffect(()=>{a.expandAllNodes()},[i]),o.length===0?n.jsx(il,{variant:"light",color:"gray",icon:n.jsx(Ii,{}),children:"This element does not have any deployments"}):n.jsx(En,{levelOffset:"sm",allowRangeSelection:!1,classNames:{node:px,label:gx},styles:{root:{position:"relative",width:"min-content",minWidth:300}},data:i,tree:a,renderNode:({node:s,selected:l,elementProps:r,hasChildren:d})=>n.jsx(X,{...r,style:{...!d&&{marginBottom:Je(4)}},children:d?n.jsx(ke,{fullWidth:!0,color:"gray",variant:l?"transparent":"subtle",size:"xs",justify:"flex-start",styles:{root:{position:"unset",paddingInlineStart:Je(16)}},children:s.label}):s.label})})}),oc=g.createContext(null);function nc(){return W(g.useContext(oc),"No RelationshipsBrowserActorContext")}function Jn(e,t=ee){const o=nc();return ne(o,e,t)}function Ro(){const e=nc();return g.useMemo(()=>({actor:e,get rootElementId(){return`relationships-browser-${e.sessionId.replaceAll(":","_")}`},getState:()=>e.getSnapshot().context,send:e.send,updateView:t=>{e.getSnapshot().status==="active"&&e.send({type:"update.view",layouted:t})},changeScope:t=>{e.send({type:"change.scope",scope:t})},navigateTo:(t,o)=>{e.send({type:"navigate.to",subject:t,fromNode:o})},fitDiagram:()=>{e.send({type:"fitDiagram"})},close:()=>{e._parent?e._parent?.send({type:"close",actorId:e.id}):e.send({type:"close"})}}),[e])}const wx=Gi(e=>{const t=Ro(),{enableNavigateTo:o}=Z(),{data:{navigateTo:a,relations:i,existsInCurrentView:s}}=e,[l,r,d]=gl(e),u=H(),c=i.length>1||!s,p=c?{...e,data:{...e.data,line:"solid",color:"amber"}}:e;let h=n.jsx(Mo,{edgeProps:p,className:y({transition:"fast"}),children:o&&a&&n.jsx(Hn,{...e,onClick:f=>{f.stopPropagation(),u.navigateTo(a)}})});return s||(h=n.jsx(_e,{color:"orange",c:"black",label:"This relationship is not included in the current view",portalProps:{target:`#${t.rootElementId}`},openDelay:800,children:h})),n.jsxs(Po,{...p,children:[n.jsx(No,{edgeProps:p,svgPath:l,...c&&{strokeWidth:5}}),n.jsx(Xn,{edgeProps:p,labelPosition:{x:r,y:d,translate:"translate(-50%, 0)"},style:{maxWidth:Math.min(Math.abs(e.targetX-e.sourceX-70),250)},children:h})]})}),vx=y({width:"100%",height:"100%",border:"3px dashed",borderColor:"mantine.colors.defaultBorder",borderRadius:"md",display:"flex",justifyContent:"center",alignItems:"center"});function kx({data:{column:e}}){return n.jsx(X,{className:vx,children:n.jsxs(L,{c:"dimmed",fz:"lg",fw:500,children:["No ",e==="incomers"?"incoming":"outgoing"]})})}const jx=e=>e.context.subject,Cx=e=>{const{enableNavigateTo:t,enableVscode:o}=Z(),a=H(),i=Wn(),s=Ro(),l=Jn(jx),{navigateTo:r,fqn:d}=e.data,u=g.useMemo(()=>{const c=[];return r&&t&&i!==r&&c.push({key:"navigate",icon:n.jsx(Le,{}),onClick:p=>{p.stopPropagation(),a.navigateTo(r)}}),d!==l&&c.push({key:"relationships",icon:n.jsx(vo,{}),onClick:p=>{p.stopPropagation(),s.navigateTo(d,e.id)}}),o&&c.push({key:"goToSource",icon:n.jsx(Kt,{}),onClick:p=>{p.stopPropagation(),a.openSource({element:d})}}),c},[r,t,i,d,l,o,a,s,e.id]);return n.jsx(Yn,{buttons:u,...e})},Sx=e=>{const t=H();return n.jsx(qi,{...e,onClick:o=>{o.stopPropagation(),t.openElementDetails(e.data.fqn)}})};function _x(e){const{enableElementTags:t}=Z();return n.jsxs(eo,{layoutId:e.id,nodeProps:e,children:[n.jsx(to,{...e}),n.jsx(He,{...e}),t&&n.jsx(Io,{...e}),n.jsx(Sx,{...e}),n.jsx(Cx,{...e}),n.jsx(Mx,{...e})]},e.id)}function Px(e){const t=H();return n.jsxs(So,{layoutId:e.id,nodeProps:e,children:[n.jsx(_o,{...e}),n.jsx(_d,{...e,onClick:o=>{o.stopPropagation(),t.openElementDetails(e.data.fqn)}}),n.jsx(Nx,{...e})]},e.id)}const Mx=({data:{ports:e,height:t}})=>n.jsxs(n.Fragment,{children:[e.in.map((o,a)=>n.jsx(Pe,{id:o,type:"target",position:ge.Left,style:{visibility:"hidden",top:`${15+(a+1)*((t-30)/(e.in.length+1))}px`}},o)),e.out.map((o,a)=>n.jsx(Pe,{id:o,type:"source",position:ge.Right,style:{visibility:"hidden",top:`${15+(a+1)*((t-30)/(e.out.length+1))}px`}},o))]}),Nx=({data:e})=>n.jsxs(n.Fragment,{children:[e.ports.in.map((t,o)=>n.jsx(Pe,{id:t,type:"target",position:ge.Left,style:{visibility:"hidden",top:`${20*(o+1)}px`}},t)),e.ports.out.map((t,o)=>n.jsx(Pe,{id:t,type:"source",position:ge.Right,style:{visibility:"hidden",top:`${20*(o+1)}px`}},t))]}),me={dagre:{ranksep:60,nodesep:35,edgesep:25},edgeLabel:{width:140,height:10,minlen:1,weight:1},emptyNodeOffset:120,nodeWidth:330,nodeHeight:180,compound:{labelHeight:2,paddingTop:50,paddingBottom:32}};function Ix(){const e=new An.graphlib.Graph({directed:!0,compound:!0,multigraph:!0});return e.setGraph({...me.dagre,rankdir:"LR"}),e.setDefaultEdgeLabel(()=>({...me.edgeLabel})),e.setDefaultNodeLabel(()=>({})),e}const qa="-port";function ba(e,t,o){const a=new hn(s=>({id:`${e}-${s}`,portId:`${e}-${s}`})),i=ki(t);for(const s of i.sorted){const l=i.children(s).length>0,r=s.id,d=`${e}-${r}`,u=l?`${d}${qa}`:d;a.set(r,{id:d,portId:u}),o.setNode(d,{column:e,element:s,isCompound:l,portId:u,inPorts:[],outPorts:[],width:me.nodeWidth,height:me.nodeHeight}),l&&(o.setNode(u,{element:s,portId:u,isCompound:l,inPorts:[],outPorts:[],width:me.nodeWidth-me.dagre.ranksep,height:me.compound.labelHeight}),o.setParent(u,d));const c=i.parent(s);c&&o.setParent(d,`${e}-${c.id}`)}return{...i,byId:s=>{const l=i.byId(s),r=a.get(l.id);return{element:l,graph:r}},graphNodes:a}}function Ex(e){return An.layout(e,{}),t=>{const o=e.node(t),{x:a,y:i,width:s,height:l}=o;return{position:{x:a-Math.round(s/2),y:i-Math.round(l/2)},width:s,height:l}}}var wn;(e=>{e.Empty="@empty"})(wn||(wn={}));function Rx(e,t){const o=Ix(),a=ba("incomers",e.incomers,o),i=ba("subjects",e.subjects,o),s=ba("outgoers",e.outgoers,o),l=[];ce(Su(ce(Ta(e.incoming),ae(m=>({id:m.source.id,sourceFqn:m.source.id,targetFqn:m.target.id,source:a.byId(m.source.id).graph,target:i.byId(m.target.id).graph,relation:m}))),ce(Ta(e.outgoing),ae(m=>({id:m.target.id,sourceFqn:m.source.id,targetFqn:m.target.id,source:i.byId(m.source.id).graph,target:s.byId(m.target.id).graph,relation:m})))),ae(m=>({...m,expr:`${m.source.id}->${m.target.id}`})),Cu(wt("expr")),ju(m=>{const b=m[0].source,j=m[0].target,S=m[0].expr;o.node(b.id).outPorts.push(j.id),o.node(j.id).inPorts.push(b.id),o.setEdge(b.portId,j.portId,{...me.edgeLabel},S),l.push({name:S,sourceFqn:m[0].sourceFqn,targetFqn:m[0].targetFqn,source:b.id,sourceHandle:b.id+"_out"+(o.node(b.id).outPorts.length-1),target:j.id,targetHandle:j.id+"_in"+(o.node(j.id).inPorts.length-1),relations:ae(m,wt("relation"))})}));for(const m of i.graphNodes.values()){const b=m.id,j=o.node(b);if(j.isCompound)continue;const S=Math.max(o.inEdges(b)?.length??0,o.outEdges(b)?.length??0);S>2&&(j.height=j.height+(S-3)*14)}const r=[...a.graphNodes.values(),...i.graphNodes.values(),...s.graphNodes.values()];if(a.graphNodes.size==0){const m="incomers-empty";o.setNode(m,{column:"incomers",element:null,isCompound:!1,portId:m,inPorts:[],outPorts:[],width:me.nodeWidth,height:me.nodeHeight});for(const b of i.graphNodes.values())o.setEdge(m,b.portId);r.push({id:m,portId:m})}if(s.graphNodes.size==0){const m="outgoers-empty";o.setNode(m,{column:"outgoers",element:null,isCompound:!1,portId:m,inPorts:[],outPorts:[],width:me.nodeWidth,height:me.nodeHeight});for(const b of i.graphNodes.values())o.setEdge(b.portId,m);r.push({id:m,portId:m})}const d=o.edgeCount();if(d>10)for(const m of o.edges())o.setEdge(m,{...me.edgeLabel,width:d>25?800:400});const u=Ex(o),c=ce(r,St(m=>m.id===m.portId),Pn(m=>[m.id,u(m.id)]));function p(m){return c[m]??=ce(o.children(m)??[],St(b=>!b.endsWith(qa)),ae(b=>p(b)),xl(b=>{q(b.length>0,`Node ${m} has no nested nodes`)}),Bn((b,j)=>({minY:Math.min(b.minY,j.position.y),maxY:Math.max(b.maxY,j.position.y+j.height)}),{minY:1/0,maxY:-1/0}),({minY:b,maxY:j})=>{const{position:{x:S},width:D}=u(m);return b=b-me.compound.paddingTop,j=j+me.compound.paddingBottom,{position:{x:S,y:b},width:D,height:j-b}})}function h(m){const b=o.parent(m);return b?h(b)+1:0}function f(m){const b=o.children(m)??[];return b.length===0?0:1+Math.max(...b.map(f))}const x=(m,b,j)=>ce(j,ae((S,D)=>({port:m+"_"+b+D,topY:p(S).position.y})),cn(wt("topY")),ae(wt("port")));let w=0,C=0;const[v]=[...i.root];q(v,"Subjects should not be empty");let k=p(i.graphNodes.get(v.id).id);const _=r.map(({id:m})=>{const{element:b,inPorts:j,outPorts:S,column:D}=o.node(m);let{position:M,width:Y,height:O}=p(m);if(!b){if(O=Math.min(k.height,300),M.y=k.position.y+k.height/2-O/2,D==="incomers")Y=k.position.x-me.emptyNodeOffset-M.x;else{const xe=M.x+Y;M.x=k.position.x+k.width+me.emptyNodeOffset,Y=xe-M.x}return{id:m,parent:null,x:M.x,y:M.y,title:"empty node",description:Ge.EMPTY,technology:null,tags:[],links:[],color:"muted",shape:"rectangle",style:{border:"dashed",opacity:50},kind:wn.Empty,level:0,labelBBox:{x:M.x,y:M.y,width:Y,height:O},children:[],width:Y,height:O,column:D,ports:{in:[],out:[]},existsInCurrentView:!1}}const $=o.parent(m),N=(o.children(m)??[]).filter(xe=>!xe.endsWith(qa));w=Math.min(w,M.x),C=Math.min(C,M.y);const F=t?gn(b.scopedViews(),xe=>xe.id!==t.id)?.id??null:null,E=t?.findNodeWithElement(b.id),J=t&&!E?gn(b.ancestors(),xe=>!!t.findNodeWithElement(xe.id))?.id:null,Ce=E??(J&&t?.findNodeWithElement(J));return{id:m,parent:$??null,x:M.x,y:M.y,title:b.title,description:b.summary,technology:b.technology,tags:[...b.tags],links:null,color:Ce?.color??b.color,shape:E?.shape??b.shape,icon:E?.icon??b.icon??"none",modelRef:b.id,kind:b.kind,level:h(m),labelBBox:{x:M.x,y:M.y,width:Y,height:O},style:gt({...(E??Ce)?.style,...b.$element.style},["color","shape","icon"]),navigateTo:F,...N.length>0&&{depth:f(m)},children:N,width:Y,height:O,column:D,ports:{in:x(m,"in",j),out:x(m,"out",S)},existsInCurrentView:!!E}});return{subjectExistsInScope:!t||t.includesElement(v.id),bounds:{x:Math.min(w,0),y:Math.min(C,0),width:o.graph().width??100,height:o.graph().height??100},nodes:_,edges:o.edges().reduce((m,b)=>{const j=o.edge(b),S=b.name;if(!S)return m;const{name:D,source:M,sourceFqn:Y,target:O,targetFqn:$,relations:N,sourceHandle:F,targetHandle:E}=W(ln(l,de=>de.name===S)),J=dn(N),Ce=J?.title??"untitled",xe=N.length>1,Ze=dn(Ra(N.flatMap(de=>de.navigateTo?.id?de.navigateTo.id:[])));return m.push(_l({id:D,sourceFqn:Y,source:M,sourceHandle:F,targetFqn:$,target:O,targetHandle:E,label:xe?`${N.length} relationships`:Ce,navigateTo:Ze,color:J?.color??"gray",existsInCurrentView:!t||N.every(de=>t.includesRelation(de.id)),points:j.points.map(de=>[de.x,de.y]),line:J?.line??"dashed",head:J?.head,tail:J?.tail,relations:N.map(de=>de.id),parent:null})),m},[])}}function Dx(e,t,o){const a=je();return g.useMemo(()=>{const i=t?a.findView(t):null,s=Rx(Cs(e,a,t,o),o==="view"?i:null);return i&&(o==="global"||!s.subjectExistsInScope)&&(s.edges=s.edges.map(l=>(l.existsInCurrentView=l.relations.every(r=>i.includesRelation(r)),l))),Object.assign(s,{subject:e})},[a,e,t,o,Cs])}const go=(e,t)=>sp(e.label,t.label);function Ga(e){return{label:e.title,value:e.id,children:[...e.children()].map(Ga).sort(go)}}function Bx(e){const t=je();return g.useMemo(()=>e?[...t.view(e).roots()].map(Ga).sort(go):[...t.roots()].map(Ga).sort(go),[t,e??null])}const Lx=y({margin:"0"}),Tx=y({_hover:{backgroundColor:"mantine.colors.gray[0]",_dark:{backgroundColor:"mantine.colors.defaultHover",color:"mantine.colors.white"}}}),ac=y({maxHeight:["70vh","calc(100cqh - 70px)"]}),Ax=Object.freeze(Object.defineProperty({__proto__:null,label:Tx,node:Lx,scrollArea:ac},Symbol.toStringTag,{value:"Module"})),zx=e=>{const t=e.context.layouted?.subjectExistsInScope??!1;return{subjectId:e.context.subject,viewId:e.context.viewId,scope:e.context.scope,subjectExistsInScope:t,enableSelectSubject:e.context.enableSelectSubject,enableChangeScope:e.context.enableChangeScope}},$x=()=>{},Fx=g.memo(()=>{const e=Ro(),{subjectId:t,viewId:o,scope:a,subjectExistsInScope:i,enableSelectSubject:s,enableChangeScope:l}=Jn(zx),r=g.useRef(null),d=g.useRef(null),u=je().findElement(t),c=Bx(a==="view"&&o?o:void 0),p=In({multiple:!1});return p.setHoveredNode=$x,g.useEffect(()=>{ip(t).reverse().forEach(h=>{p.expand(h)}),p.select(t)},[t]),n.jsxs(re,{ref:r,gap:"xs",pos:"relative",children:[s&&n.jsxs(re,{gap:4,wrap:"nowrap",children:[n.jsx(X,{fz:"xs",fw:"500",style:{whiteSpace:"nowrap",userSelect:"none"},children:"Relationships of"}),n.jsx(X,{pos:"relative",children:n.jsxs(nt,{position:"bottom-start",shadow:"md",keepMounted:!1,withinPortal:!1,closeOnClickOutside:!0,clickOutsideEvents:["pointerdown","mousedown","click"],offset:4,onOpen:()=>{setTimeout(()=>{d.current?.querySelector(`[data-value="${t}"]`)?.scrollIntoView({behavior:"instant",block:"nearest"})},100)},children:[n.jsx(Gt,{children:n.jsx(ke,{size:"xs",variant:"default",maw:250,rightSection:n.jsx(Ri,{size:16}),children:n.jsx(L,{fz:"xs",fw:"500",truncate:!0,children:u?.title??"???"})})}),n.jsx(Zt,{p:0,miw:250,maw:400,children:n.jsx(We,{scrollbars:"y",type:"never",viewportRef:d,className:ac,children:n.jsx(En,{allowRangeSelection:!1,selectOnClick:!1,tree:p,data:c,classNames:Ax,levelOffset:8,styles:{root:{maxWidth:400,overflow:"hidden"},label:{paddingTop:5,paddingBottom:6}},renderNode:({node:h,selected:f,expanded:x,elementProps:w,hasChildren:C})=>n.jsxs(re,{gap:2,wrap:"nowrap",...w,py:"3",children:[n.jsx(U,{variant:"subtle",size:18,c:"dimmed",style:{visibility:C?"visible":"hidden"},children:n.jsx(mt,{stroke:3.5,style:{transition:"transform 150ms ease",transform:`rotate(${x?"90deg":"0"})`,width:"80%"}})}),n.jsx(X,{flex:"1 1 100%",w:"100%",onClick:v=>{v.stopPropagation(),p.select(h.value),p.expand(h.value),e.navigateTo(h.value)},children:n.jsx(L,{fz:"sm",fw:f?"600":"400",truncate:"end",children:h.label})})]})})})})]})})]}),l&&n.jsxs(re,{gap:4,wrap:"nowrap",children:[s&&n.jsx(X,{fz:"xs",fw:"500",...!i&&{c:"dimmed"},style:{whiteSpace:"nowrap",userSelect:"none"},children:"Scope"}),n.jsx("div",{children:n.jsx(_e,{color:"orange",label:n.jsxs(n.Fragment,{children:["This element does not exist in the current view",a==="view"&&n.jsxs(n.Fragment,{children:[n.jsx("br",{}),"Scope is set to global"]})]}),position:"bottom-start",disabled:i,portalProps:{target:r.current},children:n.jsx(Nn,{flex:"1 0 auto",size:"xs",withItemsBorders:!1,value:a,styles:{label:{paddingLeft:8,paddingRight:8}},onChange:h=>{e.changeScope(h)},data:[{label:"Global",value:"global"},{label:n.jsx("span",{children:"Current view"}),value:"view",disabled:!i}]})})})]})]})}),Vx={element:_x,compound:Px,empty:kx},Wx={relationship:wx};function ic({actorRef:e}){const t=g.useRef(null);return t.current==null&&(t.current={initialNodes:[],initialEdges:[]}),n.jsx(oc.Provider,{value:e,children:n.jsx(fi,{...t.current,children:n.jsx(Xt,{id:e.sessionId,inherit:!1,children:n.jsx(ue,{children:n.jsx(Xx,{})})})})})}const Ox=e=>({isActive:e.hasTag("active"),nodes:e.context.xynodes,edges:e.context.xyedges}),Hx=(e,t)=>e.isActive===t.isActive&&ee(e.nodes,t.nodes)&&ee(e.edges,t.edges),Xx=g.memo(()=>{const e=Ro(),{isActive:t,nodes:o,edges:a}=Jn(Ox,Hx);return n.jsx(Li,{id:e.rootElementId,nodes:o,edges:a,className:P(t?"initialized":"not-initialized","relationships-browser"),nodeTypes:Vx,edgeTypes:Wx,fitView:!1,onNodeClick:A((i,s)=>{i.stopPropagation(),e.send({type:"xyflow.nodeClick",node:s})}),onEdgeClick:A((i,s)=>{i.stopPropagation(),e.send({type:"xyflow.edgeClick",edge:s})}),onPaneClick:A(i=>{i.stopPropagation(),e.send({type:"xyflow.paneClick"})}),onDoubleClick:A(i=>{e.send({type:"xyflow.paneDblClick"})}),onViewportResize:A(()=>{e.send({type:"xyflow.resized"})}),onNodesChange:A(i=>{e.send({type:"xyflow.applyNodeChanges",changes:i})}),onEdgesChange:A(i=>{e.send({type:"xyflow.applyEdgeChanges",changes:i})}),onEdgeMouseEnter:A((i,s)=>{s.data.hovered||e.send({type:"xyflow.edgeMouseEnter",edge:s})}),onEdgeMouseLeave:A((i,s)=>{s.data.hovered&&e.send({type:"xyflow.edgeMouseLeave",edge:s})}),onSelectionChange:A(i=>{e.send({type:"xyflow.selectionChange",...i})}),nodesDraggable:!1,nodesSelectable:!0,pannable:!0,zoomable:!0,children:n.jsx(qx,{})})}),Yx=e=>({subjectId:e.context.subject,viewId:e.context.viewId,scope:e.context.scope,closeable:e.context.closeable}),qx=g.memo(()=>{const e=Ro(),{subjectId:t,viewId:o,scope:a,closeable:i}=Jn(Yx),s=Rn(),l=si();g.useEffect(()=>{l.viewportInitialized&&e.send({type:"xyflow.init",instance:l,store:s})},[s,l.viewportInitialized,e]);const r=Dx(t,o,a),[d,u,{history:c,current:p}]=sl(t);g.useEffect(()=>{d!==t&&u.set(t)},[t]),g.useEffect(()=>{d!==t&&e.navigateTo(d)},[d,e]),ri(()=>{e.updateView(r)},[r,e]);const h=p>0,f=p+1<c.length;return n.jsxs(n.Fragment,{children:[n.jsx(Gx,{hasStepBack:h,hasStepForward:f,onStepBack:()=>u.back(),onStepForward:()=>u.forward()}),i&&n.jsx(Dn,{position:"top-right",children:n.jsx(U,{variant:"default",color:"gray",onClick:x=>{x.stopPropagation(),e.close()},children:n.jsx(Ut,{})})})]})}),Gx=({hasStepBack:e,hasStepForward:t,onStepBack:o,onStepForward:a})=>n.jsx(Dn,{position:"top-left",children:n.jsxs(re,{gap:4,wrap:"nowrap",children:[n.jsxs(ue,{mode:"popLayout",children:[e&&n.jsx(De.div,{layout:!0,initial:{opacity:.05,transform:"translateX(-5px)"},animate:{opacity:1,transform:"translateX(0)"},exit:{opacity:.05,transform:"translateX(-10px)"},children:n.jsx(U,{variant:"default",color:"gray",onClick:i=>{i.stopPropagation(),o()},children:n.jsx(Vl,{})})},"back"),t&&n.jsx(De.div,{layout:!0,initial:{opacity:.05,transform:"translateX(5px)"},animate:{opacity:1,transform:"translateX(0)"},exit:{opacity:0,transform:"translateX(5px)"},children:n.jsx(U,{variant:"default",color:"gray",onClick:i=>{i.stopPropagation(),a()},children:n.jsx(mt,{})})},"forward")]}),n.jsx(Fx,{})]})}),Zx=y({display:"inline-block",fontSize:"sm",fontWeight:500,whiteSpace:"nowrap",padding:"[3px 6px]",borderRadius:3,background:"var(--likec4-palette-fill)/75",lineHeight:1.2,color:"var(--likec4-palette-hiContrast)"}),Kx=y({_light:{background:"mantine.colors.gray[1]","&[data-missing":{}},"&[data-missing]":{color:"mantine.colors.orange[4]",background:"mantine.colors.orange[8]/15",borderColor:"mantine.colors.orange[5]/20",_light:{color:"mantine.colors.orange[8]"}}}),Ux=y({flex:"1 1 100%",position:"relative",width:"100%",height:"100%",background:"mantine.colors.body",border:"1px solid {colors.mantine.colors.defaultBorder}",borderRadius:"sm",_light:{borderColor:"mantine.colors.gray[3]",background:"mantine.colors.gray[1]"}});y({_before:{content:'"scope:"',position:"absolute",top:"0",left:"2",fontSize:"xxs",fontWeight:500,lineHeight:"1",color:"mantine.colors.dimmed",opacity:.85,transform:"translateY(-100%) translateY(-2px)"},_light:{"& .mantine-SegmentedControl-root":{background:"mantine.colors.gray[3]"}}});y({display:"inline-block",fontSize:"xl",fontWeight:600,padding:"[1px 5px]",minWidth:24,textAlign:"center",borderRadius:"sm",background:"mantine.colors.dark[7]",color:"mantine.colors.defaultColor","&[data-zero]":{color:"mantine.colors.dimmed"},"&[data-missing]":{color:"mantine.colors.orange[4]",background:"mantine.colors.orange[8]/20"}});const Qx=_e.withProps({color:"dark",fz:"xs",openDelay:600,closeDelay:120,label:"",children:null,offset:8,withinPortal:!1});function Jx({node:e,element:t}){const o=ld(),a=Zy(),i=ne(a,c=>c.children[`${a.id}-relationships`]),s=[...t.incoming()].map(c=>c.id),l=[...t.outgoing()].map(c=>c.id),r=e?Ra([...e.incoming()].flatMap(c=>c.$edge.relations)):[],d=e?Ra([...e.outgoing()].flatMap(c=>c.$edge.relations)):[],u=[...s,...l].filter(c=>!r.includes(c)&&!d.includes(c)).length;return n.jsxs(Ne,{gap:"xs",pos:"relative",w:"100%",h:"100%",children:[s.length+l.length>0&&n.jsxs(re,{gap:"xs",wrap:"nowrap",align:"center",children:[n.jsx(X,{children:n.jsxs(re,{gap:8,mb:4,wrap:"nowrap",children:[n.jsx(fr,{title:"incoming",total:s.length,included:r.length}),n.jsx($e,{size:"sm",variant:"transparent",c:"dimmed",children:n.jsx(Yt,{style:{width:16}})}),n.jsx(L,{className:Zx,children:vi(t.id)}),n.jsx($e,{size:"sm",variant:"transparent",c:"dimmed",children:n.jsx(Yt,{style:{width:16}})}),n.jsx(fr,{title:"outgoing",total:l.length,included:d.length})]})}),u>0&&n.jsx(Qx,{label:"Current view does not include some relationships",children:n.jsxs(re,{mt:"xs",gap:6,c:"orange",style:{cursor:"pointer"},children:[n.jsx(Ii,{style:{width:14}}),n.jsxs(L,{fz:"sm",children:[u," relationship",u>1?"s are":" is"," hidden"]})]})})]}),n.jsx(X,{className:Ux,children:i&&n.jsxs(n.Fragment,{children:[n.jsx(ic,{actorRef:i}),n.jsx(X,{pos:"absolute",top:12,right:12,children:n.jsx(U,{size:"md",variant:"default",radius:"sm",onClick:c=>{c.stopPropagation();const{subject:p,scope:h,viewId:f}=i.getSnapshot().context;o.send({type:"open.relationshipsBrowser",subject:p,scope:h,viewId:f})},children:n.jsx(Wl,{stroke:1.6,style:{width:"70%"}})})})]})})]})}function fr({title:e,total:t,included:o}){return n.jsx(li,{withBorder:!0,shadow:"none",className:Kx,px:"md",py:"xs",radius:"md",mod:{zero:t===0,missing:t!==o},children:n.jsxs(Ne,{gap:4,align:"flex-end",children:[n.jsx(L,{component:"div",c:t!==o?"orange":"dimmed",tt:"uppercase",fw:600,fz:10,lh:1,children:e}),n.jsx(L,{fw:600,fz:"xl",component:"div",lh:1,children:t!==o?n.jsxs(n.Fragment,{children:[o," / ",t]}):n.jsx(n.Fragment,{children:t})})]})})}const e0=y({marginTop:"sm",marginBottom:"sm"}),t0=y({display:"inline-flex",transition:"fast",border:"1px dashed",borderColor:"mantine.colors.defaultBorder",borderRadius:"sm",px:"md",py:"xs",alignItems:"center",cursor:"pointer",color:"mantine.colors.gray[7]",_dark:{color:"mantine.colors.dark[1]"},"& > *":{transition:"fast"},_hover:{transitionTimingFunction:"out",borderStyle:"solid",color:"mantine.colors.defaultColor",background:"mantine.colors.defaultHover","& > *":{transitionTimingFunction:"out",transform:"translateX(1px)"}}}),wa=({element:e})=>n.jsx(X,{className:t0,children:n.jsx(L,{component:"div",fz:"sm",fw:"500",children:e.title})}),o0=()=>{};function n0({element:e}){const t=In({multiple:!1});t.setHoveredNode=o0;const o=g.useMemo(()=>{let a=1;const i=l=>({label:l,value:`msg${a++}`,type:"message",children:[]}),s={label:n.jsx(wa,{type:"current",element:e}),value:e.id,element:e,type:"current",children:[...e.children()].map(l=>({label:n.jsx(wa,{type:"descedant",element:l}),value:l.id,element:l,type:"descedant",children:[]}))};return s.children.length===0&&s.children.push(i(n.jsx(Vu,{radius:"sm",children:"no nested"}))),[[...e.ancestors()].reduce((l,r)=>({label:n.jsx(wa,{type:"ancestor",element:r}),value:r.id,element:r,type:"ancestor",children:[l]}),s)]},[e]);return g.useEffect(()=>{t.expandAllNodes()},[o]),n.jsxs(n.Fragment,{children:[n.jsxs(il,{variant:"light",color:"orange",title:"In development",icon:n.jsx(Ii,{}),children:["We need your feedback. Share your thoughts and ideas -"," ",n.jsx(Fu,{fz:"sm",fw:500,underline:"hover",c:"orange",href:"https://github.com/likec4/likec4/discussions/",target:"_blank",children:"GitHub discussions"})]}),n.jsx(En,{levelOffset:"xl",allowRangeSelection:!1,expandOnClick:!1,expandOnSpace:!1,classNames:{label:e0},data:o,tree:t})]})}const yr=yo.withProps({mb:8,labelPosition:"left",variant:"dashed"}),xr=_e.withProps({color:"dark",fz:"xs",openDelay:400,closeDelay:150,label:"",children:null,offset:4}),br=L.withProps({component:"div",fz:11,fw:500,c:"dimmed",lh:1}),so=L.withProps({component:"div",fz:"xs",c:"dimmed",className:lx}),At=24,a0=["Properties","Relationships","Views","Structure","Deployments"];function i0({viewId:e,fromNode:t,rectFromNode:o,fqn:a,onClose:i}){const[s,l]=g.useState(!1),r=Ru(),d=r.width||window.innerWidth||1200,u=r.height||window.innerHeight||800,[c,p]=Du({key:"likec4:element-details:active-tab",defaultValue:"Properties"}),h=H(),f=Nm(),x=t?f.findNode(t):f.findNodeWithElement(a),w=f.$model.element(a),[C,v]=ce([...w.views()],ae(V=>V.$view),ll(V=>V._type==="element"&&V.viewOf===a));let k=x?.navigateTo?.$view??w.defaultView?.$view??null;k?.id===e&&(k=null);const _=dn(w.links),m=Bu(),b=(x?.$node.children?.length??0)>0,j=Math.min(700,d-At*2),S=Math.min(650,u-At*2),D=o?{x:o.x+(b?o.width-j/2:o.width/2),y:o.y+(b?0:o.height/2)}:{x:d/2,y:u/2},M=o?Math.min(o.width/j,o.height/S,.9):1,Y=Math.round(ze(D.x-j/2,{min:At,max:d-j-At})),O=Math.round(ze(D.y-(b?0:60),{min:At,max:u-S-At})),$=ze((D.x-Y)/j,{min:.1,max:.9}),N=ze((D.y-O)/S,{min:.1,max:.9}),F=bs(j),E=bs(S);It(()=>{F.set(j),E.set(S)},[j,S]);const J=g.useCallback((V,te)=>{F.set(Math.max(F.get()+te.delta.x,320)),E.set(Math.max(E.get()+te.delta.y,300))},[]),Ce=g.useRef(null),xe=bl(i),Ze=oi(()=>{xe.current()},[],50),de=x?.$node.notation??null,Dt=zn({element:{id:a,title:w.title,icon:x?.icon??w.icon},className:ex});return sn(()=>{Ce.current?.open||Ce.current?.showModal()},20),sn(()=>{l(!0)},220),n.jsx(De.dialog,{ref:Ce,className:P(Ky,rn.classNames.fullWidth),layout:!0,initial:{[on]:"0px",[nn]:"5%"},animate:{[on]:"3px",[nn]:"60%"},exit:{[on]:"0px",[nn]:"0%",transition:{duration:.1}},onClick:V=>{V.stopPropagation(),V.target?.nodeName?.toUpperCase()==="DIALOG"&&Ce.current?.close()},onDoubleClick:ie,onPointerDown:ie,onClose:V=>{V.stopPropagation(),Ze()},children:n.jsx(rn,{forwardProps:!0,removeScrollBar:!1,children:n.jsxs(De.div,{layout:!0,layoutRoot:!0,drag:!0,dragControls:m,dragElastic:0,dragMomentum:!1,dragListener:!1,"data-likec4-color":x?.color??w.color,className:Uy,initial:{top:O,left:Y,width:j,height:S,opacity:0,originX:$,originY:N,scale:Math.max(M,.65)},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9,translateY:-10,transition:{duration:.1}},style:{width:F,height:E},children:[n.jsxs("div",{className:Qy,onPointerDown:V=>m.start(V),children:[n.jsxs(oe,{alignItems:"start",justify:"space-between",gap:"sm",mb:"sm",flexWrap:"nowrap",children:[n.jsxs(oe,{alignItems:"start",gap:"sm",style:{cursor:"default"},flexWrap:"nowrap",children:[Dt,n.jsxs("div",{children:[n.jsx(L,{component:"div",className:Jy,children:w.title}),de&&n.jsx(L,{component:"div",c:"dimmed",fz:"sm",fw:500,lh:1.3,lineClamp:1,children:de})]})]}),n.jsx(Lu,{size:"lg",onClick:V=>{V.stopPropagation(),Ze()}})]}),n.jsxs(oe,{alignItems:"baseline",gap:"sm",flexWrap:"nowrap",children:[n.jsxs("div",{children:[n.jsx(br,{children:"kind"}),n.jsx(pt,{radius:"sm",size:"sm",fw:600,color:"gray",style:{cursor:"pointer"},onClick:V=>{V.stopPropagation(),h.openSearch(`kind:${w.kind}`)},children:w.kind})]}),n.jsxs("div",{style:{flex:1},children:[n.jsx(br,{children:"tags"}),n.jsxs(_t,{gap:4,flex:1,mt:6,wrap:"wrap",children:[w.tags.map(V=>n.jsx(qn,{tag:V,cursor:"pointer",onClick:te=>{te.stopPropagation(),h.openSearch(`#${V}`)}},V)),w.tags.length===0&&n.jsx(pt,{radius:"sm",size:"sm",fw:600,color:"gray",children:""})]})]}),n.jsxs(Tu,{style:{alignSelf:"flex-start"},children:[_&&n.jsx(U,{component:"a",href:_.url,target:"_blank",size:"lg",variant:"default",radius:"sm",children:n.jsx(Wl,{stroke:1.6,style:{width:"65%"}})}),n.jsx(Jh,{feature:"Vscode",children:n.jsx(xr,{label:"Open source",children:n.jsx(U,{size:"lg",variant:"default",radius:"sm",onClick:V=>{V.stopPropagation(),h.openSource({element:w.id})},children:n.jsx(Kt,{stroke:1.8,style:{width:"62%"}})})})}),k&&n.jsx(xr,{label:"Open default view",children:n.jsx(U,{size:"lg",variant:"default",radius:"sm",onClick:V=>{V.stopPropagation(),h.navigateTo(k.id,t??void 0)},children:n.jsx(Le,{style:{width:"70%"}})})})]})]})]}),n.jsx(Jd,{children:n.jsxs(dl,{value:c,onChange:V=>p(V),variant:"none",classNames:{root:nx,list:ax,tab:ix,panel:sx},children:[n.jsx(cl,{children:a0.map(V=>n.jsx(Ea,{value:V,children:V},V))}),n.jsx(Ft,{value:"Properties",children:n.jsx(Vt,{scrollbars:"y",type:"scroll",offsetScrollbars:!0,children:n.jsxs(X,{className:rx,pt:"xs",children:[w.hasSummary&&n.jsxs(n.Fragment,{children:[n.jsx(so,{children:"summary"}),n.jsx(Mt,{value:w.summary})]}),n.jsxs(n.Fragment,{children:[n.jsx(so,{children:"description"}),n.jsx(Mt,{value:w.description,emptyText:"no description"})]}),w.technology&&n.jsx(s0,{title:"technology",children:w.technology}),w.links.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(so,{children:"links"}),n.jsx(oe,{gap:"xs",flexWrap:"wrap",children:w.links.map((V,te)=>n.jsx(Zi,{value:V},te))})]}),w.$element.metadata&&n.jsx(r0,{value:w.$element.metadata})]})})}),n.jsx(Ft,{value:"Relationships",children:n.jsx(Pt,{overrides:{enableRelationshipBrowser:!1,enableNavigateTo:!1},children:s&&c==="Relationships"&&n.jsx(Jx,{element:w,node:x??null})})}),n.jsx(Ft,{value:"Views",children:n.jsx(Vt,{scrollbars:"y",type:"auto",children:n.jsxs(Ne,{gap:"lg",children:[C.length>0&&n.jsxs(X,{children:[n.jsx(yr,{label:"views of the element (scoped)"}),n.jsx(Ne,{gap:"sm",children:C.map(V=>n.jsx(wr,{view:V,onNavigateTo:te=>h.navigateTo(te,t??void 0)},V.id))})]}),v.length>0&&n.jsxs(X,{children:[n.jsx(yr,{label:"views including this element"}),n.jsx(Ne,{gap:"sm",children:v.map(V=>n.jsx(wr,{view:V,onNavigateTo:te=>h.navigateTo(te,t??void 0)},V.id))})]})]})})}),n.jsx(Ft,{value:"Structure",children:n.jsx(Vt,{scrollbars:"y",type:"auto",children:n.jsx(n0,{element:w})})}),n.jsx(Ft,{value:"Deployments",children:n.jsx(Vt,{scrollbars:"y",type:"auto",children:n.jsx(bx,{elementFqn:w.id})})})]})}),n.jsx(De.div,{className:dx,drag:!0,dragElastic:0,dragMomentum:!1,onDrag:J,dragConstraints:{top:0,left:0,right:0,bottom:0}})]})})})}const wr=({view:e,onNavigateTo:t})=>n.jsx(se,{className:tx,onClick:o=>t(e.id,o),children:n.jsxs(re,{gap:6,align:"start",wrap:"nowrap",children:[n.jsx($e,{size:"sm",variant:"transparent",children:e._type==="deployment"?n.jsx(Di,{stroke:1.8}):n.jsx(Le,{stroke:1.8})}),n.jsx(X,{children:n.jsx(L,{component:"div",className:ox,lineClamp:1,children:e.title||"untitled"})})]})});function s0({title:e,emptyValue:t="undefined",children:o,style:a,...i}){return n.jsxs(n.Fragment,{children:[n.jsx(so,{children:e}),n.jsx(L,{component:"div",...yi(o)&&{c:"dimmed"},fz:"md",style:{whiteSpace:"preserve-breaks",userSelect:"all",...a},...i,children:o||t})]})}function r0({value:e}){const t=hi(e).sort(([o],[a])=>o.localeCompare(a));return n.jsx(Jd,{children:n.jsxs(n.Fragment,{children:[n.jsx(so,{style:{justifySelf:"end",textAlign:"right"},children:"metadata"}),n.jsx(X,{className:y({display:"grid",gridTemplateColumns:"min-content 1fr",gridAutoRows:"min-content",gap:"[12px 16px]",alignItems:"baseline",justifyItems:"stretch"}),children:t.map(([o,a])=>n.jsx(ux,{label:o,value:a},o))})]})})}const l0=e=>({viewId:e.context.currentView.id,fromNode:e.context.initiatedFrom.node,rectFromNode:e.context.initiatedFrom.clientRect,fqn:e.context.subject});function d0({actorRef:e,onClose:t}){const o=ne(e,l0,ee);return n.jsx(Ui.Provider,{value:e,children:n.jsx(i0,{onClose:t,...o})})}const vn=(e,t)=>e.size>2&&t.size!==e.size?new Set(Aa([...ki(e).flatten(),...t])):e.size>1?new Set(Aa([...e])):e;function c0(e,t){const o=new Set,a=new Set,i=new Set,s={sources:new Set,targets:new Set},l=(r,d)=>{d==="source"?(o.add(r),s.sources.add(r)):(i.add(r),s.targets.add(r))};for(const r of e){const d=t.findEdge(r),u=d?[...d.relationships("model")]:[];if(!d||!ve(u,1)||!d.source.hasElement()||!d.target.hasElement())continue;const c=d.source.element,p=d.target.element;l(c,"source"),l(p,"target");for(const h of u){if(a.add(h),h.source!==c){l(h.source,"source");for(const f of h.source.ancestors()){if(f===c)break;o.add(f)}}if(h.target!==p){l(h.target,"target");for(const f of h.target.ancestors()){if(f===p)break;i.add(f)}}}}return{sources:vn(o,s.sources),targets:vn(i,s.targets),relationships:a}}function u0({source:e,target:t}){const o=new Set,a=new Set,i=new Set,s={sources:new Set,targets:new Set},l=(d,u)=>{u==="source"?(o.add(d),s.sources.add(d)):(i.add(d),s.targets.add(d))};e&&l(e,"source"),t&&l(t,"target");const[r]=lp.findConnection(e,t,"directed");if(!r)return{sources:o,targets:i,relationships:a};for(const d of r.relations){const u=d.source,c=d.target;if(l(u,"source"),l(c,"target"),a.add(d),e!==u){q(uo(e,u),`${e.id} is not an ancestor of ${u.id}`);for(const p of u.ancestors()){if(p===e)break;o.add(p)}}if(t!==c){q(uo(t,c),`${t.id} is not an ancestor of ${c.id}`);for(const p of c.ancestors()){if(p===t)break;i.add(p)}}}return{sources:vn(o,s.sources),targets:vn(i,s.targets),relationships:a}}const p0=Gi(e=>{const{enableNavigateTo:t}=Z(),{data:{navigateTo:o}}=e,[a,i,s]=gl(e),l=H();return n.jsxs(Po,{...e,children:[n.jsx(No,{edgeProps:e,svgPath:a}),n.jsx(Xn,{edgeProps:e,labelPosition:{x:i,y:s,translate:"translate(-50%, 0)"},style:{maxWidth:Math.abs(e.targetX-e.sourceX-100)},children:n.jsx(Mo,{edgeProps:e,children:t&&o&&n.jsx(Hn,{...e,onClick:r=>{r.stopPropagation(),l.navigateTo(o)}})})})]})}),g0=e=>{const{enableNavigateTo:t,enableVscode:o}=Z(),a=H(),i=Wn(),s=[],{navigateTo:l,fqn:r}=e.data;return l&&t&&i!==l&&s.push({key:"navigate",icon:n.jsx(Le,{}),onClick:d=>{d.stopPropagation(),a.navigateTo(l)}}),r&&s.push({key:"relationships",icon:n.jsx(vo,{}),onClick:d=>{d.stopPropagation(),a.openRelationshipsBrowser(r)}}),r&&o&&s.push({key:"goToSource",icon:n.jsx(Kt,{}),onClick:d=>{d.stopPropagation(),a.openSource({element:r})}}),n.jsx(Yn,{buttons:s,...e})},sc=e=>{const t=H();return n.jsx(qi,{...e,onClick:o=>{o.stopPropagation(),t.openElementDetails(e.data.fqn)}})},h0=Ue(e=>{const{enableElementTags:t}=Z();return n.jsxs(eo,{nodeProps:e,children:[n.jsx(to,{...e}),n.jsx(He,{...e}),t&&n.jsx(Io,{...e}),n.jsx(sc,{...e}),n.jsx(g0,{...e}),n.jsx(f0,{...e})]})}),m0=Ue(e=>n.jsxs(So,{nodeProps:e,children:[n.jsx(sc,{...e}),n.jsx(_o,{...e}),n.jsx(y0,{...e})]})),f0=({data:{ports:e,height:t}})=>n.jsxs(n.Fragment,{children:[e.in.map((o,a)=>n.jsx(Pe,{id:o,type:"target",position:ge.Left,style:{visibility:"hidden",top:`${15+(a+1)*((t-30)/(e.in.length+1))}px`}},o)),e.out.map((o,a)=>n.jsx(Pe,{id:o,type:"source",position:ge.Right,style:{visibility:"hidden",top:`${15+(a+1)*((t-30)/(e.out.length+1))}px`}},o))]}),y0=({data:e})=>n.jsxs(n.Fragment,{children:[e.ports.in.map((t,o)=>n.jsx(Pe,{id:t,type:"target",position:ge.Left,style:{visibility:"hidden",top:`${20*(o+1)}px`}},t)),e.ports.out.map((t,o)=>n.jsx(Pe,{id:t,type:"source",position:ge.Right,style:{visibility:"hidden",top:`${20*(o+1)}px`}},t))]}),rc=g.createContext(null);function Qi(){return W(g.useContext(rc),"No RelationshipDetailsActorContext")}function lc(e,t=ee){const o=A(e),a=Qi();return ne(a,o,t)}function Ji(){const e=Qi();return g.useMemo(()=>({actor:e,get rootElementId(){return`relationship-details-${e.sessionId.replaceAll(":","_")}`},getState:()=>e.getSnapshot().context,send:e.send,navigateTo:(...t)=>{t.length===1?e.send({type:"navigate.to",params:{edgeId:t[0]}}):e.send({type:"navigate.to",params:{source:t[0],target:t[1]}})},fitDiagram:()=>{e.send({type:"fitDiagram"})},close:()=>{e._parent?e._parent?.send({type:"close",actorId:e.id}):e.send({type:"close"})}}),[e])}const Ae={dagre:{ranksep:60,nodesep:35,edgesep:25},edgeLabel:{width:220,height:14},nodeWidth:330,nodeHeight:180,compound:{labelHeight:2,paddingTop:50,paddingBottom:32}};function x0(){const e=new An.graphlib.Graph({directed:!0,compound:!0,multigraph:!0});return e.setGraph({...Ae.dagre,rankdir:"LR"}),e.setDefaultEdgeLabel(()=>({...Ae.edgeLabel})),e.setDefaultNodeLabel(()=>({})),e}const Za="-port";function vr(e,t,o){const a=new hn(s=>({id:`${e}-${s}`,portId:`${e}-${s}`})),i=ki(t);for(const s of i.sorted){const l=i.children(s).length>0,r=s.id,d=`${e}-${r}`,u=l?`${d}${Za}`:d;a.set(r,{id:d,portId:u}),o.setNode(d,{column:e,element:s,isCompound:l,portId:u,inPorts:[],outPorts:[],width:Ae.nodeWidth,height:Ae.nodeHeight}),l&&(o.setNode(u,{element:s,portId:u,isCompound:l,inPorts:[],outPorts:[],width:Ae.nodeWidth-Ae.dagre.ranksep,height:Ae.compound.labelHeight}),o.setParent(u,d));const c=i.parent(s);c&&o.setParent(d,`${e}-${c.id}`)}return{...i,byId:s=>{const l=i.byId(s),r=a.get(l.id);return{element:l,graph:r}},graphNodes:a}}function b0(e){return An.layout(e,{}),t=>{const o=e.node(t),{x:a,y:i,width:s,height:l}=o;return{position:{x:a-Math.round(s/2),y:i-Math.round(l/2)},width:s,height:l}}}function w0(e,t){const o=x0(),a=vr("sources",e.sources,o),i=vr("targets",e.targets,o),s=Array.from(e.relationships).map(v=>{const k=a.byId(v.source.id).graph,_=i.byId(v.target.id).graph,m=v.id;return o.node(k.id).outPorts.push(_.id),o.node(_.id).inPorts.push(k.id),o.setEdge(k.portId,_.portId,{...Ae.edgeLabel},m),{name:m,source:k.id,sourceHandle:k.id+"_out"+(o.node(k.id).outPorts.length-1),target:_.id,targetHandle:_.id+"_in"+(o.node(_.id).inPorts.length-1),relationship:v}}),l=[...a.graphNodes.values(),...i.graphNodes.values()];for(const{id:v}of l){const k=o.node(v);if(k.isCompound)continue;const _=Math.max(o.inEdges(v)?.length??0,o.outEdges(v)?.length??0);_>3&&(k.height=k.height+(_-4)*14)}const r=o.edgeCount();if(r>5)for(const v of o.edges())o.setEdge(v,{...Ae.edgeLabel,width:r>10?800:400});const d=b0(o),u=ce(l,St(v=>v.id===v.portId),Pn(v=>[v.id,d(v.id)]));function c(v){return u[v]??=ce(o.children(v)??[],St(k=>!k.endsWith(Za)),ae(k=>c(k)),xl(k=>{q(k.length>0,`Node ${v} has no nested nodes`)}),Bn((k,_)=>({minY:Math.min(k.minY,_.position.y),maxY:Math.max(k.maxY,_.position.y+_.height)}),{minY:1/0,maxY:-1/0}),({minY:k,maxY:_})=>{const{position:{x:m},width:b}=d(v);return k=k-Ae.compound.paddingTop,_=_+Ae.compound.paddingBottom,{position:{x:m,y:k},width:b,height:_-k}})}function p(v){const k=o.parent(v);return k?p(k)+1:0}function h(v){const k=o.children(v)??[];return k.length===0?0:1+Math.max(...k.map(h))}const f=(v,k,_)=>ce(_,ae((m,b)=>({port:v+"_"+k+b,topY:c(m).position.y})),cn(wt("topY")),ae(wt("port")));let x=0,w=0;const C=l.map(({id:v})=>{const{element:k,inPorts:_,outPorts:m,column:b}=o.node(v);let{position:j,width:S,height:D}=c(v);const M=o.parent(v),Y=(o.children(v)??[]).filter(E=>!E.endsWith(Za));x=Math.min(x,j.x),w=Math.min(w,j.y);const O=t?gn(k.scopedViews(),E=>E.id!==t.id)?.id??null:null,$=t?.findNodeWithElement(k.id),N=t&&!$?gn(k.ancestors(),E=>!!t.findNodeWithElement(E.id))?.id:null,F=$??(N&&t?.findNodeWithElement(N));return _l({id:v,parent:M??null,x:j.x,y:j.y,title:k.title,description:k.summary,technology:k.technology,tags:[...k.tags],links:null,color:F?.color??k.color,shape:$?.shape??k.shape,icon:$?.icon??k.icon??"none",modelRef:k.id,kind:k.kind,level:p(v),labelBBox:{x:j.x,y:j.y,width:S,height:D},style:gt({...($??F)?.style,...k.$element.style},["shape","color","icon"]),navigateTo:O,...Y.length>0&&{depth:h(v)},children:Y,width:S,height:D,column:b,ports:{in:f(v,"in",_),out:f(v,"out",m)}})});return{bounds:{x:Math.min(x,0),y:Math.min(w,0),width:o.graph().width??100,height:o.graph().height??100},nodes:C,edges:o.edges().reduce((v,k)=>{const _=o.edge(k),m=k.name;if(!m)return v;const{name:b,source:j,target:S,relationship:D,sourceHandle:M,targetHandle:Y}=ln(s,E=>E.name===m),O=D.title??"untitled",$=D.navigateTo?.id??null,N=D.description??null,F=D.technology??null;return v.push({id:b,source:j,sourceHandle:M,target:S,targetHandle:Y,label:O,color:D.color,...$&&{navigateTo:$},...N&&{description:N},...F&&{technology:F},points:_.points.map(E=>[E.x,E.y]),line:D.line,relationId:D.id,parent:null}),v},[])}}const es=y.raw({display:"inline-flex",alignItems:"center",padding:"[6px 2px 0 2px]","& .mantine-Text-root":{color:"mantine.colors.text/90",fontSize:"xs",fontWeight:500,lineHeight:"1.2"}}),kr=y({paddingLeft:"1",gridColumn:1},es),v0=y({gridColumn:2},es),jr=y({gridColumn:3,paddingRight:"1"},es),dc="likec4-edge-label",k0=P(dc,y({display:"grid",gridColumnStart:1,gridColumnEnd:4,borderBottom:"1px solid",borderBottomColor:"mantine.colors.defaultBorder",marginBottom:"0",padding:"[0 4px 5px 4px]",width:"100%","& .mantine-Text-root":{fontSize:"xxs",fontWeight:400,lineHeight:"xs",color:"mantine.colors.dimmed"}})),j0=y({display:"contents",[`&:last-child .${dc}`]:{borderBottom:"none",marginBottom:"0"},"& > *":{transition:"all 0.15s ease-in"},"&:is(:hover, [data-selected=true]) > *":{transition:"all 0.15s ease-out",cursor:"pointer",backgroundColor:"mantine.colors.defaultHover"}}),C0=y({display:"grid",gridTemplateColumns:"1fr 30px 1fr",gridAutoRows:"min-content max-content",gap:"0",alignItems:"stretch"});y({display:"grid",gridTemplateColumns:"min-content 1fr",gridAutoRows:"min-content max-content",gap:"[10px 12px]",alignItems:"baseline",justifyItems:"start"});const S0=y({maxHeight:["70vh","calc(100cqh - 70px)"]}),_0=({edge:e,view:t})=>{const o=Ji(),a=g.useRef(null),i=t.nodes.find(r=>r.id===e.source),s=t.nodes.find(r=>r.id===e.target),l=t.edges.flatMap(r=>{const d=t.nodes.find(c=>c.id===r.source),u=t.nodes.find(c=>c.id===r.target);return d&&u?{id:r.id,source:d,target:u,label:r.label}:[]});return!i||!s||l.length===0?null:n.jsxs(nt,{position:"bottom-start",shadow:"md",keepMounted:!0,withinPortal:!1,closeOnClickOutside:!0,clickOutsideEvents:["pointerdown","mousedown","click"],onOpen:()=>{setTimeout(()=>{a.current?.querySelector(`[data-edge-id="${e.id}"]`)?.scrollIntoView({behavior:"instant",block:"nearest"})},100)},children:[n.jsx(Gt,{children:n.jsxs(ke,{size:"xs",variant:"default",fw:"500",style:{padding:"0.25rem 0.75rem"},rightSection:n.jsx(Ri,{size:16}),children:[n.jsx(X,{className:kr,maw:160,p:0,mod:{"likec4-color":i.color},children:n.jsx(L,{component:"span",truncate:!0,children:i.title})}),n.jsx($e,{color:"dark",variant:"transparent",size:"xs",children:n.jsx(Yt,{style:{width:"80%"}})}),n.jsx(X,{className:jr,maw:160,p:0,mod:{"likec4-color":s.color},children:n.jsx(L,{component:"span",truncate:!0,children:s.title})})]})}),n.jsx(Zt,{p:0,miw:250,maw:400,children:n.jsx(We,{className:S0,scrollbars:"y",type:"never",viewportRef:a,children:n.jsx(X,{className:C0,p:"xs",maw:400,children:l.map(r=>n.jsxs("div",{className:j0,"data-selected":r.id===e.id,onClick:d=>{d.stopPropagation(),o.navigateTo(r.id)},children:[n.jsx(X,{className:kr,mod:{"edge-id":r.id,"likec4-color":r.source.color},children:n.jsx(L,{component:"span",truncate:!0,children:r.source.title})}),n.jsx(X,{className:v0,children:n.jsx($e,{color:"dark",variant:"transparent",size:"xs",children:n.jsx(Yt,{style:{width:"80%"}})})}),n.jsx(X,{className:jr,mod:{"likec4-color":r.target.color},children:n.jsx(L,{component:"span",truncate:!0,children:r.target.title})}),n.jsx(X,{className:k0,children:n.jsx(L,{component:"span",truncate:!0,children:r.label||"untitled"})})]},r.id))})})})]})},P0={element:h0,compound:m0},M0={relationship:p0};function N0({actorRef:e}){const t=g.useRef(null);return t.current==null&&(t.current={defaultNodes:[],defaultEdges:[]}),n.jsx(rc.Provider,{value:e,children:n.jsx(fi,{...t.current,children:n.jsx(Xt,{id:e.sessionId,inherit:!1,children:n.jsxs(ue,{children:[n.jsx(D0,{},"xyflow"),n.jsx(E0,{},"sync")]})})})})}const I0=e=>({...e.context.subject,viewId:e.context.viewId}),E0=g.memo(()=>{const e=Qi(),t=ne(e,I0,I),o=je(),a=o.findView(t.viewId)??null,i=g.useMemo(()=>{let r;if("edgeId"in t&&Se(t.edgeId)){q(a,`view ${t.viewId} not found`);const d=W(a.findEdge(t.edgeId),`edge ${t.edgeId} not found in ${t.viewId}`);r=c0([d.id],a)}else if(t.source&&t.target)r=u0({source:o.element(t.source),target:o.element(t.target)});else return null;return w0(r,a)},[t,a,o]),s=Rn(),l=si();return g.useEffect(()=>{l.viewportInitialized&&e.send({type:"xyflow.init",instance:l,store:s})},[s,l.viewportInitialized,e]),g.useEffect(()=>{i!==null&&e.send({type:"update.layoutData",data:i})},[i,e]),null}),R0=({context:e})=>({initialized:e.initialized.xydata&&e.initialized.xyflow,nodes:e.xynodes,edges:e.xyedges}),D0=g.memo(()=>{const e=Ji(),{initialized:t,nodes:o,edges:a}=lc(R0,I);return n.jsxs(Li,{id:e.rootElementId,nodes:o,edges:a,className:P(t?"initialized":"not-initialized","likec4-relationship-details"),nodeTypes:P0,edgeTypes:M0,onNodesChange:Xe(i=>{e.send({type:"xyflow.applyNodeChanges",changes:i})}),onEdgesChange:Xe(i=>{e.send({type:"xyflow.applyEdgeChanges",changes:i})}),fitViewPadding:.05,onNodeClick:Xe((i,s)=>{i.stopPropagation(),e.send({type:"xyflow.nodeClick",node:s})}),onEdgeClick:Xe((i,s)=>{i.stopPropagation(),e.send({type:"xyflow.edgeClick",edge:s})}),onPaneClick:Xe(()=>{e.send({type:"xyflow.paneClick"})}),onDoubleClick:Xe(()=>{e.send({type:"xyflow.paneDblClick"})}),onViewportResize:Xe(()=>{e.send({type:"xyflow.resized"})}),onEdgeMouseEnter:Xe((i,s)=>{s.data.hovered||e.send({type:"xyflow.edgeMouseEnter",edge:s})}),onEdgeMouseLeave:Xe((i,s)=>{s.data.hovered&&e.send({type:"xyflow.edgeMouseLeave",edge:s})}),onSelectionChange:Xe(i=>{e.send({type:"xyflow.selectionChange",...i})}),nodesDraggable:!1,nodesSelectable:!0,fitView:!1,pannable:!0,zoomable:!0,children:[n.jsx(L0,{}),n.jsx(Dn,{position:"top-right",children:n.jsx(U,{variant:"default",color:"gray",onClick:i=>{i.stopPropagation(),e.close()},children:n.jsx(Ut,{})})})]})}),B0=({context:e})=>({subject:e.subject,viewId:e.viewId}),L0=g.memo(()=>{const{subject:e,viewId:t}=lc(B0,I),o=je().findView(t);if(!o||!o.isDiagram())return null;const a=[...o.edges()];let i="edgeId"in e&&Se(e.edgeId)?a.find(s=>s.id===e.edgeId):ln(a,s=>s.source.element?.id===e.source&&s.target.element?.id===e.target)||ln(a,s=>(s.source.element?.id===e.source||uo(s.source.element?.id??"__",e.source??"__"))&&(s.target.element?.id===e.target||uo(s.target.element?.id??"__",e.target??"__")));return i?n.jsx(T0,{edge:i.$edge,view:o.$view}):null}),T0=({edge:e,view:t})=>{const o=Ji(),a=e.id,[i,s,{history:l,current:r}]=sl(e.id);g.useEffect(()=>{i!==a&&s.set(a)},[a]),g.useEffect(()=>{i!==a&&o.navigateTo(i)},[i]);const d=r>0,u=r+1<l.length;return n.jsx(Dn,{position:"top-left",children:n.jsx(re,{gap:4,wrap:"nowrap",children:n.jsxs(ue,{mode:"popLayout",children:[d&&n.jsx(De.div,{layout:!0,initial:{opacity:.05,transform:"translateX(-5px)"},animate:{opacity:1,transform:"translateX(0)"},exit:{opacity:.05,transform:"translateX(-10px)"},children:n.jsx(U,{variant:"default",color:"gray",onClick:c=>{c.stopPropagation(),s.back()},children:n.jsx(Vl,{})})},"back"),u&&n.jsx(De.div,{layout:!0,initial:{opacity:.05,transform:"translateX(5px)"},animate:{opacity:1,transform:"translateX(0)"},exit:{opacity:0,transform:"translateX(5px)"},children:n.jsx(U,{variant:"default",color:"gray",onClick:c=>{c.stopPropagation(),s.forward()},children:n.jsx(mt,{})})},"forward"),n.jsx(re,{gap:"xs",wrap:"nowrap",ml:"sm",children:n.jsx(_0,{edge:e,view:t})})]})})})},A0=e=>e.context.overlays.map(t=>{switch(t.type){case"relationshipsBrowser":return e.children[t.id]?{type:t.type,actorRef:e.children[t.id]}:null;case"relationshipDetails":return e.children[t.id]?{type:t.type,actorRef:e.children[t.id]}:null;case"elementDetails":return e.children[t.id]?{type:t.type,actorRef:e.children[t.id]}:null;default:it(t)}}).filter(ml),z0=(e,t)=>e.length===t.length&&e.every((o,a)=>o.actorRef===t[a].actorRef);function $0({overlaysActorRef:e}){const t=$n(d=>d.domNode),o=g.useMemo(()=>t?.querySelector(".react-flow__renderer")??null,[t]),a=ne(e,A0,z0),i=Jr()??!1,s=a.some(d=>d.type==="elementDetails");g.useEffect(()=>{!o||i||fu(o,{opacity:s?.7:1,filter:s?"grayscale(1)":"grayscale(0)",transform:s?"perspective(400px) translateZ(-12px) translateY(3px)":"translateY(0)"},{duration:s?.35:.17})},[s,o]);const l=d=>{e.send({type:"close",actorId:d.id})},r=a.map((d,u)=>{switch(d.type){case"relationshipsBrowser":return n.jsx(bn,{overlayLevel:u,onClose:()=>l(d.actorRef),children:n.jsx(ic,{actorRef:d.actorRef})},d.actorRef.sessionId);case"relationshipDetails":return n.jsx(bn,{overlayLevel:u,onClose:()=>l(d.actorRef),children:n.jsx(N0,{actorRef:d.actorRef})},d.actorRef.sessionId);case"elementDetails":return n.jsx(d0,{actorRef:d.actorRef,onClose:()=>l(d.actorRef)},d.actorRef.sessionId);default:it(d)}});return n.jsx(Pt.Overlays,{children:n.jsx(ci,{FallbackComponent:Fi,onReset:()=>e.send({type:"close.all"}),children:n.jsx(Xt,{children:n.jsx(ue,{children:r})})})})}const[F0,yt]=Zr("SearchActorContext"),V0=e=>e.context.searchValue;function W0(){const e=yt(),t=ne(e,V0),o=g.useCallback(a=>{e.send({type:"change.search",search:a})},[e]);return[t,o]}const O0=e=>{const t=e.context.searchValue.trim().toLowerCase();return t.length>1?t:""};function ts(){const e=yt();return g.useDeferredValue(ne(e,O0))}function H0(){const e=yt();return g.useCallback(t=>{e.send({type:"change.search",search:t})},[e])}const X0=e=>e.context.pickViewFor;function Y0(){const e=yt();return ne(e,X0)}const va=y.raw({outline:"none",background:"mantine.colors.primary[8]",borderColor:"mantine.colors.primary[9]"}),ea=".mantine-Tree-node:focus > .mantine-Tree-label &",q0=y.raw({display:"flex",width:"100%",background:"mantine.colors.body",rounded:"sm",padding:"[12px 8px 12px 14px]",minHeight:"60px",gap:"2",border:"1px solid",borderColor:"mantine.colors.defaultBorder",_hover:{...va,borderColor:"mantine.colors.primary[9]",background:"mantine.colors.primary[8]/60"},_focus:va,[ea]:va,_dark:{borderColor:"transparent",background:"mantine.colors.dark[6]/80"},_light:{background:"mantine.colors.white/80",_hover:{borderColor:"mantine.colors.primary[6]",backgroundColor:"mantine.colors.primary[5]"}}}),ta="likec4-focusable",Ho={ref:"var(--likec4-icon-size, 24px)"},G0=y.raw({color:{base:"mantine.colors.dimmed",_light:"mantine.colors.gray[5]",_groupHover:"mantine.colors.primary[0]",_groupFocus:"mantine.colors.primary[0]"},[ea]:{color:"mantine.colors.primary[0]"},flex:`0 0 ${Ho.ref}`,height:Ho.ref,width:Ho.ref,display:"flex",alignItems:"center",justifyContent:"center",alignSelf:"flex-start","--ti-size":Ho.ref,"& svg, & img":{width:"100%",height:"auto",maxHeight:"100%",pointerEvents:"none"},"& img":{objectFit:"contain"},"&.likec4-shape-icon svg":{strokeWidth:1.5}}),Z0=y.raw({fontSize:"16px",fontWeight:500,lineHeight:"1.1",":where([data-disabled]) &":{opacity:.4},color:{base:"mantine.colors.dark[1]",_light:"mantine.colors.gray[7]",_groupHover:{base:"mantine.colors.primary[1]",_light:"mantine.colors.white"},_groupFocus:{base:"mantine.colors.primary[1]",_light:"mantine.colors.white"}},[ea]:{color:{base:"mantine.colors.primary[1]",_light:"mantine.colors.white"}}}),cc=y.raw({color:{base:"mantine.colors.dimmed",_groupHover:{base:"mantine.colors.primary[1]",_light:"mantine.colors.primary[0]"},_groupFocus:"mantine.colors.primary[0]"},[ea]:{color:"mantine.colors.primary[0]"}}),K0=y.raw(cc,{marginTop:"1",fontSize:"12px",lineHeight:"1.4",":where([data-disabled]) &":{opacity:.85}}),U0=y({width:"100%",height:"100%",border:"2px dashed",borderColor:"mantine.colors.defaultBorder",rounded:"md",display:"flex",justifyContent:"center",alignItems:"center",fontSize:"md",color:"mantine.colors.dimmed",padding:"md",paddingBlock:"xl"}),uc=Kp({slots:["root","icon","title","description","descriptionColor"],className:"search-button",base:{root:q0,icon:G0,title:Z0,description:K0,descriptionColor:cc}}),os="@container likec4-tree (max-width: 450px)",Q0=y({outline:"none",marginBottom:"2"}),J0=y(ad.raw({containerName:"likec4-tree"}),{containerType:"inline-size",height:"100%"}),e1=y({display:"flex",alignItems:"baseline",outline:"none !important",gap:"1"}),t1=y({marginTop:"2"}),o1=y({color:"mantine.colors.dimmed"}),n1=y({[os]:{flexDirection:"column-reverse",alignItems:"flex-start",gap:"0.5"}}),a1=y({fontSize:"10px",lineHeight:"1.3",display:"block",fontWeight:500,whiteSpace:"nowrap",padding:"[1px 5px]",borderRadius:"4px",background:"mantine.colors.dark[9]/30",_light:{background:"mantine.colors.gray[3]/20"}}),i1=y({"--likec4-icon-size":"24px",[os]:{"--likec4-icon-size":"18px"}}),s1=y({flex:0,fontSize:"10px",fontWeight:500,whiteSpace:"nowrap",lineHeight:"1.1",[os]:{display:"none"}});function Ee(e){e.stopPropagation(),e.preventDefault()}function pc(e){const t=e.getBoundingClientRect();return t.y+Math.floor(t.height/2)}function Do(e){if(!e){console.error("moveFocusToSearchInput: from is null or undefined");return}const t=e.getRootNode();if(!Tn(t.querySelector)){console.error("moveFocusToSearchInput: root.querySelector is not a function");return}let o=t.querySelector("[data-likec4-search-input]");if(o){const a=o.value.length;o.focus(),o.setSelectionRange(a,a)}}function kn(e){if(!e){console.error("focusToFirstFoundElement: from is null or undefined");return}const t=e.getRootNode();if(!Tn(t.querySelector)){console.error("focusToFirstFoundElement: root.querySelector is not a function");return}t.querySelector(`[data-likec4-search] .${ta}`)?.focus()}function gc(e,t,o=`.${ta}`){if(!e)return console.error("queryAllFocusable: from is null or undefined"),[];const a=e.getRootNode();return Tn(a.querySelectorAll)?[...a.querySelectorAll(`[data-likec4-search-${t}] ${o}`)]:(console.error("queryAllFocusable: root.querySelectorAll is not a function"),[])}const r1="likec4-view-btn",l1=P(y({flexWrap:"nowrap",display:"flex","&[data-disabled] .mantine-ThemeIcon-root":{opacity:.45}}),r1);y({marginTop:"1",fontSize:"13px",lineHeight:"1.4",":where(.likec4-view-btn[data-disabled]) &":{opacity:.85}});const hc=()=>n.jsx(K,{className:U0,children:"Nothing found"}),d1=g.memo(()=>{const e=g.useRef(null);let t=[...je().views()],o=ts();return o&&(o.startsWith("kind:")?t=[]:t=t.filter(a=>o.startsWith("#")?a.tags.some(i=>i.toLocaleLowerCase().includes(o.slice(1))):`${a.id} ${a.title} ${a.description.text}`.toLocaleLowerCase().includes(o))),n.jsxs(Ne,{ref:e,renderRoot:a=>n.jsx(Q,{layout:!0,...a}),gap:8,"data-likec4-search-views":!0,onKeyDown:a=>{if(a.key==="ArrowLeft"||a.key==="ArrowRight"){const i=a.target.getBoundingClientRect().y,s=gc(e.current,"elements",".likec4-element-button");let l=s.length>1?s.find((r,d,u)=>pc(r)>i||d===u.length-1):null;l??=lo(s),l&&(a.stopPropagation(),l.focus());return}},children:[t.length===0&&n.jsx(hc,{}),t.length>0&&n.jsx(Zc,{children:n.jsx(se,{"data-likec4-view":!0,tabIndex:-1,onFocus:a=>{a.stopPropagation(),Do(e.current)}})}),t.map((a,i)=>n.jsx(Q,{layoutId:`@view${a.id}`,children:n.jsx(Ka,{view:a,search:o,tabIndex:i===0?0:-1})},a.id))]})}),Xo=uc();function Ka({className:e,view:t,loop:o=!1,search:a,...i}){const s=yt(),l=H(),r=Wn(),d=t.id===r,u=()=>{s.send({type:"close"}),setTimeout(()=>{l.navigateTo(t.id)},100)};return n.jsxs(se,{...i,className:P(Xo.root,"group",ta,l1,e),"data-likec4-view":t.id,...d&&{"data-disabled":!0},onClick:c=>{c.stopPropagation(),u()},onKeyDown:nl({siblingSelector:"[data-likec4-view]",parentSelector:"[data-likec4-search-views]",activateOnFocus:!1,loop:o,orientation:"vertical",onKeyDown:c=>{c.nativeEvent.code==="Space"&&(c.stopPropagation(),u())}}),children:[n.jsx($e,{variant:"transparent",className:Xo.icon,children:t.isDeploymentView()?n.jsx(Di,{stroke:1.8}):n.jsx(Le,{stroke:1.8})}),n.jsxs(K,{style:{flexGrow:1},children:[n.jsxs(re,{gap:"xs",wrap:"nowrap",align:"center",children:[n.jsx(kt,{component:"div",highlight:a,className:Xo.title,children:t.title||"untitled"}),d&&n.jsx(pt,{size:"xs",fz:9,radius:"sm",children:"current"})]}),n.jsx(kt,{highlight:t.description.nonEmpty?a:"",component:"div",className:Xo.description,lineClamp:1,children:t.description.text||"No description"})]})]})}const zt=uc(),c1=g.memo(()=>{const e=je(),t=ts(),o=g.useMemo(()=>{const i=t.split(".");let s;Ct(i)||i[0]==="kind:"?s=e.elements():s=Sl(e.elements(),u=>t.startsWith("kind:")?u.kind.toLocaleLowerCase().startsWith(t.slice(5)):t.startsWith("#")?u.tags.some(c=>c.toLocaleLowerCase().includes(t.slice(1))):(u.title+" "+u.id+" "+u.summary.text).toLocaleLowerCase().includes(t));const l={},{all:r,roots:d}=ce([...s],Aa,Bn((u,c)=>{const p={label:c.title,value:c.id,element:c,searchTerms:i,children:[]};l[p.value]=p;const h=u.all.findLast(f=>uo(f.value,p.value));return h?(h.children.push(p),h.children.length>1&&h.children.sort(go)):u.roots.push(p),u.all.push(p),u},{all:[],roots:[]}));return{all:r,byid:l,roots:d.sort(go)}},[e,t]),a=mc();return o.all.length===0?n.jsx(hc,{}):n.jsx(p1,{data:o,handleClick:a})}),u1=()=>{};function p1({data:{all:e,byid:t,roots:o},handleClick:a}){const i=In({multiple:!1});i.setHoveredNode=u1,g.useEffect(()=>{i.collapseAllNodes();for(const l of e)l.children.length>0&&i.expand(l.value)},[e]);const s=A(l=>{const r=l.target,d=r.getAttribute("data-value"),u=!!d&&t[d];if(u){if(l.key==="ArrowUp"){d===o[0]?.value&&(Ee(l),Do(r));return}if(l.key==="ArrowRight"){if(u.children.length>0&&i.expandedState[d]===!1)return;const c=(l.target.querySelector(".mantine-Tree-label")??r).getBoundingClientRect().y,p=gc(r,"views");let h=p.length>1?p.find((f,x,w)=>pc(f)>c||x===w.length-1):null;h??=lo(p),h&&(Ee(l),h.focus());return}if(l.key===" "||l.key==="Enter"){Ee(l),a(u.element);return}}});return n.jsx(En,{"data-likec4-search-elements":!0,allowRangeSelection:!1,clearSelectionOnOutsideClick:!0,selectOnClick:!1,tree:i,data:o,levelOffset:"lg",classNames:{root:J0,node:P(ta,Q0),label:e1,subtree:t1},onKeyDownCapture:s,renderNode:g1})}function g1({node:e,elementProps:t,hasChildren:o,expanded:a}){const{element:i,searchTerms:s}=e,l=Ih({element:{id:i.id,title:i.title,shape:i.shape,icon:i.icon},className:P(zt.icon,i1)}),r=[...i.views()],d=mc(),u=`@tree.${e.value}`;return n.jsxs(Q,{layoutId:u,...t,children:[n.jsx(U,{variant:"transparent",size:16,tabIndex:-1,className:P(o1),style:{visibility:o?"visible":"hidden"},children:n.jsx(mt,{stroke:3.5,style:{transition:"transform 150ms ease",transform:`rotate(${a?"90deg":"0"})`,width:"100%"}})}),n.jsxs(se,{component:Be,layout:!0,tabIndex:-1,"data-value":i.id,className:P(zt.root,"group","likec4-element-button"),...r.length>0&&{onClick:c=>{(!o||a)&&(c.stopPropagation(),d(i))}},children:[l,n.jsxs(X,{style:{flexGrow:1},children:[n.jsxs(re,{gap:"xs",wrap:"nowrap",align:"center",className:n1,children:[n.jsx(kt,{component:"div",highlight:s,className:zt.title,children:e.label}),n.jsx(_e,{label:i.id,withinPortal:!1,fz:"xs",disabled:!i.id.includes("."),children:n.jsx(kt,{component:"div",highlight:s,className:P(a1,zt.descriptionColor),children:vi(i.id)})})]}),n.jsx(kt,{component:"div",highlight:s,className:zt.description,lineClamp:1,children:i.summary.text||"No description"})]}),n.jsx(L,{component:"div",className:P(s1,zt.descriptionColor),fz:"xs",children:r.length===0?"No views":n.jsxs(n.Fragment,{children:[r.length," view",r.length>1?"s":""]})})]})]})}function mc(){const e=H(),t=yt();return A(o=>{const a=[...o.views()];if(a.length===0)return;const i=dn(a);if(i){t.send({type:"close"}),i.id!==e.currentView.id&&setTimeout(()=>{e.navigateTo(i.id)},100);return}t.send({type:"pickview.open",elementFqn:o.id})})}const h1=y({border:"transparent",background:{base:"transparent",_focusWithin:{base:"mantine.colors.gray[4]/55 !important",_dark:"mantine.colors.dark[5]/55 !important"},_groupHover:{base:"mantine.colors.gray[3]/35",_dark:"mantine.colors.dark[5]/35"}}}),m1=y({position:"absolute",inset:"0",width:"100%",height:"100%",backgroundColor:"[rgb(34 34 34 / 0.7)]",zIndex:902,backdropFilter:"auto",backdropBlur:"10px",_light:{backgroundColor:"[rgb(255 255 255 / 0.6)]"}}),f1=y({position:"absolute",top:"[2rem]",left:"[50%]",width:"100%",maxWidth:"600px",minWidth:"200px",transform:"translateX(-50%)",zIndex:903}),Cr=y({marginTop:"2","& + &":{marginTop:"[32px]"}});y({height:["100%","100cqh"],"& .mantine-ScrollArea-viewport":{minHeight:"100%","& > div":{minHeight:"100%",height:"100%"}}});function y1({elementFqn:e}){const t=yt(),o=je().element(e),a=[],i=[];for(const l of o.views())l.viewOf===o?a.push(l):i.push(l);const s=()=>{t.send({type:"pickview.close"})};return rl("keydown",l=>{try{l.key==="Escape"&&(l.stopPropagation(),l.preventDefault(),s())}catch(r){console.warn(r)}},{capture:!0}),n.jsxs(n.Fragment,{children:[n.jsx(Q,{className:m1,onClick:l=>{l.stopPropagation(),s()}},"pickview-backdrop"),n.jsx(Au,{children:n.jsxs(Q,{initial:{opacity:0,scale:.95,originY:0,translateX:"-50%",translateY:-20},animate:{opacity:1,scale:1,translateY:0},exit:{opacity:0,scale:.98,translateY:-20,transition:{duration:.1}},className:f1,"data-likec4-search-views":!0,children:[n.jsxs(re,{px:"sm",py:"md",justify:"space-between",children:[n.jsx(io,{order:2,lh:1,children:"Select view"}),n.jsx(U,{size:"md",variant:"default",onClick:l=>{l.stopPropagation(),s()},children:n.jsx(Ut,{})})]}),n.jsxs(We,{mah:"calc(100vh - 110px)",type:"never",children:[a.length>0&&n.jsxs(Ne,{gap:"sm",px:"sm",className:Cr,children:[n.jsx(io,{order:6,c:"dimmed",children:"scoped views of the element"}),a.map((l,r)=>n.jsx(Ka,{view:l,search:"",loop:!0,mod:{autofocus:r===0}},l.id))]}),i.length>0&&n.jsxs(Ne,{gap:"sm",px:"sm",className:Cr,children:[n.jsx(io,{order:6,c:"dimmed",children:"views including this element"}),i.map((l,r)=>n.jsx(Ka,{view:l,search:"",loop:!0,mod:{autofocus:r===0&&a.length===0}},l.id))]})]})]},"pickview")})]})}function x1(){const e=g.useRef(null);let t=je().tagsSortedByUsage,o=H0(),a=ts(),i=t.length,s=!1;if(a.startsWith("#")){const l=a.slice(1);t=t.filter(({tag:r})=>r.toLocaleLowerCase().includes(l)),s=t.length!==i}return t.length===0?null:(t=t.slice(0,15),n.jsxs(oe,{ref:e,css:{gap:"md",paddingLeft:"[48px]",flexWrap:"nowrap"},children:[n.jsx(oe,{css:{gap:"1.5",flexWrap:"wrap",opacity:s?1:.3,grayscale:s?0:.9,filter:"auto",transition:"fast",_groupHover:{opacity:1,grayscale:0},_groupFocusWithin:{opacity:1,grayscale:0}},children:t.map(({tag:l})=>n.jsx(qn,{tag:l,className:y({userSelect:"none",cursor:"pointer"}),onClick:r=>{r.stopPropagation(),o(`#${l}`),setTimeout(()=>{kn(e.current)},350)}},l))}),s&&n.jsx(ke,{size:"compact-xs",variant:"light",onClick:l=>{l.stopPropagation(),o(""),Do(e.current)},rightSection:n.jsx(Ut,{size:14}),children:"Clear"})]}))}function Sr(e){return e.match(/^(k|ki|kin|kind|kind:)$/)!=null}const b1=["#","kind:"],w1=g.memo(()=>{const e=yt(),t=je(),o=g.useRef(null),{ref:a,focused:i}=Kc(),[s,l]=W0(),r=Uc({scrollBehavior:"smooth",loop:!1});rl("keydown",c=>{try{!i&&(c.key==="Backspace"||c.key.startsWith("Arrow")||c.key.match(new RegExp("^\\p{L}$","u")))&&Do(o.current)}catch(p){console.warn(p)}});let d=[],u=!1;switch(!0){case s.startsWith("#"):{const c=s.toLocaleLowerCase().slice(1),p=t.tags.filter(h=>h.toLocaleLowerCase().includes(c));p.length===0?(u=!1,d=[n.jsx(ps,{children:"No tags found"},"empty-tags")]):(u=t.tags.some(h=>h.toLocaleLowerCase()===c),d=p.map(h=>n.jsxs(gs,{value:`#${h}`,children:[n.jsx(L,{component:"span",opacity:.5,mr:1,fz:"sm",children:"#"}),h]},h)));break}case s.startsWith("kind:"):case Sr(s):{const c=s.length>5?s.slice(5).toLocaleLowerCase():"";let p=ei(t.specification.elements);c&&(p=p.filter(h=>h.toLocaleLowerCase().includes(c))),p.length===0?(u=!1,d=[n.jsx(ps,{children:"No kinds found"},"empty-kinds")]):(u=p.some(h=>h.toLocaleLowerCase()===c),d=p.map(h=>n.jsxs(gs,{value:`kind:${h}`,children:[n.jsx(L,{component:"span",opacity:.5,mr:1,fz:"sm",children:"kind:"}),h]},h)));break}}return n.jsxs(Qc,{onOptionSubmit:c=>{l(c),r.resetSelectedOption(),b1.includes(c)||(r.closeDropdown(),setTimeout(()=>{kn(o.current)},350))},width:"max-content",position:"bottom-start",shadow:"md",offset:{mainAxis:4,crossAxis:50},store:r,withinPortal:!1,children:[n.jsx(Jc,{children:n.jsx(Ia,{ref:ni(o,a),placeholder:"Search by title, description or start with # or kind:",autoFocus:!0,"data-autofocus":!0,"data-likec4-search-input":!0,tabIndex:0,classNames:{input:h1},size:"lg",value:s,leftSection:n.jsx(Ei,{style:{width:Je(20)},stroke:2}),rightSection:n.jsx(Ia.ClearButton,{onClick:c=>{c.stopPropagation();const p=e.getSnapshot().context.openedWithSearch;s===""||s===p?e.send({type:"close"}):l("")}}),rightSectionPointerEvents:"auto",onChange:c=>{l(c.currentTarget.value),r.openDropdown(),r.updateSelectedOptionIndex()},onClick:()=>r.openDropdown(),onFocus:()=>r.openDropdown(),onBlur:()=>r.closeDropdown(),onKeyDownCapture:c=>{if(c.key==="Tab"){switch(!0){case r.getSelectedOptionIndex()>=0:return r.clickSelectedOption(),Ee(c);case d.length===1:return r.selectFirstOption()&&r.clickSelectedOption(),Ee(c);case Sr(s):return l("kind:"),Ee(c)}return}if(c.key==="Backspace"&&r.dropdownOpened){if(s==="kind:")return l(""),r.resetSelectedOption(),Ee(c);if(s.startsWith("kind:")&&u)return l("kind:"),r.resetSelectedOption(),Ee(c);if(s.startsWith("#")&&u)return l("#"),r.resetSelectedOption(),Ee(c)}if(c.key==="Escape"&&r.dropdownOpened&&d.length>0){Ee(c),r.closeDropdown();return}if(c.key==="ArrowUp"&&r.dropdownOpened&&s===""&&r.getSelectedOptionIndex()===0){r.closeDropdown(),Ee(c);return}if(c.key==="ArrowDown"&&(!r.dropdownOpened||d.length===0||u||s===""&&r.getSelectedOptionIndex()===d.length-1)){r.closeDropdown(),Ee(c),kn(o.current);return}}})}),n.jsx(eu,{hidden:d.length===0,style:{minWidth:300},children:n.jsx(tu,{children:n.jsx(We,{mah:"min(322px, calc(100cqh - 50px))",type:"scroll",children:d})})})]})}),v1=y({backgroundColor:"[rgb(34 34 34 / var(--_opacity, 95%))]",_light:{backgroundColor:"[rgb(250 250 250 / var(--_opacity, 95%))]"},backdropFilter:"auto",backdropBlur:"var(--_blur, 10px)"}),k1=y({width:"100%",height:"100%",maxHeight:"100vh",overflow:"hidden",display:"flex",flexDirection:"column",justifyContent:"stretch",gap:"sm",paddingTop:"[20px]",paddingLeft:"md",paddingRight:"md",paddingBottom:"sm",background:"[transparent]"}),j1=e=>!e.matches("inactive");function C1({searchActorRef:e}){const t=ne(e,j1),o=()=>{e.send({type:"open"})},a=A(()=>{e.send({type:"close"})});return yu([["mod+k",o,{preventDefault:!0}],["mod+f",o,{preventDefault:!0}]]),n.jsx(F0,{value:e,children:n.jsx(Pt.Overlays,{children:n.jsx(ci,{FallbackComponent:Fi,onReset:a,children:n.jsx(ue,{children:t&&n.jsx(bn,{fullscreen:!0,withBackdrop:!1,backdrop:{opacity:.9},classes:{dialog:v1,body:k1},openDelay:0,onClose:a,"data-likec4-search":"true",children:n.jsx(S1,{searchActorRef:e})})})})})})}const _r=y({height:["100%","100cqh"],"& .mantine-ScrollArea-viewport":{minHeight:"100%","& > div":{minHeight:"100%",height:"100%"}}}),S1=({searchActorRef:e})=>{const t=g.useRef(null),o=Y0();return sn(()=>{Se(e.getSnapshot().context.openedWithSearch)&&kn(t.current)},150),n.jsxs(K,{ref:t,display:"contents",children:[n.jsx(re,{className:"group",wrap:"nowrap",onClick:a=>{a.stopPropagation(),Do(t.current)},children:n.jsxs(Et,{flex:1,px:"sm",children:[n.jsx(w1,{}),n.jsx(x1,{})]})}),n.jsxs(fs,{children:[n.jsx(Lo,{span:6,children:n.jsx(io,{component:"div",order:6,c:"dimmed",pl:"sm",children:"Elements"})}),n.jsx(Lo,{span:6,children:n.jsx(io,{component:"div",order:6,c:"dimmed",pl:"sm",children:"Views"})})]}),n.jsxs(fs,{className:y({containerName:"likec4-search-elements",containerType:"size",overflow:"hidden",flexGrow:1}),children:[n.jsx(Lo,{span:6,children:n.jsx(Vt,{type:"scroll",className:_r,pr:"xs",scrollbars:"y",children:n.jsx(ue,{children:n.jsx(Xt,{id:"likec4-search-elements",children:n.jsx(c1,{})})})})}),n.jsx(Lo,{span:6,children:n.jsx(Vt,{type:"scroll",className:_r,pr:"xs",scrollbars:"y",children:n.jsx(ue,{children:n.jsx(Xt,{id:"likec4-search-views",children:n.jsx(d1,{})})})})})]}),o&&n.jsx(y1,{elementFqn:o})]})};function le(e){return{get syncLayoutActorRef(){return e.get("syncLayout")??null},get overlaysActorRef(){return e.get("overlays")??null},get diagramActorRef(){return W(e.get("diagram"),"Diagram actor not found")},get searchActorRef(){return e.get("search")??null}}}function qt(e,t){return e.view.nodes.find(o=>o.id===t)??null}function ns(e,t){return e.view.edges.find(o=>o.id===t)??null}function _1(e){const t=new Map,o=e.context.xynodes.reduce((a,i)=>{let s=i.position;if(i.parentId){const d=t.get(i.parentId)??{x:0,y:0};s={x:s.x+d.x,y:s.y+d.y}}if(t.set(i.id,s),i.hidden||i.data.dimmed)return a;const l=i.measured?.width??i.width??i.initialWidth,r=i.measured?.height??i.height??i.initialHeight;return a.minX=Math.min(a.minX,s.x),a.minY=Math.min(a.minY,s.y),a.maxX=Math.max(a.maxX,s.x+l),a.maxY=Math.max(a.maxY,s.y+r),a},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0});return o.minX===1/0?{bounds:e.context.view.bounds}:{duration:350,bounds:{x:o.minX-10,y:o.minY-10,width:o.maxX-o.minX+20,height:o.maxY-o.minY+20}}}const P1=32;function M1(e){const t=W(e.context.activeWalkthrough),o=W(e.context.xyedges.find(d=>d.id===t.stepId)),a=e.context.xystore.getState(),i=W(a.nodeLookup.get(o.source)),s=W(a.nodeLookup.get(o.target)),l=Nu([i,s],a);let r;if(t.parallelPrefix){const d=e.context.xynodes.find(u=>u.type==="seq-parallel"&&u.data.parallelPrefix===t.parallelPrefix);d&&(r={x:d.position.x,y:d.position.y,...at(d)})}return r??=N1(o,a),r?r=ht.merge(r,l):r=l,{duration:350,bounds:ht.expand(r,P1)}}function N1(e,t){const o=t.nodeLookup.get(e.source),a=t.nodeLookup.get(e.target);if(!o||!a)return null;const i=zu({id:e.id,sourceNode:o,targetNode:a,sourceHandle:e.sourceHandle||null,targetHandle:e.targetHandle||null,connectionMode:t.connectionMode});return i?ht.fromPoints([[i.sourceX,i.sourceY],[i.targetX,i.targetY]]):null}const I1=ot({delays:{"open timeout":({context:e})=>e.openTimeout,"close timeout":600,"long idle":1500},actions:{"update edgeId":T(({context:e,event:t})=>(z(t,["xyedge.select","xyedge.mouseEnter"]),{edgeId:t.edgeId,edgeSelected:e.edgeSelected||t.type==="xyedge.select"})),"increase open timeout":T(()=>({openTimeout:800})),"decrease open timeout":T(()=>({openTimeout:300})),"reset edgeId":T({edgeId:null,edgeSelected:!1})},guards:{"edge was selected":({context:e})=>e.edgeSelected,"edge was hovered":({context:e})=>!e.edgeSelected}}).createMachine({id:"breadcrumbs",context:()=>({edgeId:null,edgeSelected:!1,openTimeout:800}),initial:"idle",on:{close:{target:"#idle",actions:["reset edgeId","increase open timeout"]}},states:{idle:{id:"idle",on:{"xyedge.mouseEnter":{target:"opening",actions:"update edgeId"},"xyedge.select":{target:"active",actions:"update edgeId"}},after:{"long idle":{actions:"increase open timeout"}}},opening:{on:{"xyedge.mouseLeave":{target:"idle"},"xyedge.select":{target:"active",actions:"update edgeId"}},after:{"open timeout":{actions:"decrease open timeout",target:"active"}}},active:{tags:["opened"],initial:"opened",exit:"reset edgeId",on:{"xyedge.unselect":{target:"idle",actions:"increase open timeout"},"xyedge.select":{actions:"update edgeId"}},states:{opened:{on:{"dropdown.mouseEnter":{target:"hovered"},"xyedge.mouseLeave":{guard:"edge was hovered",target:"closing"}}},hovered:{on:{"dropdown.mouseLeave":[{guard:"edge was selected",target:"opened"},{target:"closing"}]}},closing:{on:{"xyedge.mouseEnter":{guard:"edge was hovered",target:"opened",actions:"update edgeId"},"xyedge.select":{target:"opened",actions:"update edgeId"},"dropdown.mouseEnter":{target:"hovered"}},after:{"close timeout":{target:"#idle"}}}}}}}),E1=I1,Pr=y({display:"block",fontSize:"xxs",fontWeight:500,whiteSpace:"nowrap",paddingX:"1",paddingY:"0.5",borderRadius:"[2px]",background:{_light:"var(--likec4-palette-fill)/90",_dark:"var(--likec4-palette-fill)/60"},lineHeight:"1",color:{_light:"var(--likec4-palette-hiContrast)",_dark:"var(--likec4-palette-loContrast)"}}),R1=y({whiteSpaceCollapse:"preserve-breaks",fontSize:"sm",lineHeight:"sm",userSelect:"all"});function D1(e){let t=null;for(const o of e.xyedges)if(o.selected){if(t){t=null;break}t=o.data.id}return{viewId:e.view.id,selected:t}}const B1=g.memo(()=>{const e=je(),t=ii(E1),o=H(),{viewId:a,selected:i}=Ve(D1),s=ne(t,f=>f.hasTag("opened")?f.context.edgeId:null);Me("navigateTo",()=>{t.send({type:"close"})}),Me("edgeMouseEnter",({edge:f})=>{t.send({type:"xyedge.mouseEnter",edgeId:f.data.id})}),Me("edgeMouseLeave",()=>{t.send({type:"xyedge.mouseLeave"})}),Me("walkthroughStarted",()=>{t.send({type:"close"})}),g.useEffect(()=>{i?t.send({type:"xyedge.select",edgeId:i}):t.send({type:"xyedge.unselect"})},[i]);const l=g.useCallback(f=>{if(!s)return;t.send({type:"dropdown.mouseEnter"});const x=o.findEdge(s);x&&!x.data.hovered&&o.send({type:"xyflow.edgeMouseEnter",edge:x,event:f})},[t,o,s]),r=g.useCallback(f=>{if(!s)return;t.send({type:"dropdown.mouseLeave"});const x=o.findEdge(s);x?.data.hovered&&o.send({type:"xyflow.edgeMouseLeave",edge:x,event:f})},[t,o,s]),{diagramEdge:d,sourceNode:u,targetNode:c}=Ve(f=>{const x=s?ns(f,s):null,w=x?qt(f,x.source):null,C=x?qt(f,x.target):null;return{diagramEdge:x,sourceNode:w,targetNode:C}},ee,[s]);if(!d||!u||!c||Ct(d.relations))return null;const[p,h]=ce(d.relations,ae(f=>{try{return e.relationship(f)}catch(x){return console.error(`View is cached and likec4model missing relationship ${f} from ${u.id} -> ${c.id}`,x),null}}),St(Se),ll(f=>f.source.id===u.id&&f.target.id===c.id));return p.length===0&&h.length===0?(console.warn("No relationships found  diagram edge",{diagramEdge:d,sourceNode:u,targetNode:c}),null):n.jsx(Ny,{children:n.jsx(T1,{viewId:a,direct:p,nested:h,diagramEdge:d,sourceNode:u,targetNode:c,onMouseEnter:l,onMouseLeave:r})})}),L1=(e,t)=>t?.querySelector(`.likec4-edge-label[data-edge-id="${e}"]`)??null,ka=8,T1=({viewId:e,diagramEdge:t,direct:o,nested:a,sourceNode:i,targetNode:s,onMouseEnter:l,onMouseLeave:r})=>{const d=g.useRef(null),{enableNavigateTo:u,enableVscode:c}=Z(),{onOpenSource:p}=Qt(),h=Xh(),[f,x]=g.useState(null);g.useLayoutEffect(()=>{x(L1(t.id,h.current))},[t]),g.useEffect(()=>{const v=f,k=d.current;if(!v||!k)return;let _=!1;const m=ou(v,k,()=>{nu(v,k,{placement:"bottom-start",middleware:[au(4),iu({crossAxis:!0,padding:ka,allowedPlacements:["bottom-start","top-start","right-start","right-end","left-end"]}),su({padding:ka,apply({availableHeight:b,availableWidth:j,elements:S}){_||Object.assign(S.floating.style,{maxWidth:`${ze(ut(j),{min:200,max:400})}px`,maxHeight:`${ze(ut(b),{min:0,max:500})}px`})}}),ru({padding:ka*2})]}).then(({x:b,y:j,middlewareData:S})=>{_||(k.style.transform=`translate(${ut(b)}px, ${ut(j)}px)`,k.style.visibility=S.hide?.referenceHidden?"hidden":"visible")})},{ancestorResize:!1,animationFrame:!0});return()=>{_=!0,m()}},[f]);const w=H(),C=g.useCallback((v,k)=>n.jsxs(g.Fragment,{children:[k>0&&n.jsx(yo,{}),n.jsx(A1,{viewId:e,relationship:v,sourceNode:i,targetNode:s,onNavigateTo:u?_=>{w.navigateTo(_)}:void 0,...p&&c&&{onOpenSource:()=>p({relation:v.id})}})]},v.id),[e,i,s,w,u,p,c]);return n.jsx(We,{ref:d,onMouseEnter:l,onMouseLeave:r,type:"auto",scrollbars:"y",scrollbarSize:6,styles:{viewport:{overscrollBehavior:"contain",minWidth:180}},className:P(y({layerStyle:"likec4.dropdown",p:"0",pointerEvents:{base:"all",_whenPanning:"none"},position:"absolute",top:"0",left:"0",width:"max-content",cursor:"default"})),children:n.jsxs(Et,{css:{gap:"3",padding:"4",paddingTop:"2"},children:[n.jsx(ke,{variant:"default",color:"gray",size:"compact-xs",style:{alignSelf:"flex-start",fontWeight:500,"--button-fz":"var(--font-sizes-xxs)"},onClick:v=>{v.stopPropagation(),w.openRelationshipDetails(t.id)},children:"browse relationships"}),o.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(Wt,{children:"DIRECT RELATIONSHIPS"}),o.map(C)]}),a.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(Wt,{css:{mt:o.length>0?"2":"0"},children:"RESOLVED FROM NESTED"}),a.map(C)]})]})})},A1=g.forwardRef(({viewId:e,relationship:t,sourceNode:o,targetNode:a,onNavigateTo:i,onOpenSource:s},l)=>{const r=Mr(t,"source",o),d=Mr(t,"target",a),u=i&&t.navigateTo?.id!==e?t.navigateTo?.id:void 0,c=t.links;return n.jsxs(Et,{ref:l,className:sd({block:"2",inline:"2",paddingY:"2.5",paddingX:"2",gap:"1",rounded:"sm",backgroundColor:{_hover:{base:"mantine.colors.gray[1]",_dark:"mantine.colors.dark[5]/70"}}}),children:[n.jsx(oe,{gap:"0.5",children:n.jsxs(Mn,{openDelay:200,children:[n.jsx(Yo,{label:r.full,offset:2,position:"top-start",children:n.jsx(L,{component:"div","data-likec4-color":o.color,className:Pr,children:r.short})}),n.jsx(Yt,{stroke:2.5,size:"11px",opacity:.65}),n.jsx(Yo,{label:d.full,offset:2,position:"top-start",children:n.jsx(L,{component:"div","data-likec4-color":a.color,className:Pr,children:d.short})}),u&&n.jsx(Yo,{label:"Open dynamic view",children:n.jsx(U,{size:"sm",radius:"sm",variant:"default",onClick:p=>{p.stopPropagation(),i?.(u)},style:{alignSelf:"flex-end"},role:"button",children:n.jsx(Le,{size:"80%",stroke:2})})}),s&&n.jsx(Yo,{label:"Open source",children:n.jsx(U,{size:"sm",radius:"sm",variant:"default",onClick:p=>{p.stopPropagation(),s()},role:"button",children:n.jsx(Kt,{size:"80%",stroke:2})})})]})}),n.jsx(K,{className:R1,children:t.title||"untitled"}),t.kind&&n.jsxs(oe,{gap:"2",children:[n.jsx(Wt,{children:"kind"}),n.jsx(L,{size:"xs",className:y({userSelect:"all"}),children:t.kind})]}),t.technology&&n.jsxs(oe,{gap:"2",children:[n.jsx(Wt,{children:"technology"}),n.jsx(L,{size:"xs",className:y({userSelect:"all"}),children:t.technology})]}),t.description.nonEmpty&&n.jsxs(n.Fragment,{children:[n.jsx(Wt,{children:"description"}),n.jsx(K,{css:{paddingLeft:"2.5",py:"1.5",borderLeft:"2px dotted",borderLeftColor:{base:"mantine.colors.gray[3]",_dark:"mantine.colors.dark[4]"}},children:n.jsx(Mt,{value:t.description,fontSize:"sm"})})]}),c.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(Wt,{children:"links"}),n.jsx(oe,{gap:"1",flexWrap:"wrap",children:c.map(p=>n.jsx(Zi,{size:"sm",value:p},p.url))})]})]})}),Wt=ft("div",{base:{display:"block",fontSize:"xxs",fontWeight:500,userSelect:"none",lineHeight:"sm",color:"mantine.colors.dimmed"}}),Yo=_e.withProps({color:"dark",fz:"xs",label:"",children:null,offset:8,withinPortal:!1});function Mr(e,t,o){const a=e.isDeploymentRelation()?o.id:o.modelRef||"",i=e[t].id,s=vi(a)+i.slice(a.length);return{full:i,short:s}}const z1=g.memo(()=>{const[{layout:e,isActive:t},{toggleCompare:o}]=Wi(),a=e==="manual"?"var(--mantine-color-orange-6)":"var(--mantine-color-green-6)";return n.jsx(K,{className:pe({position:"absolute",top:"0",left:"0",width:"full",height:"full",border:"default",borderWidth:4,pointerEvents:"none",alignItems:"flex-start",justifyContent:"center"}),style:{zIndex:"9999",display:t?void 0:"none",borderColor:a},children:n.jsx($1,{style:{backgroundColor:a},onClick:i=>{i.stopPropagation(),o()},children:"Close compare"})})}),$1=se.withProps({className:y({fontSize:"xs",fontWeight:"medium",py:"1.5",lineHeight:"1",borderBottomLeftRadius:"sm",borderBottomRightRadius:"sm",transform:"translateY(-4px)",px:"4",color:"mantine.colors.gray[9]",pointerEvents:"all",_active:{transform:"translateY(-3px)"}})}),ja=y({position:"absolute",bottom:"0",right:"0",padding:"2",margin:"0",width:"min-content",height:"min-content"}),F1=y({"--ai-radius":"0px",_noReduceGraphics:{"--ai-radius":"{radii.md}"}}),V1=y({cursor:"default",userSelect:"none",minWidth:200,maxWidth:"calc(100vw - 20px)",backgroundColor:"mantine.colors.body/80",sm:{minWidth:300,maxWidth:"65vw"},md:{maxWidth:"40vw"},_dark:{backgroundColor:"mantine.colors.dark[6]/80"}}),W1=y({padding:"xxs"}),O1=y({backgroundColor:"transparent",transition:"all 100ms ease-in",_hover:{transition:"all 120ms ease-out",backgroundColor:"mantine.colors.primary[2]/50"},_dark:{_hover:{backgroundColor:"mantine.colors.dark[3]/40"}}});y({fill:"var(--likec4-palette-fill)",stroke:"var(--likec4-palette-stroke)",strokeWidth:1,overflow:"visible",width:"100%",height:"auto",filter:`
    drop-shadow(0 2px 3px rgb(0 0 0 / 22%))
    drop-shadow(0 1px 8px rgb(0 0 0 / 10%))
  `});const H1=y({fontWeight:500,letterSpacing:"0.2px",paddingTop:"0",paddingBottom:"0",textTransform:"lowercase",transition:"all 150ms ease-in-out",cursor:"pointer","--badge-radius":"2px","--badge-fz":"9.5px","--badge-padding-x":"3px","--badge-height":"13.5px","--badge-lh":"1","--badge-bg":"var(--likec4-palette-fill)","--badge-color":"var(--likec4-palette-hiContrast)"}),X1=({value:e})=>{const{title:t,color:o="primary",shape:a="rectangle"}=e,[i,s]=g.useState(null),l=H(),r=300,d=200;return n.jsx(hu,{shadow:"none",px:"xs",py:"sm",className:P(O1),"data-likec4-color":o,onMouseEnter:()=>{s(null),l.highlightNotation(e)},onMouseLeave:()=>{s(null),l.unhighlightNotation()},children:n.jsxs(re,{gap:"sm",align:"stretch",wrap:"nowrap",children:[n.jsx(X,{flex:"0 0 70px",style:{position:"relative",width:70,height:mu(70*(d/r),0)},children:n.jsx(to,{data:{shape:a,width:r,height:d}})}),n.jsxs(Ne,{gap:4,flex:1,children:[n.jsx(re,{gap:4,flex:"0 0 auto",children:e.kinds.map(u=>n.jsx(pt,{className:P(H1),onMouseEnter:()=>{s(u),l.highlightNotation(e,u)},onMouseLeave:()=>{s(null),l.highlightNotation(e)},opacity:ml(i)&&i!==u?.25:1,children:u},u))}),n.jsx(L,{component:"div",fz:"sm",fw:500,lh:"1.25",style:{textWrap:"pretty"},children:t})]})]})})},Y1=e=>({id:e.view.id,notations:e.view.notation?.nodes??[]}),q1=g.memo(()=>{const e=$n(r=>r.height),{id:t,notations:o}=Ve(Y1),[a,i]=lu({key:"notation-webview-collapsed",defaultValue:!0}),s=o.length>0,l=Jt();return n.jsxs(ue,{children:[!s&&n.jsx(De.div,{initial:{opacity:.75,translateX:"50%"},animate:{opacity:1,translateX:0},exit:{translateX:"100%",opacity:.6},className:ja,children:n.jsx(_e,{label:"View has no notations",color:"orange",...l,children:n.jsx($e,{size:"lg",variant:"light",color:"orange",radius:"md",children:n.jsx($l,{})})})},"empty"),s&&a&&n.jsx(De.div,{initial:{opacity:.75,translateX:"50%"},animate:{opacity:1,translateX:0},exit:{translateX:"100%",opacity:.6},className:ja,children:n.jsx(_e,{label:"Show notation",color:"dark",fz:"xs",...l,children:n.jsx(U,{size:"lg",variant:"default",color:"gray",className:F1,onClick:()=>i(!1),children:n.jsx(Cg,{stroke:1.5})})})},"collapsed"),s&&!a&&n.jsx(De.div,{initial:{opacity:.75,scale:.2},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.25},className:P("react-flow__panel",ja),style:{transformOrigin:"bottom right"},children:n.jsx(li,{radius:"sm",withBorder:!0,shadow:"lg",className:V1,children:n.jsxs(dl,{defaultValue:"first",radius:"xs",children:[n.jsxs(cl,{children:[n.jsx(U,{size:"md",variant:"subtle",color:"gray",ml:2,style:{alignSelf:"center"},onClick:()=>i(!0),children:n.jsx(eg,{stroke:2})}),n.jsx(Ea,{value:"first",fz:"xs",children:"Elements"}),n.jsx(Ea,{value:"second",fz:"xs",disabled:!0,children:"Relationships"})]}),n.jsx(Ft,{value:"first",className:W1,hidden:a,children:n.jsx(We,{viewportProps:{style:{maxHeight:`min(40vh, ${Math.max(e-60,50)}px)`}},children:n.jsx(Ne,{gap:0,children:o.map((r,d)=>n.jsx(X1,{value:r},d))})})})]})})},t)]})}),fc=g.memo(()=>{const{enableControls:e,enableNotations:t,enableSearch:o,enableRelationshipDetails:a,enableReadOnly:i,enableCompareWithLatest:s}=Z(),l=du(),r=ld(),d=Cm(),u=g.useCallback(()=>{console.warn("DiagramUI: resetting error boundary and rerendering..."),l()},[]);return n.jsxs(rd,{onReset:u,children:[e&&n.jsx(Qd,{}),r&&n.jsx($0,{overlaysActorRef:r}),t&&n.jsx(q1,{}),o&&d&&n.jsx(C1,{searchActorRef:d}),a&&i&&n.jsx(B1,{}),s&&n.jsx(z1,{})]})});fc.displayName="DiagramUI";const G1=y({overflow:"visible",position:"absolute",pointerEvents:"none",top:"0",left:"0",mixBlendMode:"normal"}),Z1=y({fill:"var(--likec4-palette-relation-stroke)",stroke:"var(--likec4-palette-relation-stroke)",fillOpacity:.75,strokeWidth:1,cursor:"grab",pointerEvents:"auto",visibility:"hidden",_hover:{fillOpacity:1,stroke:"mantine.colors.primary.filledHover",strokeWidth:18,transition:"stroke 100ms ease-out, stroke-width 100ms ease-out"},":where([data-likec4-selected='true'], [data-likec4-hovered='true']) &":{visibility:"visible",transition:"fill-opacity 150ms ease-out, stroke 150ms ease-out, stroke-width 150ms ease-out",transitionDelay:"50ms",fillOpacity:1,strokeWidth:12}}),K1=y({cursor:"grabbing","& *":{cursor:"grabbing !important"},"& .react-flow__edge-interaction":{cursor:"grabbing !important"}});function U1({sourceX:e,sourceY:t,targetX:o,targetY:a,data:i}){const[s,l]=g.useState(()=>i.controlPoints??fn(i.points));It(()=>{const d=i.controlPoints??fn(i.points);l(u=>I(u,d)?u:d)},[i.controlPoints?.map(d=>`${d.x},${d.y}`).join("|")??"",i.points.map(d=>`${d[0]},${d[1]}`).join("|")]);const r=A(({x:d,y:u})=>{const c=we(e,t),p=we(o,a),h=[i.dir==="back"?p:c,...s.map(we)||[],i.dir==="back"?c:p],f=we(Math.round(d),Math.round(u));let x=0,w=1/0;for(let v=0;v<h.length-1;v++){const k=h[v],_=h[v+1],m=_.subtract(k),b=f.subtract(k),j=f.subtract(_);if(m.dot(b)*m.dot(j)<0){const S=Math.abs(m.cross(b).length()/m.length());S<w&&(w=S,x=v)}}const C=s.slice();return C.splice(x,0,{x:f.x,y:f.y}),l(C),C});return{controlPoints:s,setControlPoints:l,insertControlPoint:r}}const Q1=cu().curve(uu.alpha(.7)).x(e=>Math.round(e.x)).y(e=>Math.round(e.y)),J1=(e,t)=>Ds(e.sourceNode,t.sourceNode)&&Ds(e.targetNode,t.targetNode);function eb({props:{sourceX:e,sourceY:t,source:o,target:a,targetX:i,targetY:s,data:l},controlPoints:r,isControlPointDragging:d}){const{sourceNode:u,targetNode:c}=$n(g.useCallback(({nodeLookup:p})=>{const h=W(p.get(o),`source node ${o} not found`),f=W(p.get(a),`target node ${a} not found`);return{sourceNode:Rs(h),targetNode:Rs(f)}},[o,a]),J1);if(Se(l.controlPoints)||d){const p={x:e,y:t},h={x:i,y:s},f=6,x=l.dir==="back"?[h,ao(c,lo(r)??p,f),...r,ao(u,et(r)??h,f),p]:[p,ao(u,lo(r)??h,f),...r,ao(c,et(r)??p,f),h];return W(Q1(x))}return $h(l.points)}const Nr=e=>{const t=e.getPointAtLength(e.getTotalLength()*.5);return{x:Math.round(t.x),y:Math.round(t.y)}},yc=Gi(e=>{const[t,o]=g.useState(!1),a=Yl(),i=H(),{enableNavigateTo:s,enableReadOnly:l}=Z(),r=!l,{id:d,selected:u=!1,data:{hovered:c=!1,active:p=!1,labelBBox:h,labelXY:f,...x}}=e,w=s?x.navigateTo:void 0,{controlPoints:C,setControlPoints:v,insertControlPoint:k}=U1(e);let _=eb({props:e,controlPoints:C,isControlPointDragging:t}),m=h?.x??0,b=h?.y??0;const[j,S]=g.useState({x:f?.x??m,y:f?.y??b});It(()=>{S({x:m,y:b})},[m,b]);const D=g.useRef(null);ri(()=>{const E=D.current;!E||!t||S(Nr(E))},[_,t]),t&&(m=j.x,b=j.y);const M=A(E=>{const J=D.current?Nr(D.current):null;h&&J?i.updateEdgeData(d,{controlPoints:E,labelBBox:{...h,...J},labelXY:J}):i.updateEdgeData(d,{controlPoints:E}),i.stopEditing(!0),o(!1)}),Y=A(()=>{i.startEditing("edge"),o(!0)}),O=A(()=>{i.stopEditing(),o(!1)}),$=A(E=>{v(E),requestAnimationFrame(()=>{M(E)})}),N=A(E=>{i.startEditing("edge"),o(!0),v(E),requestAnimationFrame(()=>{M(E)})}),F=A(E=>{if(E.pointerType!=="mouse"||E.button!==2)return;E.stopPropagation(),E.preventDefault(),i.startEditing("edge");const J=k(a.screenToFlowPosition({x:E.clientX,y:E.clientY},{snapToGrid:!1}));i.updateEdgeData(d,{controlPoints:J}),i.stopEditing(!0)});return t&&!e.data.hovered&&(e={...e,data:{...e.data,hovered:!0}}),n.jsxs(n.Fragment,{children:[n.jsxs(Po,{...e,className:P(t&&K1),children:[n.jsx(No,{edgeProps:e,svgPath:_,ref:D,isDragging:t,...r&&{onEdgePointerDown:F}}),h&&n.jsx(Xn,{edgeProps:e,labelPosition:{x:m,y:b},children:n.jsx(Mo,{pointerEvents:r?"none":"all",edgeProps:e,children:!r&&w&&n.jsx(Hn,{onClick:E=>{E.stopPropagation(),i.navigateTo(w)}})})})]}),r&&C.length>0&&(u||p||c||t)&&n.jsx(tb,{edgeProps:e,controlPoints:C,onMove:v,onStartMove:Y,onCancelMove:O,onFinishMove:$,onDelete:N,zIndex:qe.Element+500})]})});yc.displayName="RelationshipEdge";function tb({edgeProps:e,controlPoints:t,onMove:o,onStartMove:a,onCancelMove:i,onFinishMove:s,onDelete:l,zIndex:r}){const d=Bi(),u=Yl(),c=e.data.id,p=(x,w,C)=>{let v=!1,k={x:w.clientX,y:w.clientY},_=null,m=t;const b=S=>{const D={x:S.clientX,y:S.clientY};ql(k,D)||(v||(v=!0,a()),k=D,_??=requestAnimationFrame(()=>{_=null,m=m.slice();const{x:M,y:Y}=u.screenToFlowPosition(k,{snapToGrid:!1});m[x]={x:Math.round(M),y:Math.round(Y)},o(m)})),S.stopPropagation()},j=S=>{S.stopPropagation(),C.removeEventListener("pointermove",b,{capture:!0}),C.removeEventListener("click",Ca,{capture:!0}),v?s(m):i()};C.addEventListener("pointermove",b,{capture:!0}),C.addEventListener("pointerup",j,{once:!0,capture:!0}),C.addEventListener("click",Ca,{capture:!0,once:!0})},h=(x,w)=>{if(t.length<=1)return;w.stopPropagation(),w.preventDefault();const C=t.slice();C.splice(x,1),setTimeout(()=>{l(C)},10)},f=A(x=>{const{domNode:w,addSelectedEdges:C}=d.getState();if(!w||x.pointerType!=="mouse")return;const v=parseFloat(x.currentTarget.getAttribute("data-control-point-index")||"");if(isNaN(v))throw new Error("data-control-point-index is not a number");switch(x.button){case 0:{x.stopPropagation(),C([c]),p(v,x,w);break}case 2:h(v,x);break}});return n.jsx(yl,{children:n.jsx(Po,{component:"svg",className:G1,...e,style:{...e.style,zIndex:r},children:n.jsx("g",{onContextMenu:Ca,children:t.map((x,w)=>n.jsx("circle",{"data-control-point-index":w,onPointerDownCapture:f,className:P("nodrag nopan",Z1),cx:x.x,cy:x.y,r:3},"controlPoints"+c+"#"+w))})})})}const Ca=e=>{e.stopPropagation(),e.preventDefault()},qo=16;function ob(e){const{enableNavigateTo:t}=Z(),o=H(),{navigateTo:a}=e.data,i=e.source===e.target,s=e.sourceX>e.targetX,[l]=Ju({sourceX:e.sourceX,sourceY:e.sourceY,sourcePosition:e.sourcePosition,targetX:e.targetX,targetY:e.targetY,targetPosition:e.targetPosition,...i&&{offset:30,borderRadius:16}});let r=e.sourceX;switch(!0){case i:r=e.sourceX+24+qo;break;case s:r=e.sourceX-qo;break;default:r=e.sourceX+qo;break}return n.jsxs(Po,{...e,children:[n.jsx(No,{edgeProps:e,svgPath:l}),n.jsx(Xn,{edgeProps:e,labelPosition:{x:r,y:e.sourceY+(i?0:qo),translate:s?"translate(-100%, 0)":void 0},children:n.jsx(Mo,{edgeProps:e,children:t&&a&&n.jsx(Hn,{onClick:d=>{d.stopPropagation(),o.navigateTo(a)}})})})]})}const bt={ElementNode:xy,DeploymentNode:by,CompoundElementNode:wy,CompoundDeploymentNode:vy,ViewGroupNode:ky,SequenceActorNode:_y,SequenceParallelArea:Py},Ir={RelationshipEdge:yc,SequenceStepEdge:ob};class Ot{static LeftPadding=42;static RightPadding=42;static TopPadding=60;static BottomPadding=42;id;minX=1/0;minY=1/0;maxX=-1/0;maxY=-1/0;initialX;initialY;get positionAbsolute(){return{x:this.minX,y:this.minY}}get initialPositionAbsolute(){return{x:this.initialX,y:this.initialY}}set positionAbsolute(t){const o=Math.round(t.x),a=Math.round(t.y);this.maxX+=o-this.minX,this.maxY+=a-this.minY,this.minX=o,this.minY=a}get dimensions(){return{width:this.maxX-this.minX,height:this.maxY-this.minY}}get diff(){return{x:this.positionAbsolute.x-this.initialX,y:this.positionAbsolute.y-this.initialY}}get isMoved(){return this.diff.x!==0||this.diff.y!==0}get position(){const t=this.positionAbsolute;if(!this.parent)return t;const o=this.parent.positionAbsolute;return{x:t.x-o.x,y:t.y-o.y}}constructor(t,o=null){this.id=t.id,this.positionAbsolute=o?{x:t.position.x+o.minX,y:t.position.y+o.minY}:t.position;const{width:a,height:i}=at(t);this.maxX=this.minX+Math.ceil(a),this.maxY=this.minY+Math.ceil(i),this.initialX=this.positionAbsolute.x,this.initialY=this.positionAbsolute.y,o&&o.children.push(this)}}class Go extends Ot{constructor(t,o=null){super(t,o),this.parent=o}children=[]}class nb extends Ot{constructor(t,o=null){super(t,o),this.parent=o}}function Er(e,t){return o=>{const a=W(o.get(e.id),`Edge ${e.id} not found`),{x:i,y:s}=t.diff;return i===0&&s===0?{id:e.id,type:"replace",item:un(a,l=>{l.data.points=e.data.points,l.data.controlPoints=e.data.controlPoints,l.data.labelXY=e.data.labelXY,l.data.labelBBox=e.data.labelBBox})}:{id:e.id,type:"replace",item:un(a,l=>{l.data.points=ae(e.data.points,r=>[r[0]+i,r[1]+s]),e.data.controlPoints&&(l.data.controlPoints=(e.data.controlPoints??[]).map(r=>({x:r.x+i,y:r.y+s}))),e.data.labelXY&&(l.data.labelXY={x:e.data.labelXY.x+i,y:e.data.labelXY.y+s}),e.data.labelBBox&&(l.data.labelBBox={x:e.data.labelBBox.x+i,y:e.data.labelBBox.y+s,width:e.data.labelBBox.width,height:e.data.labelBBox.height})})}}}function xc(e,t){const{parentLookup:o,nodeLookup:a,edges:i,edgeLookup:s}=e.getState(),l=new Map,r=new hn(m=>{let b=a.get(m)?.parentId;return b?[b,...r.get(b)]:[]}),d=new hn(m=>{const b=o.get(m);if(!b||b.size===0)return new Set;const j=new Set;for(const S of b.values()){j.add(S.id);for(const D of d.get(S.id))j.add(D)}return j}),u=new Set(t.flatMap(m=>r.get(m))),c=[...a.values()].flatMap(m=>m.parentId?[]:{xynode:m,parent:null});for(;c.length>0;){const{xynode:m,parent:b}=c.shift();if(!t.includes(m.id)&&u.has(m.id)){const j=new Go(m,b);l.set(m.id,j),o.get(m.id)?.forEach(S=>{c.push({xynode:S,parent:j})})}else l.set(m.id,new nb(m,b))}const p=[...l.values()],h=new Map;for(const m of p){if(m instanceof Go)continue;const b=d.get(m.id);b.size!==0&&ce(i,St(j=>!h.has(j)&&b.has(j.source)&&b.has(j.target)),Iu(j=>{h.set(j,Er(j,m))}))}const f=m=>l.get(m)??r.get(m).map(b=>l.get(b)).find(b=>!!b)??null,x=new Set(t.flatMap(m=>[m,...d.get(m)]));for(const m of i){if(h.has(m))continue;const b=x.has(m.source),j=x.has(m.target);if(b&&j){let S=l.get(m.source)??l.get(m.target)??r.get(m.source).map(D=>l.get(D)).find(D=>!!D)??r.get(m.target).map(D=>l.get(D)).find(D=>!!D);S&&h.set(m,Er(m,S));continue}if(b!==j){const S=f(b?m.source:m.target);if(!S)continue;const D=m.data.controlPoints??fn(m.data.points),M=W(a.get(m.source),`Source node ${m.source} not found`),Y=W(a.get(m.target),`Target node ${m.target} not found`),O=we(Bs(M,Y)),$=we(Bs(Y,M)),[N,F]=b?[O,$]:[$,O],E=N.subtract(F),J=E.length();h.set(m,Ce=>{const xe=W(Ce.get(m.id),`Edge ${m.id} not found`),{x:Ze,y:de}=S.diff;if(Ze===0&&de===0)return{id:m.id,type:"replace",item:un(xe,te=>{te.data.points=m.data.points,te.data.controlPoints=m.data.controlPoints,te.data.labelXY=m.data.labelXY,te.data.labelBBox=m.data.labelBBox})};const Dt=we(Ze,de),V=te=>{const Bt=we(te),oo=Bt.subtract(F).dot(E),aa=Math.min(oo/J**2,1),Lt=Bt.add(Dt.multiply(aa));return{x:Math.round(Lt.x),y:Math.round(Lt.y)}};return{id:m.id,type:"replace",item:un(xe,te=>{if(te.data.controlPoints=D.map(V),m.data.labelBBox){const{x:Bt,y:oo}=V(m.data.labelBBox);te.data.labelBBox={x:Bt,y:oo,width:m.data.labelBBox.width,height:m.data.labelBBox.height}}m.data.labelXY&&(te.data.labelXY=V(m.data.labelXY))})}});continue}}function w(m){for(const b of m){if(!(b instanceof Go))continue;w(b.children);const j={minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};for(const S of b.children)j.minX=Math.min(j.minX,S.minX),j.minY=Math.min(j.minY,S.minY),j.maxX=Math.max(j.maxX,S.maxX),j.maxY=Math.max(j.maxY,S.maxY);b.minX=j.minX-Ot.LeftPadding,b.minY=j.minY-Ot.TopPadding,b.maxX=j.maxX+Ot.RightPadding,b.maxY=j.maxY+Ot.BottomPadding}}const C=[...h.values()];function v(){w(p);const m=p.reduce((j,S)=>(j.push({id:S.id,type:"position",dragging:!1,position:S.position,positionAbsolute:S.positionAbsolute}),S instanceof Go&&j.push({id:S.id,type:"dimensions",setAttributes:!0,dimensions:S.dimensions}),j),[]);e.getState().triggerNodeChanges(m);const b=C.map(j=>j(s));b.length>0&&e.getState().triggerEdgeChanges(b)}let k=null;function _(){p.length!==0&&(k??=requestAnimationFrame(()=>{k=null;for(const m of t){const b=W(l.get(m)),j=W(a.get(m));b.positionAbsolute=j.internals.positionAbsolute}v()}))}return{rects:l,onMove:_,updateXYFlow:v}}function ab(){const e=Bi(),t=H(),o=g.useRef(void 0);return g.useMemo(()=>({onNodeDragStart:(a,i)=>{t.startEditing("node");const{nodeLookup:s}=e.getState(),l=ce(Array.from(s.values()),St(r=>r.draggable!==!1&&(r.dragging===!0||r.id===i.id||r.selected===!0)));ve(l,1)&&(o.current=xc(e,ae(l,r=>r.id)))},onNodeDrag:a=>{o.current?.onMove()},onNodeDragStop:a=>{const i=o.current?cp(o.current.rects.values(),s=>s.isMoved):!1;t.stopEditing(i),o.current=void 0}}),[e,t])}const ib={relationship:Ir.RelationshipEdge,"seq-step":Ir.SequenceStepEdge},dt={element:Ue(bt.ElementNode),deployment:Ue(bt.DeploymentNode),"compound-element":Ue(bt.CompoundElementNode),"compound-deployment":Ue(bt.CompoundDeploymentNode),"view-group":Ue(bt.ViewGroupNode),"seq-actor":Ue(bt.SequenceActorNode),"seq-parallel":Ue(bt.SequenceParallelArea)};function sb(e){return!e||Ct(e)?dt:{element:e.element??dt.element,deployment:e.deployment??dt.deployment,"compound-element":e.compoundElement??dt["compound-element"],"compound-deployment":e.compoundDeployment??dt["compound-deployment"],"view-group":e.viewGroup??dt["view-group"],"seq-actor":e.seqActor??dt["seq-actor"],"seq-parallel":e.seqParallel??dt["seq-parallel"]}}const rb=({context:e,children:t})=>{const o=e.toggledFeatures,a=e.features.enableReadOnly||o.enableReadOnly===!0,i=a||t.syncLayout?.getSnapshot().context.editing!=="edge";return{enableReadOnly:a,initialized:e.initialized.xydata&&e.initialized.xyflow,nodes:e.xynodes,edges:e.xyedges,pannable:e.pannable,zoomable:e.zoomable,nodesDraggable:!a&&e.nodesDraggable,nodesSelectable:e.nodesSelectable&&i,fitViewPadding:e.fitViewPadding,enableFitView:e.toggledFeatures.enableFitView??e.features.enableFitView,...!e.features.enableFitView&&{viewport:{x:-Math.min(e.view.bounds.x,0),y:-Math.min(e.view.bounds.y,0),zoom:1}}}},lb=(e,t)=>e.enableReadOnly===t.enableReadOnly&&e.initialized===t.initialized&&e.pannable===t.pannable&&e.zoomable===t.zoomable&&e.nodesDraggable===t.nodesDraggable&&e.nodesSelectable===t.nodesSelectable&&e.enableFitView===t.enableFitView&&ee(e.fitViewPadding,t.fitViewPadding)&&ee(e.nodes,t.nodes)&&ee(e.edges,t.edges)&&ee(e.viewport??null,t.viewport??null);function db({background:e="dots",reactFlowProps:t={},children:o,renderNodes:a}){const i=H();let{enableReadOnly:s,initialized:l,nodes:r,edges:d,enableFitView:u,nodesDraggable:c,nodesSelectable:p,...h}=Vi(rb,lb);const{onNodeContextMenu:f,onCanvasContextMenu:x,onEdgeContextMenu:w,onNodeClick:C,onEdgeClick:v,onCanvasClick:k,onCanvasDblClick:_}=Qt(),m=qh(),b=ab(),j=Zh(),S=Ku(()=>{j.set(!0)},m?120:400),D=Uu(()=>{S.clear(),j.set(!1)},m?350:200),M=A(N=>{N&&(j.get()||S.start(),D())}),Y=A((N,F)=>{S.clear(),i.send({type:"xyflow.viewportMoved",viewport:F,manually:!!N})}),O=A(()=>{i.send({type:"xyflow.resized"})}),$=xi(()=>sb(a),[a],Xl);return It(()=>{console.warn("renderNodes changed - this might degrade performance")},[$]),n.jsx(Li,{nodes:r,edges:d,className:P(l?"initialized":"not-initialized"),nodeTypes:$,edgeTypes:ib,onNodesChange:A(N=>{i.send({type:"xyflow.applyNodeChanges",changes:N})}),onEdgesChange:A(N=>{i.send({type:"xyflow.applyEdgeChanges",changes:N})}),background:l?e:"transparent",fitView:!1,onNodeClick:A((N,F)=>{N.stopPropagation(),i.send({type:"xyflow.nodeClick",node:F}),C?.(i.findDiagramNode(F.id),N)}),onEdgeClick:A((N,F)=>{N.stopPropagation(),i.send({type:"xyflow.edgeClick",edge:F}),v?.(i.findDiagramEdge(F.id),N)}),onEdgeDoubleClick:A((N,F)=>{N.stopPropagation(),i.send({type:"xyflow.edgeDoubleClick",edge:F})}),onPaneClick:A(N=>{N.stopPropagation(),i.send({type:"xyflow.paneClick"}),k?.(N)}),onDoubleClick:A(N=>{N.stopPropagation(),N.preventDefault(),i.send({type:"xyflow.paneDblClick"}),_?.(N)}),onNodeMouseEnter:A((N,F)=>{N.stopPropagation(),i.send({type:"xyflow.nodeMouseEnter",node:F})}),onNodeMouseLeave:A((N,F)=>{N.stopPropagation(),i.send({type:"xyflow.nodeMouseLeave",node:F})}),onEdgeMouseEnter:A((N,F)=>{N.stopPropagation(),i.send({type:"xyflow.edgeMouseEnter",edge:F,event:N})}),onEdgeMouseLeave:A((N,F)=>{N.stopPropagation(),i.send({type:"xyflow.edgeMouseLeave",edge:F,event:N})}),onMove:M,onMoveEnd:Y,onInit:A(N=>{i.send({type:"xyflow.init",instance:N})}),onNodeContextMenu:A((N,F)=>{const E=W(i.findDiagramNode(F.id),`diagramNode ${F.id} not found`);f?.(E,N)}),onEdgeContextMenu:A((N,F)=>{const E=W(i.findDiagramEdge(F.id),`diagramEdge ${F.id} not found`);w?.(E,N)}),...x&&{onPaneContextMenu:x},...u&&{onViewportResize:O},nodesDraggable:c,nodesSelectable:p,elevateEdgesOnSelect:!s,...c&&b,...h,...t,children:o})}function cb(e){const{view:t}=e,o=[],a=[],i=new Map,s=ji.from(t.nodes.reduce((c,p)=>(i.set(p.id,p),p.parent||c.push({node:p,parent:null}),c),[]));let l=c=>!0;if(e.where)try{const c=up(e.where);l=p=>c({...wl(p,["tags","kind"]),..."source"in p?{source:d(p.source)}:p,..."target"in p?{target:d(p.target)}:p})}catch(c){console.error("Error in where filter:",c)}const r="",d=c=>W(i.get(c),`Node not found: ${c}`);let u;for(;u=s.dequeue();){const{node:c,parent:p}=u,h=ve(c.children,1)||c.kind==tn;if(h)for(const j of c.children)s.enqueue({node:d(j),parent:c});const f={x:c.x,y:c.y};p&&(f.x-=p.x,f.y-=p.y);const x=r+c.id,w=c.drifts??null,C={id:x,deletable:!1,position:f,zIndex:h?qe.Compound:qe.Element,style:{width:c.width,height:c.height},initialWidth:c.width,initialHeight:c.height,hidden:c.kind!==tn&&!l(c),...p&&{parentId:r+p.id}},v={viewId:t.id,id:c.id,title:c.title,color:c.color,shape:c.shape,style:c.style,depth:c.depth??0,icon:c.icon??"none",tags:c.tags??null,x:c.x,y:c.y},k={viewId:t.id,id:c.id,title:c.title,technology:c.technology??null,description:Ge.from(c.description),height:c.height,width:c.width,level:c.level,color:c.color,shape:c.shape,style:c.style,icon:c.icon??null,tags:c.tags,x:c.x,y:c.y,isMultiple:c.style?.multiple??!1};if(c.kind===tn){o.push({...C,type:"view-group",data:{isViewGroup:!0,...v},dragHandle:".likec4-compound-title-container"});continue}const _=c.modelRef??null,m=c.deploymentRef??null;if(!_&&!m)throw console.error("Invalid node",c),new Error("Element should have either modelRef or deploymentRef");const b={navigateTo:c.navigateTo??null};switch(!0){case(h&&!!m):{o.push({...C,type:"compound-deployment",data:{...v,...b,deploymentFqn:m,modelFqn:_,drifts:w}});break}case h:{q(!!_,"ModelRef expected"),o.push({...C,type:"compound-element",data:{...v,...b,modelFqn:_,drifts:w}});break}case!!m:{o.push({...C,type:"deployment",data:{...k,...b,deploymentFqn:m,modelFqn:_,drifts:w}});break}default:q(!!_,"ModelRef expected"),o.push({...C,type:"element",data:{...k,...b,modelFqn:_,drifts:w}})}}for(const c of t.edges){const p=c.source,h=c.target,f=r+c.id;if(!ve(c.points,2)){console.error("edge should have at least 2 points",c);continue}a.push({id:f,type:"relationship",source:r+p,target:r+h,zIndex:qe.Edge,hidden:!l(c),deletable:!1,data:{id:c.id,label:c.label,technology:c.technology,notes:Ge.from(c.notes),navigateTo:c.navigateTo,controlPoints:c.controlPoints??null,labelBBox:c.labelBBox??null,labelXY:c.labelBBox?{x:c.labelBBox.x,y:c.labelBBox.y}:null,points:c.points,color:c.color??"gray",line:c.line??"dashed",dir:c.dir??"forward",head:c.head??"normal",tail:c.tail??"none",astPath:c.astPath,drifts:c.drifts??null},interactionWidth:20})}return{bounds:t.bounds,xynodes:o,xyedges:a}}const bc={parallel:1,actor:10},jn={default:"gray",active:"amber"};function ub(e){const{actors:t,steps:o,compounds:a,parallelAreas:i,bounds:s}=e.sequenceLayout,l=[],r=[],d=u=>W(e.nodes.find(c=>c.id===u));for(const u of a)l.push(pb(u,d(u.origin),e));for(const u of i)l.push(gb(u,e));for(const u of t)l.push(hb(u,d(u.id),s,e));for(const u of o){const c=e.edges.find(p=>p.id===u.id);if(!c)throw new Error(`Edge ${u.id} not found`);r.push(mb(u,c))}return{bounds:s,xynodes:l,xyedges:r}}function pb({id:e,x:t,y:o,width:a,height:i,depth:s},l,r){return{id:e,type:"view-group",data:{id:l.id,title:l.title,color:l.color??"gray",shape:l.shape,style:l.style,tags:l.tags,x:t,y:o,viewId:r.id,depth:s,isViewGroup:!0},position:{x:t,y:o},draggable:!1,selectable:!1,focusable:!1,style:{pointerEvents:"none"},width:a,initialWidth:a,height:i,initialHeight:i}}function gb({parallelPrefix:e,x:t,y:o,width:a,height:i},s){return{id:`seq-parallel-${e}`,type:"seq-parallel",data:{id:`seq-parallel-${e}`,title:"PARALLEL",technology:null,color:jn.default,shape:"rectangle",style:{},tags:[],x:t,y:o,level:0,icon:null,width:a,height:i,description:Ge.EMPTY,viewId:s.id,parallelPrefix:e},zIndex:bc.parallel,position:{x:t,y:o},draggable:!1,deletable:!1,selectable:!1,focusable:!1,style:{pointerEvents:"none"},width:a,initialWidth:a,height:i,initialHeight:i}}function hb({id:e,x:t,y:o,width:a,height:i,ports:s},l,r,d){return{id:e,type:"seq-actor",data:{id:l.id,x:t,y:o,level:0,icon:l.icon??null,isMultiple:l.style.multiple??!1,title:l.title,width:a,height:i,color:l.color,navigateTo:l.navigateTo??null,shape:l.shape,style:l.style,tags:l.tags,modelFqn:l.modelRef??null,technology:l.technology??null,description:Ge.from(l.description),viewHeight:r.height,viewId:d.id,ports:s},deletable:!1,selectable:!0,zIndex:bc.actor,position:{x:t,y:o},width:a,initialWidth:a,height:i,initialHeight:i}}function mb({id:e,labelBBox:t,sourceHandle:o,targetHandle:a},i){return{id:e,type:"seq-step",data:{id:e,label:i.label,technology:i.technology,notes:Ge.from(i.notes),navigateTo:i.navigateTo,controlPoints:null,labelBBox:{x:0,y:0,width:t?.width??i.labelBBox?.width??32,height:t?.height??i.labelBBox?.height??32},labelXY:null,points:i.points,color:i.color,line:i.line,dir:"forward",head:i.head??"normal",tail:i.tail??"none",astPath:i.astPath},selectable:!0,focusable:!1,zIndex:20,interactionWidth:40,source:i.source,sourceHandle:o,target:i.target,targetHandle:a}}function fb({dynamicViewVariant:e,...t}){const o=t.view,a=o._type==="dynamic",{bounds:i,xynodes:s,xyedges:l}=a&&e==="sequence"?ub(o):cb(t);return a&&o.variant!==e?{view:{...o,bounds:i,variant:e},xynodes:s,xyedges:l}:{view:i===o.bounds?o:{...o,bounds:i},xynodes:s,xyedges:l}}function Rr(e){return{actor:e,send:t=>e.send(t),navigateTo:(t,o)=>{e.send({type:"navigate.to",viewId:t,...o&&{fromNode:o}})},navigate:t=>{e.send({type:`navigate.${t}`})},fitDiagram:(t=350)=>{e.send({type:"fitDiagram",duration:t})},openRelationshipsBrowser:t=>{e.send({type:"open.relationshipsBrowser",fqn:t})},openSource:t=>{e.send({type:"open.source",...t})},openElementDetails:(t,o)=>{e.send({type:"open.elementDetails",fqn:t,fromNode:o})},openRelationshipDetails:(...t)=>{t.length===1?e.send({type:"open.relationshipDetails",params:{edgeId:t[0]}}):e.send({type:"open.relationshipDetails",params:{source:t[0],target:t[1]}})},updateNodeData:(t,o)=>{e.send({type:"update.nodeData",nodeId:t,data:o})},updateEdgeData:(t,o)=>{e.send({type:"update.edgeData",edgeId:t,data:o})},startEditing:t=>{const o=le(e.system).syncLayoutActorRef;q(o,"No sync layout actor found in diagram actor system"),o.send({type:"editing.start",subject:t})},stopEditing:(t=!1)=>{const o=le(e.system).syncLayoutActorRef;q(o,"No sync layout actor found in diagram actor system"),o.send({type:"editing.stop",wasChanged:t})},undoEditing:()=>{const t=le(e.system).syncLayoutActorRef;q(t,"No sync layout actor found in diagram actor system");const o=t.getSnapshot().context.history.length>0;return o&&t.send({type:"undo"}),o},align:t=>{e.send({type:"layout.align",mode:t})},resetEdgeControlPoints:()=>{e.send({type:"layout.resetEdgeControlPoints"})},focusNode:t=>{e.send({type:"focus.node",nodeId:t})},get currentView(){return e.getSnapshot().context.view},getSnapshot:()=>e.getSnapshot(),getContext:()=>e.getSnapshot().context,findDiagramNode:t=>qt(e.getSnapshot().context,t),findEdge:t=>e.getSnapshot().context.xyedges.find(o=>o.data.id===t)??null,findDiagramEdge:t=>ns(e.getSnapshot().context,t),startWalkthrough:()=>{e.send({type:"walkthrough.start"})},walkthroughStep:(t="next")=>{e.send({type:"walkthrough.step",direction:t})},stopWalkthrough:()=>{e.send({type:"walkthrough.end"})},toggleFeature:(t,o)=>{e.send({type:"toggle.feature",feature:t,...o!==void 0&&{forceValue:o}})},highlightNotation:(t,o)=>{e.send({type:"notations.highlight",notation:t,...o&&{kind:o}})},unhighlightNotation:()=>{e.send({type:"notations.unhighlight"})},openSearch:t=>{e.send({type:"open.search",...t&&{search:t}})},triggerChange:t=>{e.send({type:"emit.onChange",change:t})},switchDynamicViewVariant:t=>{e.send({type:"switch.dynamicViewVariant",variant:t})}}}function yb({context:e,event:t}){z(t,"update.view");const o=t.view,a=e.view.id===o.id,i=e.xynodes,s=t.xynodes.map(r=>{const d=i.find(u=>u.id===r.id);if(d){if(d===r)return d;const{width:u,height:c}=at(d);return I(d.type,r.type)&&I(u,r.initialWidth)&&I(c,r.initialHeight)&&I(d.hidden??!1,r.hidden??!1)&&I(d.position,r.position)&&I(d.data,r.data)&&I(d.parentId??null,r.parentId??null)?d:{...gt(d,["measured","parentId","hidden"]),...r,width:r.initialWidth,height:r.initialHeight}}return r});let l=t.xyedges;if(a&&(!o.drifts||o.drifts.length===0)){const r=e.xyedges;l=t.xyedges.map(d=>{const u=r.find(c=>c.id===d.id);return u===d?u:u&&u.type===d.type?I(u.hidden??!1,d.hidden??!1)&&I(u.data,d.data)&&I(u.source,d.source)&&I(u.target,d.target)&&I(u.sourceHandle,d.sourceHandle)&&I(u.targetHandle,d.targetHandle)?u:{...gt(u,["hidden","sourceHandle","targetHandle"]),...d,data:{...u.data,...d.data}}:d})}return{xynodes:s,xyedges:l,view:o}}function xb(e){const{xynodes:t,xyedges:o,focusedNode:a}=e.context;if(!a)return{};const i=new Set([a]),s=o.map(l=>l.source===a||l.target===a?(i.add(l.source),i.add(l.target),G.setData(l,{dimmed:!1,active:!0})):G.setData(l,{dimmed:!0,active:!1}));return{xynodes:t.map(l=>G.setDimmed(l,!i.has(l.id))),xyedges:s}}function wc({context:e,event:t}){z(t,"update.view");let{navigationHistory:{currentIndex:o,history:a},lastOnNavigate:i,viewport:s}=e;const l=a[o];if(!l)return{navigationHistory:{currentIndex:0,history:[{viewId:t.view.id,fromNode:null,viewport:{...s}}]}};if(l.viewId!==t.view.id){if(!i){const r=o>0?W(a[o-1]):null;if(r&&r.viewId===t.view.id)return{navigationHistory:{currentIndex:o-1,history:a},lastOnNavigate:{fromView:l.viewId,toView:r.viewId,fromNode:l.fromNode}};const d=o<a.length-1?W(a[o+1]):null;if(d&&d.viewId===t.view.id)return{navigationHistory:{currentIndex:o+1,history:a},lastOnNavigate:{fromView:l.viewId,toView:d.viewId,fromNode:d.fromNode}}}return a=[...a.slice(0,o+1),{viewId:t.view.id,fromNode:i?.fromNode??null,viewport:{...s}}],o=a.length-1,{navigationHistory:{currentIndex:o,history:a}}}return{}}function bb({context:e}){const{navigationHistory:{currentIndex:t,history:o}}=e;q(t>0,"Cannot navigate back");const a=o[t],i=o[t-1];return{navigationHistory:{currentIndex:t-1,history:o},lastOnNavigate:{fromView:a.viewId,toView:i.viewId,fromNode:a.fromNode}}}function wb({context:e}){const{navigationHistory:{currentIndex:t,history:o}}=e;q(t<o.length-1,"Cannot navigate forward");const a=o[t],i=o[t+1];return{navigationHistory:{currentIndex:t+1,history:o},lastOnNavigate:{fromView:a.viewId,toView:i.viewId,fromNode:i.fromNode}}}function vb({context:e,event:t}){return console.log("updateNodeData called",t),z(t,"update.nodeData"),{xynodes:e.xynodes.map(o=>{if(o.id!==t.nodeId)return o;const a=vl(o.data,t.data);return I(a,o.data)?o:{...o,data:a}})}}function kb({context:e,event:t}){return z(t,"update.edgeData"),{xyedges:e.xyedges.map(o=>{if(o.id!==t.edgeId)return o;const a=vl(o.data,t.data);return I(a,o.data)?o:{...o,data:a}})}}function Dr(e,t,o){const a=at(e),i=a.width/2/o.x,s=a.height/2/o.y,l=Math.min(Math.abs(i),Math.abs(s));return we(o).multiply(l).add(t)}function vc(e,t){const o=W(e.get(t.source),`Source node ${t.source} not found`),a=W(e.get(t.target),`Target node ${t.target} not found`),i=we(po(o)),s=we(po(a));if(o===a){const u=we(0,o.height||0).multiply(-.5).add(i);return[u.add(we(-80/2.5,-80)),u.add(we(80/2.5,-80))]}const l=s.subtract(i),r=Dr(o,i,l),d=Dr(a,s,l.multiply(-1));return[r.add(d.subtract(r).multiply(.4))]}function jb({context:e}){const{stepId:t,parallelPrefix:o}=W(e.activeWalkthrough,"activeWalkthrough is null"),a=W(e.xyedges.find(i=>i.id===t));return{xyedges:e.xyedges.map(i=>{const s=t===i.id||!!o&&i.id.startsWith(o);return G.setData(i,{active:s,dimmed:t!==i.id})}),xynodes:e.xynodes.map(i=>{const s=a.source!==i.id&&a.target!==i.id;return i.type==="seq-parallel"?G.setData(i,{color:o===i.data.parallelPrefix?jn.active:jn.default,dimmed:s}):G.setDimmed(i,s)})}}class kc{}class $t extends kc{constructor(t,o,a){super(),this.getEdgePosition=t,this.computePosition=o,this.propertyToEdit=a}alignTo;computeLayout(t){this.alignTo=this.getEdgePosition(t)}applyPosition(t){return{[this.propertyToEdit]:this.computePosition(this.alignTo,t)}}}class Cb extends kc{layout=new Map;axisPreset;get primaryAxisCoord(){return this.axisPreset.primaryAxisCoord}get secondaryAxisCoord(){return this.axisPreset.secondaryAxisCoord}get primaryAxisDimension(){return this.axisPreset.primaryAxisDimension}get secondaryAxisDimension(){return this.axisPreset.secondaryAxisDimension}constructor(t){super(),this.axisPreset=t==="Column"?{primaryAxisDimension:"width",secondaryAxisDimension:"height",primaryAxisCoord:"x",secondaryAxisCoord:"y"}:{primaryAxisDimension:"height",secondaryAxisDimension:"width",primaryAxisCoord:"y",secondaryAxisCoord:"x"}}applyPosition(t){return this.layout?.get(t.id)??{}}computeLayout(t){const o=ce(t,cn(s=>s[this.primaryAxisCoord])),a=this.getLayoutRect(o),i=this.getLayers(o);this.layout=this.buildLayout(i,a,o)}getLayoutRect(t){const o=Math.min(...t.map(l=>l.x)),a=Math.min(...t.map(l=>l.y)),i=Math.max(...t.map(l=>l.x+l.width)),s=Math.max(...t.map(l=>l.y+l.height));return{x:o,y:a,width:i-o,height:s-a}}getLayers(t){const o=[];let a=0,i=null;for(let s of t)if(i&&s[this.primaryAxisCoord]<a)i.nodes.push(s),i.primaryAxisSize=Math.max(i.primaryAxisSize,s[this.primaryAxisDimension]),i.occupiedSpace+=s[this.secondaryAxisDimension],a=Math.max(s[this.primaryAxisCoord]+s[this.primaryAxisDimension],a);else{i={primaryAxisSize:s[this.primaryAxisDimension],nodes:[s],occupiedSpace:s[this.secondaryAxisDimension],layout:null},o.push(i),a=s[this.primaryAxisCoord]+s[this.primaryAxisDimension];continue}return o.forEach(s=>s.nodes.sort((l,r)=>l[this.secondaryAxisCoord]-r[this.secondaryAxisCoord])),o}buildLayout(t,o,a){const i=new Map(a.map(x=>[x.id,x])),s=[],l=t.reduce((x,w)=>x+w.primaryAxisSize,0),r=t.length>1?(o[this.primaryAxisDimension]-l)/(t.length-1):0,d=t.reduce((x,w,C)=>t[x].occupiedSpace<w.occupiedSpace?C:x,0),u=t[d],c=t.slice(0,d).reduce((x,w)=>x+w.primaryAxisSize+r,o[this.primaryAxisCoord]),p=this.buildLayerLayout(u,o,c,i,null);u.layout=p,s.push(...p.nodePositions);let h=c+u.primaryAxisSize+r,f=u;for(let x=d+1;x<t.length;x++){const w=t[x];w.layout=this.buildLayerLayout(w,o,h,i,f),s.push(...w.layout.nodePositions),f=w.layout.refLayer??w,h+=w.primaryAxisSize+r}h=c,f=u;for(let x=d-1;x>=0;x--){const w=t[x];h-=w.primaryAxisSize+r,w.layout=this.buildLayerLayout(w,o,h,i,f),s.push(...w.layout.nodePositions),f=w.layout.refLayer??w}return new Map(s)}buildLayerLayout(t,o,a,i,s){let l=this.scoreLayout(this.spaceAround(t,o,a),i);if(t.nodes.length!=1){const r=this.scoreLayout(this.spaceBetween(t,o,a),i);l=r[0]<l[0]?r:l}if(s&&s.nodes.length-1>=t.nodes.length){const r=this.scoreLayout(this.placeInGaps(t,a,s),i);l=r[0]<l[0]?r:l}if(s&&s.nodes.length>=t.nodes.length){const r=this.scoreLayout(this.placeInCells(t,a,s),i);l=r[0]<l[0]?r:l}return l[1]}spaceBetween(t,o,a){const i=(o[this.secondaryAxisDimension]-t.occupiedSpace)/(t.nodes.length-1);let s=o[this.secondaryAxisCoord];const l=new Map;for(let r of t.nodes)l.set(r.id,{[this.secondaryAxisCoord]:s,[this.primaryAxisCoord]:a}),s+=r[this.secondaryAxisDimension]+i;return{nodePositions:l,refLayer:null}}spaceAround(t,o,a){const i=(o[this.secondaryAxisDimension]-t.occupiedSpace)/(t.nodes.length+1);let s=o[this.secondaryAxisCoord]+i;const l=new Map;for(let r of cn(t.nodes,d=>d[this.secondaryAxisCoord]))l.set(r.id,{[this.secondaryAxisCoord]:s,[this.primaryAxisCoord]:a}),s+=r[this.secondaryAxisDimension]+i;return{nodePositions:l,refLayer:null}}placeInGaps(t,o,a){const i=new Map,s=t.nodes,l=this.getGapsPositions(a);let r=0;for(let d=0,u=s[d];d<s.length;d++,u=s[d]){const c=u[this.secondaryAxisCoord]+u[this.secondaryAxisDimension]/2;let p=1/0;for(;r-d<=l.length-s.length;){const h=l[r]-c;if(Math.abs(h)<Math.abs(p))p=h,r++;else break}i.set(u.id,{[this.secondaryAxisCoord]:u[this.secondaryAxisCoord]+p,[this.primaryAxisCoord]:o})}return{nodePositions:i,refLayer:a}}placeInCells(t,o,a){const i=new Map,s=t.nodes,l=this.getNodePositions(a);let r=0;for(let d=0,u=s[d];d<s.length;d++,u=s[d]){const c=u[this.secondaryAxisCoord]+u[this.secondaryAxisDimension]/2;let p=1/0;for(;r-d<=l.length-s.length;){const h=l[r]-c;if(Math.abs(h)<Math.abs(p))p=h,r++;else break}i.set(u.id,{[this.secondaryAxisCoord]:u[this.secondaryAxisCoord]+p,[this.primaryAxisCoord]:o})}return{nodePositions:i,refLayer:a}}scoreLayout(t,o){return[ce(Array.from(t.nodePositions),ae(([a,i])=>{const s=o.get(a);return q(s,`Could not find original rect for node ${a}`),[wl(s,["x","y"]),i]}),ae(([a,i])=>Math.abs(a[this.secondaryAxisCoord]-i[this.secondaryAxisCoord])),Bn((a,i)=>a+i,0)),t]}getGapsPositions(t){const o=[],{layout:a,nodes:i}=t;q(a,"Layout of the layer must be computed before calling getGapsPositions");for(let s=1;s<i.length;s++){const l=i[s-1],r=i[s],d=a.nodePositions.get(l.id),u=a.nodePositions.get(r.id);o.push((u[this.secondaryAxisCoord]+d[this.secondaryAxisCoord]+l[this.secondaryAxisDimension])/2)}return o}getNodePositions(t){const o=[],{layout:a,nodes:i}=t;q(a,"Layout of the layer must be computed before calling getGapsPositions");for(let s=0;s<i.length;s++){const l=i[s],r=a.nodePositions.get(l.id);o.push(r[this.secondaryAxisCoord]+l[this.secondaryAxisDimension]/2)}return o}}function Sb(e){switch(e){case"Left":return new $t(t=>Math.min(...t.map(o=>o.x)),(t,o)=>Math.floor(t),"x");case"Top":return new $t(t=>Math.min(...t.map(o=>o.y)),(t,o)=>Math.floor(t),"y");case"Right":return new $t(t=>Math.max(...t.map(o=>o.x+o.width)),(t,o)=>Math.floor(t-o.width),"x");case"Bottom":return new $t(t=>Math.max(...t.map(o=>o.y+o.height)),(t,o)=>Math.floor(t-o.height),"y");case"Center":return new $t(t=>Math.min(...t.map(o=>o.x+o.width/2)),(t,o)=>Math.floor(t-o.width/2),"x");case"Middle":return new $t(t=>Math.min(...t.map(o=>o.y+o.height/2)),(t,o)=>Math.floor(t-o.height/2),"y")}}function Br(e){const{width:t,height:o}=at(e);return{...e.internals.positionAbsolute,id:e.id,width:t,height:o}}function _b(e){switch(e){case"Left":case"Right":case"Top":case"Bottom":case"Center":case"Middle":return Sb(e);case"Column":case"Row":return new Cb(e);default:it(e)}}function as(e){const{view:{drifts:t,_layout:o,...a},xynodes:i,xyedges:s,xystore:l}=e,{nodeLookup:r}=l.getState(),d=new Set,u=hs(i,f=>f.data.id),c=hs(s,f=>f.data.id),p=ae(a.nodes,f=>{const x=u[f.id];if(!x)return f;const w=r.get(x.id),C=at(w);return!ql(w.internals.positionAbsolute,f)||f.width!==C.width||f.height!==C.height||f.shape!==x.data.shape||f.color!==x.data.color||f.style.border!==x.data.style.border||f.style.opacity!==x.data.style.opacity?(d.add(x.id),{...f,shape:x.data.shape,color:x.data.color,style:{...f.style,...x.data.style},x:Math.floor(w.internals.positionAbsolute.x),y:Math.floor(w.internals.positionAbsolute.y),width:Math.ceil(C.width),height:Math.ceil(C.height)}):f}),h=ae(a.edges,f=>{const x=c[f.id];if(!x)return f;const w=x.data;let C=w.controlPoints??[];const v=d.has(x.source)||d.has(x.target);C.length===0&&v&&(C=fn(w.points));const k={...gt(f,["controlPoints"]),points:w.points};return w.labelXY&&w.labelBBox&&(k.labelBBox={...w.labelBBox,...w.labelXY}),w.labelBBox&&(k.labelBBox??=w.labelBBox),ve(C,1)&&(k.controlPoints=C),k});return{op:"save-view-snapshot",layout:{...a,bounds:Lf({nodes:p,edges:h}),nodes:p,edges:h}}}const Ua={top:"40px",bottom:"22px",left:"22px",right:"22px"};function jc(e){const t=[],o=[],a=new Map,i=ji.from(e.nodes.reduce((r,d)=>(a.set(d.id,d),d.parent||r.push({node:d,parent:null}),r),[])),s=r=>W(a.get(r),`Node not found: ${r}`);let l;for(;l=i.dequeue();){const{node:r,parent:d}=l,u=ve(r.children,1)||r.kind==tn;if(u)for(const w of r.children)i.enqueue({node:s(w),parent:r});const c={x:r.x,y:r.y};d&&(c.x-=d.x,c.y-=d.y);const p=r.id,h={id:p,draggable:!1,selectable:!0,focusable:!0,position:c,zIndex:u?qe.Compound:qe.Element,style:{width:r.width,height:r.height},initialWidth:r.width,initialHeight:r.height,...d&&{parentId:d.id}},f=r.modelRef??null,x={navigateTo:r.navigateTo??null};switch(!0){case r.kind===wn.Empty:{t.push({...h,type:"empty",data:{column:r.column}});break}case(u&&!!f):{t.push({...h,type:"compound",data:{id:p,column:r.column,title:r.title,color:r.color,shape:r.shape,style:r.style,depth:r.depth??0,icon:r.icon??"none",ports:r.ports,existsInCurrentView:r.existsInCurrentView,fqn:f,...x}});break}default:q(f,"Element should have either modelRef or deploymentRef"),t.push({...h,type:"element",data:{id:p,column:r.column,fqn:f,title:r.title,technology:r.technology,description:r.description,height:r.height,width:r.width,color:r.color,shape:r.shape,icon:r.icon??"none",ports:r.ports,style:r.style,existsInCurrentView:r.existsInCurrentView,tags:r.tags,...x}})}}for(const r of e.edges){const d=r.source,u=r.target,c=r.id;if(!ve(r.points,2)){console.error("edge should have at least 2 points",r);continue}if(!ve(r.relations,1)){console.error("edge should have at least 1 relation",r);continue}o.push({id:c,type:"relationship",source:d,target:u,sourceHandle:r.sourceHandle,targetHandle:r.targetHandle,data:{sourceFqn:r.sourceFqn,targetFqn:r.targetFqn,relations:r.relations,color:r.color??"gray",label:r.label,navigateTo:r.navigateTo??null,line:r.line??"dashed",existsInCurrentView:r.existsInCurrentView},interactionWidth:20})}return{xynodes:t,xyedges:o}}const Lr=e=>e.find(t=>t.data.column==="subjects"&&yi(t.parentId)),Pb=tp(async({input:e,self:t,signal:o})=>{const{subjectId:a,navigateFromNode:i,xyflow:s,xystore:l,update:r}=e;let{nodes:d,width:u,height:c}=l.getState();const p=jc(r),h=()=>{const{nodes:M,edges:Y}=l.getState();return{xynodes:Oa(M,p.xynodes),xyedges:Gl(Y,p.xyedges)}},f=W(t._parent);let x=s.getZoom();const w=Math.max(x,1),C=co(r.bounds,u,c,Fe,w,Ua),v=p.xynodes.find(M=>M.type!=="empty"&&M.data.column==="subjects"&&M.data.fqn===a)??Lr(p.xynodes),k=Lr(d),_=i?d.find(M=>M.id===i):d.find(M=>M.type!=="empty"&&M.data.column!=="subjects"&&M.data.fqn===a);if(!v||!_||v.type==="empty"||!k||v.data.fqn===k.data.fqn)return await s.setViewport(C),h();const m={x:v.position.x+(v.initialWidth??0)/2,y:v.position.y+(v.initialHeight??0)/2},b=s.getInternalNode(k.id),j=po(b),S=new Set;if(d.forEach(M=>{if(M.id!==_.id){if(M.data.column==="subjects"){S.add(M.id);return}M.parentId&&(M.parentId===_.id||S.has(M.parentId))&&S.add(M.id)}}),d=Oa(d,d.flatMap(M=>S.has(M.id)?[]:M.id!==_.id?{...M,data:{...M.data,dimmed:M.data.column==="subjects"?"immediate":!0}}:{...gt(M,["parentId"]),position:{x:j.x-M.initialWidth/2,y:j.y-M.initialHeight/2},zIndex:qe.Max,hidden:!1,data:{...M.data,dimmed:!1}})),f.send({type:"update.xydata",xynodes:d,xyedges:[]}),await Ss(120),p.xynodes=p.xynodes.map(G.setDimmed(!1)),o.aborted)return h();const D=300;return s.setCenter(j.x,j.y,{zoom:x,duration:D,interpolate:"smooth"}),await Ss(D),await s.setCenter(m.x,m.y,{zoom:x}),h()}),rt=ot({actors:{layouter:Pb},guards:{hasViewId:({context:e})=>e.viewId!==null,isReady:({context:e})=>e.xyflow!==null&&e.xystore!==null&&e.layouted!==null,anotherSubject:({context:e,event:t})=>t.type==="update.view"?e.layouted?.subject!==t.layouted.subject:!1}}),Tr=()=>rt.assign(({event:e})=>(z(e,"xyflow.init"),{xyflow:e.instance,xystore:e.store})),Ar=()=>rt.assign(({event:e})=>(z(e,"update.view"),{layouted:e.layouted,...jc(e.layouted)})),Mb=()=>rt.createAction(({context:e})=>{q(e.xystore,"xystore is not initialized");const{domNode:t,updateNodeInternals:o}=e.xystore.getState(),a=new Set(e.xyedges.flatMap(l=>[l.source,l.target]));if(a.size===0||!t)return;const i=new Map,s=t.querySelectorAll(".react-flow__node");for(const l of s){const r=l.getAttribute("data-id");r&&a.has(r)&&i.set(r,{id:r,nodeElement:l,force:!0})}o(i,{triggerFitView:!1})}),Sa=e=>rt.createAction(({context:t,event:o})=>{e??=o.type==="fitDiagram"?o:{};let{duration:a,bounds:i}=e??{};a??=450;const{xyflow:s,xystore:l}=t;q(s,"xyflow is not initialized"),q(l,"xystore is not initialized"),i??=t.layouted?.bounds;const r=Math.max(s.getZoom(),1);if(i){const{width:d,height:u}=l.getState(),c=co(i,d,u,Fe,r,Ua);s.setViewport(c,a>0?{duration:a,interpolate:"smooth"}:void 0).catch(console.error)}else s.fitView({minZoom:Fe,maxZoom:r,padding:Ua,...a>0&&{duration:a,interpolate:"smooth"}}).catch(console.error)}),Nb=()=>rt.assign(({context:e,event:t})=>(z(t,"xyflow.applyNodeChanges"),{xynodes:pi(t.changes,e.xynodes)})),Ib=()=>rt.assign(({context:e,event:t})=>(z(t,"xyflow.applyEdgeChanges"),{xyedges:ui(t.changes,e.xyedges)})),zr=()=>rt.enqueueActions(({system:e,event:t})=>{if(t.type!=="xyflow.edgeClick")return;const o=le(e).diagramActorRef,a=t.edge.data.relations;ve(a,1)&&o.send({type:"open.source",relation:a[0]})}),$r=()=>rt.assign({xyflow:null,layouted:null,xystore:null,xyedges:[],xynodes:[]}),Eb=rt.createMachine({id:"relationships-browser",context:({input:e})=>({subject:e.subject,viewId:e.viewId,scope:e.viewId?e.scope:"global",closeable:e.closeable??!0,enableSelectSubject:e.enableSelectSubject??!0,enableChangeScope:e.enableChangeScope??!0,xyflow:null,xystore:null,layouted:null,navigateFromNode:null,xynodes:[],xyedges:[]}),initial:"initializing",on:{"xyflow.applyNodeChanges":{actions:Nb()},"xyflow.applyEdgeChanges":{actions:Ib()}},states:{initializing:{on:{"xyflow.init":{actions:Tr(),target:"isReady"},"update.view":{actions:Ar(),target:"isReady"},stop:"closed",close:"closed"}},isReady:{always:[{guard:"isReady",actions:[Sa({duration:0}),be({type:"xyflow.updateNodeInternals"},{delay:150})],target:"active"},{target:"initializing"}]},active:{initial:"idle",tags:["active"],on:{"xyflow.nodeClick":{actions:Ye(({event:e,enqueue:t})=>{if("fqn"in e.node.data){const o=e.node.data.fqn;t.raise({type:"navigate.to",subject:o,fromNode:e.node.id})}})},"xyflow.edgeClick":[{guard:"hasViewId",actions:Ye(({event:e,context:t,system:o,enqueue:a})=>{e.edge.selected||e.edge.data.relations.length>1?a.sendTo(le(o).overlaysActorRef,{type:"open.relationshipDetails",viewId:t.viewId,source:e.edge.data.sourceFqn,target:e.edge.data.targetFqn}):a(zr())})},{actions:zr()}],"navigate.to":{actions:[T({subject:({event:e})=>e.subject,viewId:({event:e,context:t})=>e.viewId??t.viewId??null,navigateFromNode:({event:e})=>e.fromNode??null})]},"xyflow.paneDblClick":{actions:Sa()},"update.view":{actions:Ar(),target:".layouting"},"change.scope":{actions:T({scope:({event:e})=>e.scope})},"xyflow.updateNodeInternals":{actions:Mb()},fitDiagram:{actions:Sa()},"xyflow.resized":{actions:[Qe("fitDiagram"),be({type:"fitDiagram"},{id:"fitDiagram",delay:300})]},"xyflow.init":{actions:Tr()},"xyflow.unmount":{target:"initializing"},close:"closed"},states:{idle:{on:{"xyflow.edgeMouseEnter":{actions:[T({xyedges:({context:e,event:t})=>{const o=e.xyedges.some(a=>a.data.dimmed!==!1||a.selected);return e.xyedges.map(a=>a.id===t.edge.id?G.setData(a,{hovered:!0,dimmed:!1}):o&&!a.selected?G.setDimmed(a,"immediate"):a)}}),Qe("undim.edges"),Qe("dim.nonhovered.edges"),be({type:"dim.nonhovered.edges"},{id:"dim.nonhovered.edges",delay:200})]},"xyflow.edgeMouseLeave":{actions:[T({xyedges:({context:e,event:t})=>e.xyedges.map(o=>o.id===t.edge.id?G.setHovered(o,!1):o)}),Qe("dim.nonhovered.edges"),be({type:"undim.edges"},{id:"undim.edges",delay:400})]},"dim.nonhovered.edges":{actions:T({xyedges:({context:e})=>e.xyedges.map(t=>t.data.hovered?t:G.setDimmed(t,t.data.dimmed==="immediate"?"immediate":!0))})},"undim.edges":{actions:T({xyedges:({context:e})=>e.xyedges.map(G.setDimmed(!1))})},"xyflow.selectionChange":{actions:Ye(({event:e,context:t,enqueue:o})=>{e.edges.length===0&&t.xyedges.some(a=>a.data.dimmed)&&!t.xyedges.some(a=>a.data.hovered)&&o.raise({type:"undim.edges"})})}}},layouting:{invoke:{id:"layouter",src:"layouter",input:({context:e})=>({subjectId:e.subject,navigateFromNode:e.navigateFromNode,xyflow:W(e.xyflow),xystore:W(e.xystore),update:W(e.layouted)}),onDone:{target:"idle",actions:Ye(({enqueue:e,event:t})=>{e.assign({xynodes:t.output.xynodes,xyedges:t.output.xyedges,navigateFromNode:null}),e.raise({type:"fitDiagram",duration:200},{id:"fitDiagram",delay:50});for(let o=1;o<8;o++)e.raise({type:"xyflow.updateNodeInternals"},{delay:120+o*75})})}},on:{"update.xydata":{actions:T({xynodes:({event:e})=>e.xynodes,xyedges:({event:e})=>e.xyedges})},"xyflow.applyEdgeChanges":{},"xyflow.applyNodeChanges":{}}}}},closed:{id:"closed",type:"final",entry:$r()}},exit:$r()}),Cc=Eb,Rb=ot({actors:{relationshipsBrowserLogic:Cc}}).createMachine({id:"element-details",context:({input:e})=>({...e,initiatedFrom:{node:e.initiatedFrom?.node??null,clientRect:e.initiatedFrom?.clientRect??null}}),initial:"active",states:{active:{entry:di("relationshipsBrowserLogic",{id:({self:e})=>`${e.id}-relationships`,input:({context:e})=>({subject:e.subject,viewId:e.currentView.id,scope:"view",enableSelectSubject:!1,enableChangeScope:!0,closeable:!1})}),exit:[Qo(({self:e})=>`${e.id}-relationships`,{type:"close"}),Jo(({self:e})=>`${e.id}-relationships`)],on:{"change.subject":{actions:T({subject:({event:e})=>e.subject})},close:"closed"}},closed:{id:"closed",type:"final"}}}),Db=Rb;function Bb(e){const t=[],o=[],a=new Map,i=ji.from(e.nodes.reduce((r,d)=>(a.set(d.id,d),d.parent||r.push({node:d,parent:null}),r),[])),s=r=>W(a.get(r),`Node not found: ${r}`);let l;for(;l=i.dequeue();){const{node:r,parent:d}=l,u=ve(r.children,1);if(u)for(const w of r.children)i.enqueue({node:s(w),parent:r});const c={x:r.x,y:r.y};d&&(c.x-=d.x,c.y-=d.y);const p=r.id,h={id:p,draggable:!1,selectable:!0,focusable:!0,deletable:!1,position:c,zIndex:u?qe.Compound:qe.Element,style:{width:r.width,height:r.height},initialWidth:r.width,initialHeight:r.height,...d&&{parentId:d.id}},f=r.modelRef,x={navigateTo:r.navigateTo??null};switch(!0){case u:{t.push({...h,type:"compound",data:{id:p,column:r.column,title:r.title,color:r.color,style:r.style,depth:r.depth??0,icon:r.icon??"none",ports:r.ports,fqn:f,...x}});break}default:t.push({...h,type:"element",data:{id:p,column:r.column,fqn:f,title:r.title,technology:r.technology,description:Ge.from(r.description),height:r.height,width:r.width,color:r.color,shape:r.shape,icon:r.icon??"none",ports:r.ports,style:r.style,tags:r.tags,...x}})}}for(const{source:r,target:d,relationId:u,label:c,technology:p,description:h,navigateTo:f=null,color:x="gray",line:w="dashed",...C}of e.edges){const v=C.id;o.push({id:v,type:"relationship",source:r,target:d,sourceHandle:C.sourceHandle,targetHandle:C.targetHandle,deletable:!1,data:{relationId:u,label:c,color:x,navigateTo:f,line:w,description:Ge.from(h),...p&&{technology:p}}})}return{xynodes:t,xyedges:o,bounds:e.bounds}}function Fr(e){return"edgeId"in e?(q(gi(e.edgeId),"edgeId is required"),{edgeId:e.edgeId}):{source:e.source,target:e.target}}const Vr={x:"22px",y:"22px"},Lb=ot({actions:{"xyflow:fitDiagram":({context:e},t)=>{let{duration:o,bounds:a}=t??{};o??=450;const{xyflow:i,xystore:s}=e;q(i,"xyflow is not initialized"),q(s,"xystore is not initialized"),a??=e.bounds;const l=Math.max(i.getZoom(),1);if(a){const{width:r,height:d}=s.getState(),u=co(a,r,d,Fe,l,Vr);i.setViewport(u,o>0?{duration:o}:void 0).catch(console.error)}else i.fitView({minZoom:Fe,maxZoom:l,padding:Vr,...o>0&&{duration:o,interpolate:"smooth"}}).catch(console.error)},"xyflow:updateNodeInternals":({context:e})=>{q(e.xystore,"xystore is not initialized");const{domNode:t,updateNodeInternals:o}=e.xystore.getState(),a=new Set(e.xyedges.flatMap(s=>[s.source,s.target]));if(a.size===0||!t)return;const i=new Map;for(const s of a){const l=t.querySelector(`.react-flow__node[data-id="${s}"]`);l&&i.set(s,{id:s,nodeElement:l,force:!0})}o(i,{triggerFitView:!1})},updateXYFlow:T(({context:e,event:t})=>{z(t,"xyflow.init");let o=e.initialized;return o.xyflow||(o={...o,xyflow:!0}),{initialized:o,xyflow:t.instance,xystore:t.store}}),updateLayoutData:T(({context:e,event:t})=>{z(t,"update.layoutData");const{xynodes:o,xyedges:a,bounds:i}=Bb(t.data);let s=e.initialized;return s.xydata||(s={...s,xydata:!0}),{initialized:s,xynodes:Oa(e.xynodes,o),xyedges:Gl(e.xyedges,a),bounds:ee(e.bounds,i)?e.bounds:i}}),"open relationship source":Ye(({system:e,event:t})=>{if(t.type!=="xyflow.edgeClick")return;const o=le(e).diagramActorRef,a=t.edge.data.relationId;a&&o.send({type:"open.source",relation:a})})},guards:{isReady:({context:e})=>e.initialized.xydata&&e.initialized.xyflow,"enable: navigate.to":()=>!0}}).createMachine({initial:"initializing",context:({input:e})=>({subject:Fr(e),viewId:e.viewId,bounds:{x:0,y:0,width:200,height:200},initialized:{xydata:!1,xyflow:!1},xyflow:null,xystore:null,xynodes:[],xyedges:[]}),states:{initializing:{on:{"xyflow.init":{actions:"updateXYFlow",target:"isReady"},"update.layoutData":{actions:"updateLayoutData",target:"isReady"},close:{target:"closed"}}},isReady:{always:[{guard:"isReady",actions:[{type:"xyflow:fitDiagram",params:{duration:0}},be({type:"xyflow.updateNodeInternals"},{delay:50})],target:"ready"},{target:"initializing"}]},ready:{on:{"xyflow.edgeMouseEnter":{actions:[T({xyedges:({context:e,event:t})=>{const o=e.xyedges.some(a=>a.data.dimmed===!0||a.data.dimmed==="immediate");return e.xyedges.map(a=>a.id===t.edge.id?G.setData(a,{hovered:!0,dimmed:!1}):o&&!a.selected?G.setDimmed(a,"immediate"):a)}}),Qe("undim.edges"),Qe("dim.nonhovered.edges"),be({type:"dim.nonhovered.edges"},{id:"dim.nonhovered.edges",delay:100})]},"xyflow.edgeMouseLeave":{actions:[T({xyedges:({context:e,event:t})=>e.xyedges.map(o=>o.id===t.edge.id?G.setHovered(o,!1):o)}),Qe("dim.nonhovered.edges"),be({type:"undim.edges"},{id:"undim.edges",delay:400})]},"dim.nonhovered.edges":{actions:T({xyedges:({context:e})=>e.xyedges.map(t=>G.setDimmed(t,t.data.hovered!==!0))})},"undim.edges":{actions:T({xyedges:({context:e})=>e.xyedges.some(t=>t.selected===!0)?e.xyedges.map(t=>G.setDimmed(t,t.selected!==!0?t.data.dimmed||"immediate":!1)):e.xyedges.map(G.setDimmed(!1))})},"xyflow.selectionChange":{actions:Ye(({event:e,context:t,enqueue:o})=>{e.edges.length===0&&t.xyedges.some(a=>a.data.dimmed)&&!t.xyedges.some(a=>a.data.hovered)&&o.raise({type:"undim.edges"})})},"update.layoutData":{actions:["updateLayoutData",Qe("fitDiagram"),be({type:"fitDiagram",duration:0},{id:"fitDiagram",delay:50}),be({type:"xyflow.updateNodeInternals"},{delay:75})]},"xyflow.init":{actions:"updateXYFlow"},"xyflow.applyNodeChanges":{actions:T({xynodes:({context:e,event:t})=>pi(t.changes,e.xynodes)})},"xyflow.applyEdgeChanges":{actions:T({xyedges:({context:e,event:t})=>ui(t.changes,e.xyedges)})},"xyflow.paneDblClick":{actions:"xyflow:fitDiagram"},"xyflow.edgeClick":{actions:"open relationship source"},"navigate.to":{actions:T({subject:({event:e})=>Fr(e.params),viewId:({context:e,event:t})=>t.params.viewId??e.viewId})},close:{target:"closed"}},exit:T({xyedges:[],xynodes:[],initialized:{xydata:!1,xyflow:!1},xyflow:null,xystore:null})},closed:{type:"final"}},on:{fitDiagram:{actions:{type:"xyflow:fitDiagram",params:wt("event")}},"xyflow.resized":{actions:[Qe("fitDiagram"),be({type:"fitDiagram"},{id:"fitDiagram",delay:200})]},"xyflow.updateNodeInternals":{actions:"xyflow:updateNodeInternals"}}}),Tb=Lb,Ab=bi(({sendBack:e})=>{const t=pn([["Escape",o=>{o.stopPropagation(),e({type:"close"})},{preventDefault:!0}]]);return document.body.addEventListener("keydown",t,{capture:!0}),()=>{document.body.removeEventListener("keydown",t,{capture:!0})}}),lt=ot({actors:{relationshipDetails:Tb,elementDetails:Db,relationshipsBrowser:Cc,hotkey:Ab},guards:{"has overlays?":({context:e})=>e.overlays.length>0,"close specific overlay?":({context:e,event:t})=>(z(t,"close"),gi(t.actorId)&&e.overlays.some(o=>o.id===t.actorId)),"last: is relationshipDetails?":({context:e})=>et(e.overlays)?.type==="relationshipDetails","last: is relationshipsBrowser?":({context:e})=>et(e.overlays)?.type==="relationshipsBrowser"}}),zb=()=>lt.enqueueActions(({context:e,enqueue:t})=>{if(e.overlays.length===0)return;const o=et(e.overlays)?.id;o&&(t.sendTo(o,{type:"close"}),t.stopChild(o),t.assign({overlays:e.overlays.filter(a=>a.id!==o)}))}),$b=()=>lt.enqueueActions(({context:e,enqueue:t,event:o})=>{z(o,"close");const a=o.actorId;if(!gi(a))return;const i=e.overlays.find(s=>s.id===a)?.id;i&&(t.sendTo(i,{type:"close"}),t.stopChild(i),t.assign({overlays:e.overlays.filter(s=>s.id!==i)}))}),Wr=()=>lt.enqueueActions(({context:e,enqueue:t})=>{for(const{id:o}of xu(e.overlays))t.sendTo(o,{type:"close"}),t.stopChild(o);t.assign({overlays:[]})}),Fb=()=>lt.enqueueActions(({context:e,enqueue:t,event:o})=>{if(z(o,"open.elementDetails"),e.overlays.some(i=>i.type==="elementDetails"&&i.subject===o.subject))return;const a=`elementDetails-${e.seq}`;t.spawnChild("elementDetails",{id:a,input:o}),t.assign({seq:e.seq+1,overlays:[...e.overlays,{type:"elementDetails",id:a,subject:o.subject}]})}),Vb=()=>lt.enqueueActions(({context:e,enqueue:t,event:o})=>{z(o,"open.relationshipDetails");const a=et(e.overlays);if(a?.type==="relationshipDetails"){t.sendTo(a.id,{...o,type:"navigate.to"});return}const i=`relationshipDetails-${e.seq}`;t.spawnChild("relationshipDetails",{id:i,input:o}),t.assign({seq:e.seq+1,overlays:[...e.overlays,{type:"relationshipDetails",id:i}]})}),Wb=()=>lt.enqueueActions(({context:e,enqueue:t,event:o})=>{z(o,"open.relationshipsBrowser");const a=et(e.overlays);if(a?.type==="relationshipsBrowser"){t.sendTo(a.id,{type:"navigate.to",subject:o.subject,viewId:o.viewId});return}const i=`relationshipsBrowser-${e.seq}`;t.spawnChild("relationshipsBrowser",{id:i,input:o}),t.assign({seq:e.seq+1,overlays:[...e.overlays,{type:"relationshipsBrowser",id:i,subject:o.subject}]})}),Ob=()=>lt.spawnChild("hotkey",{id:"hotkey"}),Zo=()=>lt.stopChild("hotkey"),Hb=lt.createMachine({id:"overlays",context:()=>({seq:1,overlays:[]}),initial:"idle",on:{"open.elementDetails":{actions:Fb(),target:".active",reenter:!1},"open.relationshipDetails":{actions:Vb(),target:".active",reenter:!1},"open.relationshipsBrowser":{actions:Wb(),target:".active",reenter:!1}},states:{idle:{},active:{entry:Ob(),exit:Zo(),on:{close:[{guard:"close specific overlay?",actions:$b(),target:"closing"},{actions:zb(),target:"closing"}],"close.all":{actions:[Wr(),Zo()],target:"idle"}}},closing:{always:[{guard:"has overlays?",target:"active"},{actions:Zo(),target:"idle"}]}},exit:[Zo(),Wr()]}),Xb=Hb,Yb=ot({actions:{"change searchValue":T({searchValue:({event:e,context:t})=>(z(e,["change.search","open"]),e.search??t.searchValue)}),"reset pickViewFor":T({pickViewFor:()=>null})}}).createMachine({id:"search",context:{openedWithSearch:null,searchValue:"",pickViewFor:null},initial:"inactive",on:{close:{target:".inactive",actions:"reset pickViewFor"}},states:{inactive:{on:{open:{target:"opened",actions:[T({openedWithSearch:({event:e})=>e.search??null,searchValue:({event:e,context:t})=>e.search??t.searchValue})]}}},opened:{on:{open:{actions:"change searchValue"},"change.search":{actions:"change searchValue"},"pickview.open":{target:"pickView",actions:T({pickViewFor:({event:e})=>e.elementFqn})}}},pickView:{on:{"pickview.close":{target:"opened",actions:"reset pickViewFor"}}}}}),qb=Yb,Gb=bi(({sendBack:e})=>{const t=pn([["Escape",a=>{a.stopPropagation(),console.log("Escape karsarsey pressed"),e({type:"key.esc"})},{preventDefault:!0}]]),o=pn([["ArrowLeft",a=>{a.stopPropagation(),e({type:"key.arrow.left"})},{preventDefault:!0}],["ArrowRight",a=>{a.stopPropagation(),e({type:"key.arrow.right"})},{preventDefault:!0}]]);return document.body.addEventListener("keydown",t),document.body.addEventListener("keydown",o,{capture:!0}),()=>{document.body.removeEventListener("keydown",t),document.body.removeEventListener("keydown",o,{capture:!0})}}),Zb=bi(({sendBack:e})=>{const t=pn([["mod + z",o=>{console.log("Undo hotkey pressed"),o.stopPropagation(),e({type:"undo"})},{preventDefault:!0}]]);return document.body.addEventListener("keydown",t,{capture:!0}),()=>{document.body.removeEventListener("keydown",t,{capture:!0})}}),Cn=function(e){return e.get("diagram")},Ie=ot({delays:{timeout:2e3},guards:{"can undo":({context:e})=>e.history.length>0},actors:{undoHotKeyActorLogic:Zb}}),Kb=Ie.assign(({context:e})=>{const t=e.beforeEditing;if(!t)return{};const o=et(e.history);return I(o?.xyedges,t.xyedges)&&I(o?.xynodes,t.xynodes)?{beforeEditing:null}:{beforeEditing:null,history:[...e.history,t]}}),Ub=Ie.assign(({context:e})=>e.history.length===0?{}:{history:e.history.slice(0,-1)}),Sc=Ie.assign(({system:e,event:t})=>{z(t,"editing.start");const o=Cn(e).getSnapshot().context;return{editing:t.subject,beforeEditing:{xynodes:ae(o.xynodes,a=>({...a})),xyedges:ae(o.xyedges,a=>({...a})),change:as(o),view:o.view,synched:!1}}}),oa=Ie.enqueueActions(({check:e,enqueue:t,self:o})=>{const a=e("can undo"),i=o.getSnapshot().children.undoHotKey;if(i&&!a){t.stopChild(i);return}!i&&a&&t.spawnChild("undoHotKeyActorLogic",{id:"undoHotKey"})}),_c=Ie.enqueueActions(({event:e,enqueue:t})=>{z(e,"editing.stop"),e.wasChanged&&(t.cancel("sync"),t(Kb),t.raise({type:"sync"},{id:"sync",delay:50})),t.assign({beforeEditing:null,editing:null})}),Qb=Ie.sendTo(({system:e})=>Cn(e),({system:e})=>{const t=Cn(e).getSnapshot().context;return{type:"emit.onChange",change:as(t)}}),Jb=Ie.assign(({context:e,event:t})=>(z(t,"synced"),{history:e.history.map(o=>({...o,synched:!0})),beforeEditing:e.beforeEditing?{...e.beforeEditing,synched:!0}:null})),Pc=Ie.enqueueActions(({context:e,enqueue:t,system:o})=>{const a=et(e.history);if(!a)return;t(Ub),t(oa);const i=Cn(o);t.sendTo(i,{type:"update.view",view:a.view,xyedges:a.xyedges,xynodes:a.xynodes}),a.synched&&t.sendTo(i,{type:"emit.onChange",change:a.change})}),ew=Ie.createStateConfig({tags:"ready",entry:[T({beforeEditing:null,editing:null})],on:{sync:{target:"pending"},"editing.start":{actions:Sc,target:"editing"},undo:{guard:"can undo",actions:Pc}}}),tw=Ie.createStateConfig({on:{"editing.stop":{actions:[_c,oa],target:"idle"},undo:{}}}),ow=Ie.createStateConfig({tags:"pending",on:{sync:{target:"pending",reenter:!0},"editing.start":{target:"paused",actions:Sc},undo:{guard:"can undo",actions:Pc,target:"idle"}},after:{timeout:{target:"idle",actions:Qb}}}),nw=Ie.createStateConfig({tags:"pending",on:{"editing.stop":{actions:[_c,oa],target:"pending"},undo:{}}}),aw=Ie.createMachine({initial:"idle",context:({input:e})=>({...e,history:[],beforeEditing:null,editing:null}),states:{idle:ew,editing:tw,pending:ow,paused:nw,stopped:{entry:[T({beforeEditing:null,history:[]}),oa],type:"final"}},on:{cancel:{target:".idle"},synced:{actions:Jb,target:".idle"},stop:{target:".stopped"}}}),iw=aw,Ko=e=>(e.features.enableReadOnly||e.toggledFeatures.enableReadOnly===!0)&&(e.view._type!=="dynamic"||e.dynamicViewVariant!=="sequence"),R=ot({actors:{syncManualLayoutActorLogic:iw,hotkeyActorLogic:Gb,overlaysActorLogic:Xb,searchActorLogic:qb},guards:{isReady:({context:e})=>e.initialized.xydata&&e.initialized.xyflow,"enabled: FitView":({context:e})=>e.features.enableFitView,"enabled: FocusMode":({context:e})=>(e.toggledFeatures.enableFocusMode??e.features.enableFocusMode)===!0&&Ko(e),"enabled: Readonly":({context:e})=>Ko(e),"enabled: RelationshipDetails":({context:e})=>e.features.enableRelationshipDetails,"enabled: Search":({context:e})=>e.features.enableSearch,"enabled: ElementDetails":({context:e})=>e.features.enableElementDetails,"enabled: DynamicViewWalkthrough":({context:e})=>Ko(e)&&e.features.enableDynamicViewWalkthrough,"not readonly":({context:e})=>!Ko(e),"is dynamic view":({context:e})=>e.view._type==="dynamic","is another view":({context:e,event:t})=>{if(z(t,["update.view","navigate.to"]),t.type==="update.view")return e.view.id!==t.view.id;if(t.type==="navigate.to")return e.view.id!==t.viewId;it(t.type)},"click: node has modelFqn":({event:e})=>(z(e,"xyflow.nodeClick"),"modelFqn"in e.node.data),"click: selected node":({event:e})=>(z(e,"xyflow.nodeClick"),e.node.selected===!0),"click: same node":({context:e,event:t})=>(z(t,"xyflow.nodeClick"),e.lastClickedNode?.id===t.node.id),"click: focused node":({context:e,event:t})=>(z(t,"xyflow.nodeClick"),e.focusedNode===t.node.id),"click: node has connections":({context:e,event:t})=>(z(t,"xyflow.nodeClick"),e.xyedges.some(o=>o.source===t.node.id||o.target===t.node.id)),"click: selected edge":({event:e})=>(z(e,["xyflow.edgeClick","xyflow.edgeDoubleClick"]),e.edge.selected===!0||e.edge.data.active===!0)}});function Or(e){switch(e.type){case"element":case"compound-element":case"seq-actor":return e.data.modelFqn;case"deployment":case"compound-deployment":return e.data.modelFqn??e.data.deploymentFqn;case"seq-parallel":case"view-group":return null;default:it(e)}}function Mc(e,t){const o=e.lastOnNavigate?.fromNode,a=o&&e.xynodes.find(l=>l.id===o),i=a&&Or(a),s=i&&t.xynodes.find(l=>Or(l)===i);return{fromNode:a,toNode:s}}const sw={navigateTo:()=>R.emit(({context:e})=>({type:"navigateTo",viewId:W(e.lastOnNavigate,"Invalid state, lastOnNavigate is null").toView}))},fe={fitDiagram:e=>R.createAction(({context:t,event:o})=>{e??=o.type==="fitDiagram"?o:{};const{bounds:a=t.view.bounds,duration:i=450}=e,{width:s,height:l,panZoom:r,transform:d}=W(t.xystore).getState(),u=Math.max(1,d[2]),c=co(a,s,l,Fe,u,t.fitViewPadding);c.x=Math.round(c.x),c.y=Math.round(c.y),r?.setViewport(c,i>0?{duration:i,interpolate:"smooth"}:void 0).catch(console.error)}),fitFocusedBounds:()=>R.createAction(({context:e})=>{const t=!!e.activeWalkthrough&&e.dynamicViewVariant==="sequence",{bounds:o,duration:a=450}=t?M1({context:e}):_1({context:e}),{width:i,height:s,panZoom:l,transform:r}=W(e.xystore).getState(),d=Math.max(1,r[2]),u=co(o,i,s,Fe,d,e.fitViewPadding);u.x=Math.round(u.x),u.y=Math.round(u.y),l?.setViewport(u,a>0?{duration:a,interpolate:"smooth"}:void 0)}),alignNodeFromToAfterNavigate:e=>R.createAction(({context:t})=>{const o=W(t.xyflow,"xyflow is not initialized"),a=o.getInternalNode(e.fromNode);if(!a)return;const i=o.flowToScreenPosition({x:a.internals.positionAbsolute.x,y:a.internals.positionAbsolute.y}),s=o.flowToScreenPosition(e.toPosition),l={x:Math.round(i.x-s.x),y:Math.round(i.y-s.y)};t.xystore.getState().panBy(l)}),setViewportCenter:e=>R.createAction(({context:t,event:o})=>{let a;e?a=e:o.type==="update.view"?a=ht.center(o.view.bounds):a=ht.center(t.view.bounds),q(t.xyflow,"xyflow is not initialized");const i=t.xyflow.getZoom();t.xyflow.setCenter(Math.round(a.x),Math.round(a.y),{zoom:i})}),setViewport:e=>R.createAction(({context:t})=>{const{viewport:o,duration:a=350}=e;t.xystore?.getState().panZoom?.setViewport(o,a>0?{duration:a,interpolate:"smooth"}:void 0)})},is=()=>R.assign(({context:e})=>({toggledFeatures:{...e.toggledFeatures,enableCompareWithLatest:!1},viewportOnAutoLayout:null,viewportOnManualLayout:null})),rw=()=>R.assign(({context:e,event:t})=>{if(z(t,"xyflow.edgeDoubleClick"),!t.edge.data.controlPoints)return{};const{nodeLookup:o}=e.xystore.getState();return{xyedges:e.xyedges.map(a=>{if(a.id===t.edge.id){const i=vc(o,a),s=i[0];return{...a,data:{...a.data,controlPoints:i,labelBBox:a.data.labelBBox?{...a.data.labelBBox,...s}:null,labelXY:a.data.labelXY?s:null}}}return a})}}),lw=()=>R.enqueueActions(({event:e,enqueue:t})=>{z(e,"emit.onChange"),t.assign({viewportChangedManually:!0}),t.emit({type:"onChange",change:e.change})}),dw=()=>R.enqueueActions(({event:e,system:t,context:o,enqueue:a})=>{if(!o.features.enableCompareWithLatest){console.warn("Layout type cannot be changed while CompareWithLatest feature is disabled");return}const i=o.view._layout;let s=i==="auto"?"manual":"auto";if(e.type==="emit.onLayoutTypeChange"&&(s=e.layoutType),i===s){console.warn("Ignoring layout type change event, layout type is already",i);return}if(o.toggledFeatures.enableCompareWithLatest===!0){if(i==="manual"&&s==="auto"){const r=le(t).syncLayoutActorRef,d=r?.getSnapshot().value;r&&(d==="pending"||d==="paused")&&(a.sendTo(r,{type:"cancel"}),a.emit({type:"onChange",change:as(o)}))}const l=o.viewport;i==="auto"&&a.assign({viewportOnAutoLayout:l}),i==="manual"&&a.assign({viewportOnManualLayout:l})}a.emit({type:"onLayoutTypeChange",layoutType:s})}),ro=()=>R.assign(({context:e,event:t})=>{z(t,"xyflow.nodeClick");const{lastClickedNode:o}=e;return!o||o.id!==t.node.id?{lastClickedNode:{id:t.node.id,clicks:1,timestamp:Date.now()}}:{lastClickedNode:{id:o.id,clicks:o.clicks+1,timestamp:Date.now()}}}),Qa=()=>R.assign(({event:e})=>{let t;switch(e.type){case"xyflow.nodeClick":t=e.node.data.id;break;case"focus.node":t=e.nodeId;break;default:throw new Error(`Unexpected event type: ${e.type} in action 'assign: focusedNode'`)}return{focusedNode:t}}),ho=()=>R.assign(()=>({lastClickedNode:null})),cw=()=>R.assign(({event:e})=>(z(e,"update.features"),{features:{...e.features}})),uw=()=>R.assign(({event:e})=>(z(e,"update.inputs"),{...e.inputs})),Ja=()=>R.assign(({context:e,event:t})=>(z(t,"update.view"),{...yb({context:e,event:t}),lastClickedNode:null})),Uo=()=>R.assign(xb),Sn=()=>R.assign(({context:e})=>({xynodes:e.xynodes.map(G.setDimmed(!1)),xyedges:e.xyedges.map(G.setData({dimmed:!1,active:!1}))})),no=()=>R.assign(jb),pw=()=>R.assign(({event:e})=>(z(e,"switch.dynamicViewVariant"),{dynamicViewVariant:e.variant})),gw=e=>R.assign(({context:t,event:o})=>{let a=e?.node;return a||(z(o,"xyflow.nodeMouseEnter"),a=o.node),{xynodes:t.xynodes.map(i=>i.id===a.id?G.setHovered(i,!0):i)}}),hw=e=>R.assign(({context:t,event:o})=>{let a=e?.node;return a||(z(o,"xyflow.nodeMouseLeave"),a=o.node),{xynodes:t.xynodes.map(i=>i.id===a.id?G.setHovered(i,!1):i)}}),mw=()=>R.emit(()=>({type:"walkthroughStopped"})),ss=()=>R.emit(()=>({type:"paneClick"})),Nc=e=>R.emit(({event:t})=>e?{type:"openSource",params:e}:(z(t,"open.source"),{type:"openSource",params:t})),fw=()=>R.emit(({context:e})=>(q(e.xyflow,"XYFlow instance not found"),{type:"initialized",instance:e.xyflow})),jt=()=>R.emit(({context:e,event:t})=>(z(t,"xyflow.nodeClick"),{type:"nodeClick",node:W(qt(e,t.node.id),`Node ${t.node.id} not found in diagram`),xynode:t.node})),rs=()=>R.emit(({context:e,event:t})=>(z(t,"xyflow.edgeClick"),{type:"edgeClick",edge:W(ns(e,t.edge.id),`Edge ${t.edge.id} not found in diagram`),xyedge:t.edge})),yw=()=>R.emit(({context:e})=>{const t=e.xyedges.find(o=>o.id===e.activeWalkthrough?.stepId);return q(t,"Invalid walkthrough state"),{type:"walkthroughStarted",edge:t}}),Hr=()=>R.emit(({context:e})=>{const t=e.xyedges.find(o=>o.id===e.activeWalkthrough?.stepId);return q(t,"Invalid walkthrough state"),{type:"walkthroughStep",edge:t}}),xw=e=>R.createAction(({context:t,event:o})=>{let a;z(o,"layout.align"),a=o.mode;const i=W(t.xystore,"xystore is not initialized"),{nodeLookup:s,parentLookup:l}=i.getState(),r=[...new Set(s.values().filter(p=>p.selected).map(p=>p.id)).difference(new Set(l.keys()))];if(!ve(r,2)){console.warn("At least 2 nodes must be selected to align");return}const d=xc(i,r),u=_b(a),c=r.map(p=>({node:W(s.get(p)),rect:W(d.rects.get(p))}));u.computeLayout(c.map(({node:p})=>Br(p)));for(const{rect:p,node:h}of c)p.positionAbsolute={...p.positionAbsolute,...u.applyPosition(Br(h))};d.updateXYFlow()}),bw=()=>R.assign(({context:e})=>{const{nodeLookup:t}=e.xystore.getState();return{xyedges:e.xyedges.map(o=>{if(!o.data.controlPoints)return o;const a=vc(t,o),i=a[0];return{...o,data:{...o.data,controlPoints:a,labelBBox:o.data.labelBBox?{...o.data.labelBBox,x:i.x,y:i.y}:null,labelXY:o.data.labelXY?i:null}}})}}),ww=e=>R.assign(({context:t,event:o})=>{e||(z(o,"notations.highlight"),e={...o});const a=e.notation,i=e.kind?[e.kind]:a.kinds;return{xynodes:t.xynodes.map(s=>{const l=qt(t,s.id);return l&&l.notation===a.title&&l.shape===a.shape&&l.color===a.color&&i.includes(l.kind)?G.setDimmed(s,!1):G.setDimmed(s,"immediate")}),xyedges:t.xyedges.map(G.setDimmed("immediate"))}}),vw=()=>R.assign(({context:e,event:t})=>(z(t,"tag.highlight"),{xynodes:e.xynodes.map(o=>o.data.tags?.includes(t.tag)?G.setDimmed(o,!1):G.setDimmed(o,!0))})),kw=()=>R.assign(({context:e,event:t})=>{z(t,"toggle.feature");const o=e.toggledFeatures[`enable${t.feature}`]??e.features[`enable${t.feature}`],a=t.forceValue??!o;return{toggledFeatures:{...e.toggledFeatures,[`enable${t.feature}`]:a}}}),Ic=()=>R.sendTo(({system:e})=>le(e).searchActorRef,{type:"close"}),Ec=()=>R.sendTo(({system:e})=>le(e).overlaysActorRef,{type:"close.all"}),jw=e=>e.features.enableReadOnly||e.toggledFeatures.enableReadOnly===!0,na=()=>R.enqueueActions(({enqueue:e,system:t})=>{const o=le(t).syncLayoutActorRef;o&&e.stopChild(o)}),mo=()=>R.enqueueActions(({context:e,enqueue:t,system:o})=>{const a=le(o).syncLayoutActorRef;if(jw(e)){a&&t.stopChild(a);return}a||t.spawnChild("syncManualLayoutActorLogic",{id:"syncLayout",systemId:"syncLayout",input:{viewId:e.view.id},syncSnapshot:!0})}),Xr=(e="node")=>R.sendTo(({system:t})=>le(t).syncLayoutActorRef,{type:"editing.start",subject:e}),Yr=(e=!0)=>R.sendTo(({system:t})=>le(t).syncLayoutActorRef,{type:"editing.stop",wasChanged:e}),qr=e=>"modelFqn"in e.data&&Se(e.data.modelFqn),ls=e=>R.enqueueActions(({context:t,event:o,enqueue:a,system:i})=>{let s=null,l,r;switch(!0){case o.type==="xyflow.nodeClick":{if(!qr(o.node)){console.warn("No modelFqn in clicked node data");return}r=o.node.data.modelFqn,l=o.node.data.id;break}case o.type==="open.elementDetails":{r=o.fqn,l=o.fromNode;break}default:{if(!t.lastClickedNode){console.warn("No last clicked node");return}l=t.lastClickedNode.id;const u=t.xynodes.find(c=>c.id===l);if(!u||!qr(u)){console.warn("No modelFqn in last clicked node");return}r=u.data.modelFqn;break}}const d=l?t.xystore.getState().nodeLookup.get(l):null;if(l&&d){const u=bu(d),c=t.xyflow.getZoom(),p={...t.xyflow.flowToScreenPosition(u),width:u.width*c,height:u.height*c};s={node:l,clientRect:p}}a.sendTo(le(i).overlaysActorRef,{type:"open.elementDetails",subject:r,currentView:t.view,...s&&{initiatedFrom:s}})}),_n=()=>R.enqueueActions(({context:e,enqueue:t})=>{const o=e.focusedNode??e.lastClickedNode?.id;if(!o||!e.features.enableVscode)return;const a=qt(e,o);a&&(a.deploymentRef?t.raise({type:"open.source",deployment:a.deploymentRef}):a.modelRef&&t.raise({type:"open.source",element:a.modelRef}))}),Cw=()=>R.enqueueActions(({enqueue:e,context:{features:t},system:o})=>{const a=t.enableElementDetails||t.enableRelationshipDetails||t.enableRelationshipBrowser,i=le(o).overlaysActorRef;if(a&&!i){e.spawnChild("overlaysActorLogic",{id:"overlays",systemId:"overlays"});return}!a&&i&&(e.sendTo(i,{type:"close.all"}),e.stopChild("overlays"))}),Sw=()=>R.enqueueActions(({enqueue:e,context:{features:{enableSearch:t}},system:o})=>{const a=le(o).searchActorRef;if(t&&!a){e.spawnChild("searchActorLogic",{id:"search",systemId:"search"});return}!t&&a&&(e.sendTo(a,{type:"close"}),e.stopChild("search"))}),_w=()=>R.enqueueActions(({enqueue:e,context:t,event:o})=>{z(o,"xyflow.edgeMouseEnter");let a=o.edge;e.assign({xyedges:t.xyedges.map(i=>i.id===o.edge.id?(a=G.setHovered(i,!0),a):i)}),e.emit({type:"edgeMouseEnter",edge:a,event:o.event})}),Pw=()=>R.enqueueActions(({enqueue:e,context:t,event:o})=>{z(o,"xyflow.edgeMouseLeave");let a=o.edge;e.assign({xyedges:t.xyedges.map(i=>i.id===o.edge.id?(a=G.setHovered(i,!1),a):i)}),e.emit({type:"edgeMouseLeave",edge:a,event:o.event})}),fo=()=>R.cancel("fitDiagram"),Ht=e=>R.enqueueActions(({enqueue:t})=>{t.cancel("fitDiagram"),t.raise({type:"fitDiagram",...ct(e?.duration)?{duration:e.duration}:{}},{id:"fitDiagram",...ct(e?.delay)?{delay:e.delay}:{}})}),Mw=()=>R.enqueueActions(({enqueue:e,event:t,check:o,context:a,system:i})=>{z(t,"update.view");const s=o("is another view");if(e(fo()),s){e(na()),e(Ec()),e(Ic()),e.assign({focusedNode:null}),e(is());const{fromNode:u,toNode:c}=Mc(a,t);u&&c?(e(fe.alignNodeFromToAfterNavigate({fromNode:u.id,toPosition:{x:c.data.x,y:c.data.y}})),e(Ht({delay:80}))):(e(fe.setViewportCenter()),e(Ht({duration:200,delay:25}))),e(Ja()),e(mo());return}e(Ja());const l=le(i).syncLayoutActorRef;l&&e.sendTo(l,{type:"synced"});const r=t.view;if(a.toggledFeatures.enableCompareWithLatest===!0&&a.view._layout!==r._layout){if(r._layout==="auto"&&a.viewportOnAutoLayout){e(fe.setViewport({viewport:a.viewportOnAutoLayout,duration:0}));return}if(r._layout==="manual"&&a.viewportOnManualLayout){e(fe.setViewport({viewport:a.viewportOnManualLayout,duration:0}));return}}let d=!a.viewportChangedManually;d=d||r._type==="dynamic"&&a.view._type==="dynamic"&&r.variant!==a.view.variant,d=d||a.toggledFeatures.enableCompareWithLatest===!0&&!!r._layout&&a.view._layout!==r._layout,d&&(e(fe.setViewportCenter(ht.center(r.bounds))),e(Ht({delay:50})))}),Nw=R.createStateConfig({on:{"xyflow.init":{actions:T(({context:e,event:t})=>({initialized:{...e.initialized,xyflow:!0},xyflow:t.instance})),target:"isReady"},"update.view":{actions:T(({context:e,event:t})=>({initialized:{...e.initialized,xydata:!0},view:t.view,xynodes:t.xynodes,xyedges:t.xyedges})),target:"isReady"}}}),Iw=R.createStateConfig({always:[{guard:"isReady",actions:[fe.fitDiagram({duration:0}),T(({context:e})=>({navigationHistory:{currentIndex:0,history:[{viewId:e.view.id,fromNode:null,viewport:{...e.xyflow.getViewport()}}]}})),mo(),fw()],target:"ready"},{target:"initializing"}]}),Ew=R.createStateConfig({id:"navigating",entry:[Ec(),Ic(),na(),fo(),sw.navigateTo()],on:{"update.view":{actions:Ye(({enqueue:e,context:t,event:o})=>{e(is());const{fromNode:a,toNode:i}=Mc(t,o);e(a&&i?fe.alignNodeFromToAfterNavigate({fromNode:a.id,toPosition:{x:i.data.x,y:i.data.y}}):fe.setViewportCenter()),e.assign(wc),e(Ja()),e(mo()),e(Ht({delay:25}))}),target:"#idle"}}}),_a="#navigating",Rw=R.createStateConfig({id:"idle",on:{"xyflow.nodeClick":[{guard:en(["enabled: FocusMode","click: node has connections",ms(["click: same node","click: selected node"])]),actions:[ro(),Qa(),jt()],target:"focused"},{guard:en(["enabled: Readonly","enabled: ElementDetails","click: node has modelFqn",ms(["click: same node","click: selected node"])]),actions:[ro(),_n(),ls(),jt()]},{actions:[ro(),_n(),jt()]}],"xyflow.paneClick":{actions:[ho(),ss()]},"xyflow.paneDblClick":{actions:[ho(),fe.fitDiagram(),Ye(({context:e,enqueue:t})=>{t(Nc({view:e.view.id}))})]},"focus.node":{guard:"enabled: FocusMode",actions:Qa(),target:"focused"},"xyflow.edgeClick":{guard:en(["enabled: Readonly","is dynamic view","enabled: DynamicViewWalkthrough","click: selected edge"]),actions:[be(({event:e})=>({type:"walkthrough.start",stepId:e.edge.id})),rs()]}}}),Dw=R.createStateConfig({entry:[Uo(),T(e=>({viewportBeforeFocus:{...e.context.viewport}})),_n(),di("hotkeyActorLogic",{id:"hotkey"}),fe.fitFocusedBounds()],exit:Ye(({enqueue:e,context:t})=>{e.stopChild("hotkey"),t.viewportBeforeFocus?e(fe.setViewport({viewport:t.viewportBeforeFocus})):e.raise({type:"fitDiagram"},{id:"fitDiagram",delay:20}),e(Sn()),e.assign({viewportBeforeFocus:null,focusedNode:null})}),on:{"xyflow.nodeClick":[{guard:en(["click: focused node","click: node has modelFqn"]),actions:[ls(),jt()]},{guard:"click: focused node",actions:jt(),target:"#idle"},{actions:[ro(),be(({event:e})=>({type:"focus.node",nodeId:e.node.id})),jt()]}],"focus.node":{actions:[Qa(),Uo(),_n(),fe.fitFocusedBounds()]},"key.esc":{target:"idle"},"xyflow.paneClick":{actions:[ho(),ss()],target:"idle"},"notations.unhighlight":{actions:Uo()},"tag.unhighlight":{actions:Uo()}}}),Bw=R.createStateConfig({entry:[di("hotkeyActorLogic",{id:"hotkey"}),T({viewportBeforeFocus:({context:e})=>e.viewport,activeWalkthrough:({context:e,event:t})=>{z(t,"walkthrough.start");const o=t.stepId??lo(e.xyedges).id;return{stepId:o,parallelPrefix:ra(o)}}}),no(),fe.fitFocusedBounds(),yw()],exit:Ye(({enqueue:e,context:t})=>{e.stopChild("hotkey"),t.viewportBeforeFocus?e(fe.setViewport({viewport:t.viewportBeforeFocus})):e(Ht({delay:10})),t.dynamicViewVariant==="sequence"&&t.activeWalkthrough?.parallelPrefix&&e.assign({xynodes:t.xynodes.map(o=>o.type==="seq-parallel"?G.setData(o,{color:jn.default}):o)}),e(Sn()),e.assign({activeWalkthrough:null,viewportBeforeFocus:null}),e(mw())}),on:{"key.esc":{target:"idle"},"key.arrow.left":{actions:be({type:"walkthrough.step",direction:"previous"})},"key.arrow.right":{actions:be({type:"walkthrough.step",direction:"next"})},"walkthrough.step":{actions:[T(({context:e,event:t})=>{const{stepId:o}=e.activeWalkthrough,a=e.xyedges.findIndex(l=>l.id===o),i=ze(t.direction==="next"?a+1:a-1,{min:0,max:e.xyedges.length-1});if(i===a)return{};const s=e.xyedges[i].id;return{activeWalkthrough:{stepId:s,parallelPrefix:ra(s)}}}),no(),fe.fitFocusedBounds(),Hr()]},"xyflow.edgeClick":{actions:[T(({event:e,context:t})=>!jl(e.edge.id)||e.edge.id===t.activeWalkthrough?.stepId?{}:{activeWalkthrough:{stepId:e.edge.id,parallelPrefix:ra(e.edge.id)}}),no(),fe.fitFocusedBounds(),rs(),Hr()]},"notations.unhighlight":{actions:no()},"tag.unhighlight":{actions:no()},"walkthrough.end":{target:"idle"},"xyflow.paneDblClick":{target:"idle"},"update.view":{guard:"is another view",actions:be(({event:e})=>e,{delay:50}),target:"idle"}}}),Lw=R.createStateConfig({initial:"idle",on:{"navigate.to":{guard:"is another view",actions:T({lastOnNavigate:({context:e,event:t})=>({fromView:e.view.id,toView:t.viewId,fromNode:t.fromNode??null})}),target:_a},"navigate.back":{guard:({context:e})=>e.navigationHistory.currentIndex>0,actions:T(bb),target:_a},"navigate.forward":{guard:({context:e})=>e.navigationHistory.currentIndex<e.navigationHistory.history.length-1,actions:T(wb),target:_a},"layout.align":{guard:"not readonly",actions:[Xr("node"),xw(),Yr(!0)]},"layout.resetEdgeControlPoints":{guard:"not readonly",actions:[Xr("node"),bw(),Yr(!0)]},"layout.resetManualLayout":{guard:"not readonly",actions:[na(),is(),mo(),ul({type:"onChange",change:{op:"reset-manual-layout"}})]},"xyflow.resized":{guard:({context:e})=>e.features.enableFitView&&!e.viewportChangedManually,actions:[fo(),Ht({delay:200})]},"open.elementDetails":{guard:"enabled: ElementDetails",actions:ls()},"open.relationshipsBrowser":{actions:Qo(({system:e})=>le(e).overlaysActorRef,({context:e,event:t,self:o})=>({type:"open.relationshipsBrowser",subject:t.fqn,viewId:e.view.id,scope:"view",closeable:!0,enableChangeScope:!0,enableSelectSubject:!0,openSourceActor:o}))},"open.relationshipDetails":{actions:Qo(({system:e})=>le(e).overlaysActorRef,({context:e,event:t,self:o})=>({type:"open.relationshipDetails",viewId:e.view.id,openSourceActor:o,...t.params}))},"open.source":{actions:Nc()},"walkthrough.start":{guard:"is dynamic view",target:".walkthrough"},"toggle.feature":{actions:[kw(),mo()]},"xyflow.nodeMouseEnter":{actions:gw()},"xyflow.nodeMouseLeave":{actions:hw()},"xyflow.edgeMouseEnter":{actions:_w()},"xyflow.edgeMouseLeave":{actions:Pw()},"xyflow.edgeDoubleClick":{guard:"not readonly",actions:rw()},"notations.highlight":{actions:ww()},"notations.unhighlight":{actions:Sn()},"tag.highlight":{actions:vw()},"tag.unhighlight":{actions:Sn()},"open.search":{guard:"enabled: Search",actions:Qo(({system:e})=>le(e).searchActorRef,({event:e})=>({type:"open",search:e.search}))}},exit:[fo()],states:{idle:Rw,focused:Dw,walkthrough:Bw}}),Pa="likec4:diagram:toggledFeatures",Rc={read(){try{let e=sessionStorage.getItem(Pa);return e?JSON.parse(e):null}catch(e){return console.error(`Error reading fromStorage ${Pa}:`,e),null}},write(e){return sessionStorage.setItem(Pa,JSON.stringify(wu(e,op))),e}},Tw=R.createMachine({initial:"initializing",context:({input:e})=>({...e,xyedges:[],xynodes:[],features:{...Jl},toggledFeatures:Rc.read()??{enableReadOnly:!0,enableCompareWithLatest:!1},initialized:{xydata:!1,xyflow:!1},viewportChangedManually:!1,lastOnNavigate:null,lastClickedNode:null,focusedNode:null,activeElementDetails:null,viewportBeforeFocus:null,viewportOnManualLayout:null,viewportOnAutoLayout:null,navigationHistory:{currentIndex:0,history:[]},viewport:{x:0,y:0,zoom:1},xyflow:null,dynamicViewVariant:e.dynamicViewVariant??(e.view._type==="dynamic"?e.view.variant:"diagram")??"diagram",activeWalkthrough:null}),states:{initializing:Nw,isReady:Iw,ready:Lw,navigating:Ew},on:{"xyflow.paneClick":{actions:[ho(),ss()]},"xyflow.nodeClick":{actions:[ro(),jt()]},"xyflow.edgeClick":{actions:[ho(),rs()]},"xyflow.applyNodeChanges":{actions:T({xynodes:({context:e,event:t})=>pi(t.changes,e.xynodes)})},"xyflow.applyEdgeChanges":{actions:T({xyedges:({context:e,event:t})=>ui(t.changes,e.xyedges)})},"xyflow.viewportMoved":{actions:T({viewportChangedManually:(({event:e})=>e.manually),viewport:(({event:e})=>e.viewport)})},fitDiagram:{guard:"enabled: FitView",actions:fe.fitDiagram()},"update.nodeData":{actions:T(vb)},"update.edgeData":{actions:T(kb)},"update.view":{actions:[T(wc),Mw()]},"update.inputs":{actions:uw()},"update.features":{actions:[cw(),Cw(),Sw()]},"switch.dynamicViewVariant":{actions:pw()},"emit.onChange":{actions:lw()},"emit.onLayoutTypeChange":{actions:dw()}},exit:[na(),fo(),Jo("hotkey"),Jo("overlays"),Jo("search"),T({xyflow:null,xystore:null,xyedges:[],xynodes:[],initialized:{xydata:!1,xyflow:!1}})]}),Aw=Tw;function zw({view:e,zoomable:t,pannable:o,nodesDraggable:a,nodesSelectable:i,fitViewPadding:s,where:l,children:r,dynamicViewVariant:d}){const u=Rn(),c=ii(Aw,{id:"diagram",systemId:"diagram",input:{xystore:u,view:e,zoomable:t,pannable:o,fitViewPadding:s,nodesDraggable:a,nodesSelectable:i,dynamicViewVariant:d}}),[p,h]=g.useState(()=>Rr(c));g.useEffect(()=>{h(x=>x.actor===c?x:Rr(c))},[c]),p.actor!==c&&console.warn("DiagramApi instance changed, this should not happen during the lifetime of the actor");const f=Z();return g.useEffect(()=>c.send({type:"update.features",features:f}),[f,c]),g.useEffect(()=>c.send({type:"update.inputs",inputs:{zoomable:t,pannable:o,fitViewPadding:s,nodesDraggable:a,nodesSelectable:i}}),[t,o,s,c,a,i]),It(()=>{d&&c.send({type:"switch.dynamicViewVariant",variant:d})},[d,c]),console.debug("Render DiagramActorProvider for view",e.id),n.jsxs(vm,{value:p,children:[n.jsxs(rd,{children:[n.jsx(Ow,{view:e,where:l,actorRef:c}),n.jsx(Vw,{actorRef:c,children:r})]}),n.jsx(Hw,{})]})}const $w=({context:e})=>{let t=e.toggledFeatures;const o=e.view.drifts!=null,a=e.features.enableCompareWithLatest&&(t.enableCompareWithLatest??!1)&&yi(e.activeWalkthrough)&&o,i=e.features.enableReadOnly||t.enableReadOnly||!!e.activeWalkthrough||e.dynamicViewVariant==="sequence"&&e.view._type==="dynamic"||a&&e.view._layout==="auto";return(t.enableReadOnly!==i||t.enableCompareWithLatest!==a)&&(t={...t,enableCompareWithLatest:a,enableReadOnly:i}),{toggledFeatures:t,viewId:e.view.id}},Fw=(e,t)=>e.viewId===t.viewId&&ee(e.toggledFeatures,t.toggledFeatures);function Vw({children:e,actorRef:t}){const{viewId:o,toggledFeatures:a}=ne(t,$w,Fw);It(()=>{Rc.write(a)},[a]);const i=je().findView(o);return n.jsx(Ai.Provider,{value:i,children:n.jsx(Pt,{overrides:a,children:e})})}const Ww=e=>e.context.dynamicViewVariant;function Ow({view:e,where:t,actorRef:o}){const a=ne(o,Ww);return ri(()=>{o.send({type:"update.view",...fb({view:e,where:t,dynamicViewVariant:a})})},[e,t,a,o]),null}const Hw=g.memo(()=>{const e=H(),{onNavigateTo:t,onOpenSource:o,onChange:a,onLayoutTypeChange:i,handlersRef:s}=Qt();Me("openSource",({params:r})=>o?.(r)),Me("navigateTo",({viewId:r})=>t?.(r)),Me("onChange",({change:r})=>a?.({change:r})),Me("onLayoutTypeChange",({layoutType:r})=>{i?.(r)});const l=g.useRef(!1);return g.useEffect(()=>{if(l.current)return;let r=e.actor.on("initialized",({instance:d})=>{try{s.current.onInitialized?.({diagram:e,xyflow:d})}catch(u){console.error(u)}finally{l.current=!0,r?.unsubscribe(),r=null}});return()=>{r?.unsubscribe()}},[e]),null}),Dc=e=>`[data-mantine-color-scheme="${e}"]`,Bc=Dc("dark"),Xw=Dc("light"),Yw=5,qw=(e,t,o,a)=>{const i=r=>ws(vs(r,{l:-22-5*a,s:-10-6*a})),s=r=>ws(vs(r,{l:-20-3*a,s:-3-6*a})),l=`:where(${e} [data-likec4-color="${t}"][data-compound-depth="${a}"])`;return`
${l} {
  --likec4-palette-fill: ${s(o.elements.fill)};
  --likec4-palette-stroke: ${s(o.elements.stroke)};
}
${Bc} ${l} {
  --likec4-palette-fill: ${i(o.elements.fill)};
  --likec4-palette-stroke: ${i(o.elements.stroke)};
}
  `.trim()};function Gw(e,t,o){const{elements:a,relationships:i}=o,s=`:where(${e} [data-likec4-color=${t}])`;return[`
${s} {
  --likec4-palette-fill: ${a.fill};
  --likec4-palette-stroke: ${a.stroke};
  --likec4-palette-hiContrast: ${a.hiContrast};
  --likec4-palette-loContrast: ${a.loContrast};
  --likec4-palette-relation-stroke: ${i.line};
  --likec4-palette-relation-label: ${i.label};
  --likec4-palette-relation-label-bg: ${i.labelBg};
}
${Xw} ${s} {
  --likec4-palette-relation-stroke-selected: ${ys(xs(i.line,"black",85))};
}
${Bc} ${s} {
  --likec4-palette-relation-stroke-selected: ${ys(xs(i.line,"white",70))};
}

  `.trim(),...Eu(1,Yw+1).map(l=>qw(e,t,o,l))].join(`
`)}function Zw(e,t){return ce(t.colors,hi(),ae(([o,a])=>Gw(e,o,a)),fl(`
`))}const Kw=g.memo(({id:e})=>{const t=`#${e}`,o=ti()?.(),{theme:a}=zd(),i=Zw(t,a);return n.jsx("style",{type:"text/css","data-likec4-colors":e,dangerouslySetInnerHTML:{__html:i},nonce:o})});function Uw({onCanvasClick:e,onCanvasContextMenu:t,onCanvasDblClick:o,onEdgeClick:a,onChange:i,onEdgeContextMenu:s,onNavigateTo:l,onNodeClick:r,onNodeContextMenu:d,onOpenSource:u,onBurgerMenuClick:c,onLayoutTypeChange:p,onInitialized:h,view:f,className:x,readonly:w=!0,controls:C=!w,fitView:v=!0,fitViewPadding:k=C?$s.withControls:$s.default,pannable:_=!0,zoomable:m=!0,background:b="dots",enableElementTags:j=!1,enableFocusMode:S=!1,enableElementDetails:D=!1,enableRelationshipDetails:M=!1,enableRelationshipBrowser:Y=!1,enableCompareWithLatest:O=!!p,nodesDraggable:$=!w,nodesSelectable:N=!w||S||!!l||!!r,enableNotations:F=!1,showNavigationButtons:E=!!l,enableDynamicViewWalkthrough:J=!1,dynamicViewVariant:Ce,enableSearch:xe=!1,initialWidth:Ze,initialHeight:de,reduceGraphics:Dt="auto",renderIcon:V,where:te,reactFlowProps:Bt,renderNodes:oo,children:aa}){const Lt=lm(),ia=g.useRef(null),Bo=Df(f,Ce),ds=Qw(k);ia.current==null&&(ia.current={defaultEdges:[],defaultNodes:[],initialWidth:Ze??Bo.width,initialHeight:de??Bo.height,initialFitViewOptions:{maxZoom:Wa,minZoom:Fe,padding:ds},initialMaxZoom:Wa,initialMinZoom:Fe});const cs=Dt==="auto"?_&&(Bo.width??1)*(Bo.height??1)>6e6&&f.nodes.some(Lc=>Lc.children?.length>0):Dt;return n.jsx(ed,{children:n.jsx(em,{...cs&&{reducedMotion:"always"},children:n.jsx(Mh,{value:V??null,children:n.jsx(Pt,{features:{enableFitView:v,enableReadOnly:w,enableFocusMode:S,enableNavigateTo:!!l,enableElementDetails:D,enableRelationshipDetails:M,enableRelationshipBrowser:Y,enableSearch:xe,enableNavigationButtons:E&&!!l,enableDynamicViewWalkthrough:f._type==="dynamic"&&J,enableNotations:F,enableVscode:!!u,enableControls:C,enableElementTags:j,enableCompareWithLatest:O&&!!p},children:n.jsxs(Uh,{handlers:{onCanvasClick:e,onCanvasContextMenu:t,onCanvasDblClick:o,onEdgeClick:a,onChange:i,onEdgeContextMenu:s,onNavigateTo:l,onNodeClick:r,onNodeContextMenu:d,onOpenSource:u,onBurgerMenuClick:c,onInitialized:h,onLayoutTypeChange:p},children:[n.jsx(Kw,{id:Lt}),n.jsx(im,{rootSelector:`#${Lt}`,children:n.jsx(Kh,{id:Lt,className:x,reduceGraphics:cs,children:n.jsx(fi,{fitView:v,...ia.current,children:n.jsxs(zw,{view:f,zoomable:m,pannable:_,fitViewPadding:ds,nodesDraggable:$,nodesSelectable:N,where:te??null,dynamicViewVariant:Ce,children:[n.jsx(db,{background:b,reactFlowProps:Bt,renderNodes:oo,children:aa}),n.jsx(fc,{})]})})})})]})})})})})}const Gr=e=>typeof e=="number"?`${e}px`:e;function Qw(e){return xi(()=>Da(e)?Wu(e,Gr):Gr(e),[e],Jw)}const Jw=([e],[t])=>e===t||Da(e)&&Da(t)&&e.bottom==t.bottom&&e.left==t.left&&e.right==t.right&&e.top==t.top;function dv({children:e,likec4model:t}){return n.jsx(Fn.Provider,{value:t,children:e})}function cv({children:e,projects:t,onProjectChange:o}){g.useContext(xn)&&console.warn("LikeC4ProjectsProvider should not be nested inside another one");const a=A(o),i=xi(()=>({projects:t,onProjectChange:a}),[t,a],ee);return n.jsx(xn.Provider,{value:i,children:e})}function uv({view:e,fitView:t=!0,fitViewPadding:o="8px",enableRelationshipDetails:a=!1,enableRelationshipBrowser:i=a,background:s="transparent",className:l,...r}){return n.jsx(Uw,{view:e,readonly:!0,className:P(l,"likec4-static-view"),fitView:t,fitViewPadding:o,pannable:!1,zoomable:!1,controls:!1,background:s,enableNotations:!1,enableElementDetails:!1,enableRelationshipDetails:a,enableRelationshipBrowser:i,enableDynamicViewWalkthrough:!1,showNavigationButtons:!1,enableCompareWithLatest:!1,enableFocusMode:!1,enableSearch:!1,nodesSelectable:!1,nodesDraggable:!1,enableElementTags:!1,...r})}export{K as B,sv as I,cv as L,Mt as M,uv as S,Mi as a,It as b,y as c,Mh as d,dv as e,iv as f,rv as g,og as h,Ph as i,Uw as j,je as k,Wl as l,Di as m,Og as n,Ve as o,Df as p,Fl as q,gg as r,$l as s,nv as t,lv as u,av as v,yh as w};
